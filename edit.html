
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Полный редактор сайта - Студия танцев</title>
    <style>
        :root {
            --primary: #E67E22;
            --secondary: #D35400;
            --light: #FFF8F0;
            --dark: #2C1810;
            --success: #27AE60;
            --danger: #E74C3C;
            --info: #3498DB;
            --warning: #F39C12;
            --purple: #9B59B6;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }
        
        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 16px;
        }
        
        .header-actions {
            position: absolute;
            top: 30px;
            right: 30px;
            display: flex;
            gap: 10px;
        }
        
        .tabs {
            display: flex;
            background: var(--light);
            border-bottom: 2px solid var(--primary);
            flex-wrap: wrap;
            overflow-x: auto;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .tab {
            padding: 18px 25px;
            cursor: pointer;
            font-weight: 600;
            color: var(--dark);
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
            min-width: fit-content;
            position: relative;
        }
        
        .tab:hover {
            background: rgba(230, 126, 34, 0.1);
        }
        
        .tab.active {
            background: white;
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
        }
        
        .tab-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            background: var(--danger);
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            min-width: 18px;
            text-align: center;
        }
        
        .tab-content {
            display: none;
            padding: 30px;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .form-section {
            background: #f9f9f9;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 1px solid #eee;
        }
        
        .form-section h3 {
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-row .form-group {
            flex: 1;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .label-required:after {
            content: " *";
            color: var(--danger);
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        input:focus, textarea:focus, select:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(230, 126, 34, 0.1);
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(230, 126, 34, 0.3);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success), #2ECC71);
            color: white;
        }
        
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(39, 174, 96, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #FF6B6B);
            color: white;
        }
        
        .btn-info {
            background: linear-gradient(135deg, var(--info), #3498DB);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, var(--warning), #F39C12);
            color: white;
        }
        
        .btn-purple {
            background: linear-gradient(135deg, var(--purple), #8E44AD);
            color: white;
        }
        
        .btn-small {
            padding: 8px 16px;
            font-size: 14px;
        }
        
        .btn-block {
            width: 100%;
            justify-content: center;
        }
        
        .actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #eee;
            flex-wrap: wrap;
        }
        
        /* СТИЛИ ДЛЯ СПИСКОВ */
        .item-list {
            background: white;
            border-radius: 10px;
            border: 1px solid #eee;
            margin-top: 20px;
            max-height: 500px;
            overflow-y: auto;
        }
        
        .item {
            padding: 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }
        
        .item:hover {
            background: #f9f9f9;
        }
        
        .item:last-child {
            border-bottom: none;
        }
        
        .item-info {
            flex: 1;
        }
        
        .item-info h4 {
            margin-bottom: 5px;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .item-info p {
            color: #666;
            font-size: 14px;
        }
        
        .item-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        /* СТИЛИ ДЛЯ ФОТОКОНТЕЙНЕРА */
        .photo-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .photo-item {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border: 1px solid #eee;
        }
        
        .photo-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .photo-preview {
            width: 100%;
            height: 200px;
            background: #f5f5f5;
            overflow: hidden;
            position: relative;
        }
        
        .photo-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        
        .photo-item:hover .photo-preview img {
            transform: scale(1.05);
        }
        
        /* МОДАЛЬНОЕ ОКНО - ЕДИНЫЙ СТИЛЬ */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(44, 24, 16, 0.9);
            z-index: 2000;
            animation: fadeIn 0.3s ease;
            backdrop-filter: blur(5px);
        }
        
        .modal-overlay.active {
            display: block;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 2001;
            animation: modalSlideIn 0.4s ease;
        }
        
        .modal.active {
            display: block;
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translate(-50%, -60%);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%);
            }
        }
        
        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            width: 90vw;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 30px 80px rgba(0,0,0,0.4);
        }
        
        .modal-header {
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .modal-close {
            font-size: 28px;
            cursor: pointer;
            color: var(--primary);
            transition: all 0.3s ease;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: white;
            border: none;
        }
        
        .modal-close:hover {
            color: var(--danger);
            transform: rotate(90deg);
            background: #f9f9f9;
        }
        
        .modal-body {
            margin-bottom: 20px;
        }
        
        .modal-footer {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        /* ЗОНА ЗАГРУЗКИ */
        .upload-area {
            border: 3px dashed #ddd;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f9f9f9;
            margin-bottom: 20px;
        }
        
        .upload-area:hover {
            border-color: var(--primary);
            background: rgba(230, 126, 34, 0.05);
        }
        
        .upload-area.drag-over {
            border-color: var(--success);
            background: rgba(39, 174, 96, 0.05);
        }
        
        .upload-icon {
            font-size: 48px;
            color: var(--primary);
            margin-bottom: 15px;
        }
        
        /* ИНФО БЛОКИ */
        .info-box {
            background: linear-gradient(135deg, rgba(230, 126, 34, 0.1), rgba(255, 255, 255, 0.8));
            border-left: 4px solid var(--primary);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .info-box-title {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .info-box-content {
            color: #666;
            font-size: 14px;
            line-height: 1.6;
        }
        
        /* ПАНЕЛЬ ИНСТРУМЕНТОВ */
        .editor-toolbar {
            background: #f0f0f0;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .counter {
            background: var(--primary);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-left: 10px;
        }
        
        /* СТАТУС БАР */
        .status-bar {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: flex-end;
        }
        
        .status-message {
            padding: 15px 25px;
            border-radius: 10px;
            background: var(--success);
            color: white;
            font-weight: 600;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.5s ease;
        }
        
        .status-message.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        .status-message.error {
            background: var(--danger);
        }
        
        .status-message.warning {
            background: var(--warning);
        }
        
        .status-message.info {
            background: var(--info);
        }
        
        /* КАТЕГОРИИ */
        .category-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        
        .category-tag {
            padding: 8px 15px;
            background: #f0f0f0;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .category-tag:hover {
            background: #e0e0e0;
        }
        
        .category-tag.active {
            background: var(--primary);
            color: white;
        }
        
        /* ПРЕДПРОСМОТР ФОТО */
        .preview-image {
            max-width: 100%;
            max-height: 200px;
            border-radius: 10px;
            margin: 15px 0;
            display: block;
            border: 2px solid #eee;
        }
        
        .preview-container {
            text-align: center;
            margin: 15px 0;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 10px;
        }
        
        /* ЗАГРУЗЧИК */
        .loader {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.9);
            z-index: 3000;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 20px;
        }
        
        .loader.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }
        
        .loader-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* ТОГГЛ ПАНЕЛЬ */
        .toggle-panel {
            background: #f9f9f9;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            border-left: 4px solid var(--info);
        }
        
        .toggle-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }
        
        .toggle-content {
            display: none;
            padding-top: 15px;
        }
        
        .toggle-content.active {
            display: block;
        }
        
        /* РАСПИСАНИЕ */
        .schedule-days {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .schedule-day {
            padding: 10px 20px;
            background: #f0f0f0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            text-align: center;
            min-width: 80px;
        }
        
        .schedule-day:hover {
            background: #e0e0e0;
        }
        
        .schedule-day.active {
            background: var(--primary);
            color: white;
        }
        
        .schedule-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .schedule-table th {
            background: var(--primary);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: 600;
            border: 1px solid var(--secondary);
        }
        
        .schedule-table td {
            padding: 15px;
            border: 1px solid #eee;
            text-align: center;
            vertical-align: top;
        }
        
        .schedule-table tr:hover td {
            background: #f9f9f9;
        }
        
        .schedule-item {
            background: linear-gradient(135deg, rgba(52, 152, 219, 0.1), rgba(52, 152, 219, 0.05));
            border-radius: 8px;
            padding: 12px;
            margin: 5px 0;
            border-left: 4px solid var(--info);
            text-align: left;
            position: relative;
        }
        
        .schedule-item-highlight {
            background: linear-gradient(135deg, rgba(230, 126, 34, 0.1), rgba(230, 126, 34, 0.05));
            border-left: 4px solid var(--primary);
        }
        
        .schedule-time {
            font-weight: bold;
            color: var(--dark);
            margin-bottom: 5px;
        }
        
        .schedule-direction {
            font-size: 14px;
            color: var(--primary);
            margin-bottom: 3px;
        }
        
        .schedule-age {
            font-size: 12px;
            color: #666;
            background: rgba(0,0,0,0.05);
            padding: 2px 6px;
            border-radius: 10px;
            display: inline-block;
        }
        
        .schedule-instructor {
            font-size: 12px;
            color: #888;
            margin-top: 5px;
            font-style: italic;
        }
        
        .time-slots {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }
        
        .time-slot {
            padding: 8px 12px;
            background: #f0f0f0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 14px;
        }
        
        .time-slot:hover {
            background: #e0e0e0;
        }
        
        .time-slot.selected {
            background: var(--primary);
            color: white;
        }
        
        .schedule-actions {
            position: absolute;
            top: 5px;
            right: 5px;
            display: flex;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .schedule-item:hover .schedule-actions {
            opacity: 1;
        }
        
        .schedule-action-btn {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            cursor: pointer;
            border: none;
            color: white;
        }
        
        .edit-schedule {
            background: var(--info);
        }
        
        .delete-schedule {
            background: var(--danger);
        }
        
        /* АДАПТИВНОСТЬ */
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                text-align: center;
                border-bottom: 1px solid #ddd;
            }
            
            .tab.active {
                border-right: 3px solid var(--primary);
                border-bottom: none;
            }
            
            .actions {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .photo-container {
                grid-template-columns: 1fr;
            }
            
            .header-actions {
                position: static;
                justify-content: center;
                margin-top: 20px;
            }
            
            .item {
                flex-direction: column;
                gap: 15px;
                align-items: stretch;
            }
            
            .item-actions {
                justify-content: center;
            }
            
            .modal-content {
                padding: 25px;
                width: 95vw;
            }
            
            .schedule-table {
                display: block;
                overflow-x: auto;
            }
            
            .schedule-days {
                overflow-x: auto;
                flex-wrap: nowrap;
                padding-bottom: 10px;
            }
        }
        
        /* АНИМАЦИИ */
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(230, 126, 34, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(230, 126, 34, 0); }
            100% { box-shadow: 0 0 0 0 rgba(230, 126, 34, 0); }
        }
        
        /* СКРОЛЛБАР */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary);
        }
        
        /* ЗВЕЗДЫ РЕЙТИНГА */
        .rating-stars {
            display: flex;
            gap: 5px;
            margin: 10px 0;
        }
        
        .star {
            font-size: 24px;
            cursor: pointer;
            color: #ddd;
            transition: color 0.3s ease;
        }
        
        .star.active {
            color: var(--warning);
        }
        
        /* КАРТОЧКА ПРЕПОДАВАТЕЛЯ В МОДАЛКЕ */
        .teacher-avatar {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 32px;
            font-weight: bold;
            margin: 0 auto 20px;
        }
        
        /* ПРЕВЬЮ ТАРИФА */
        .price-preview {
            background: linear-gradient(135deg, #f9f9f9, #fff);
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
            border: 2px solid #eee;
            text-align: center;
        }
        
        .price-value {
            font-size: 32px;
            font-weight: bold;
            color: var(--primary);
            margin: 10px 0;
        }
        
        .price-period {
            color: #666;
            font-size: 14px;
        }
        
        /* ФИЧИ ТАРИФА */
        .features-list {
            margin: 15px 0;
            padding-left: 20px;
        }
        
        .feature-item {
            margin: 5px 0;
            color: #555;
            font-size: 14px;
        }
        
        .feature-item:before {
            content: "✓ ";
            color: var(--success);
            font-weight: bold;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="loader" id="loader">
        <div class="loader-spinner"></div>
        <div id="loaderText">Загрузка...</div>
    </div>
    
    <div class="container">
        <div class="header">
            <h1>
                <i class="fas fa-edit"></i>
                <span>Редактор сайта танцевальной студии</span>
                <span class="counter" id="totalItemsCount">0</span>
            </h1>
            <p>Управляйте всеми данными сайта: контент, цены, команда, фото и отзывы</p>
            
            <div class="header-actions">
                <button class="btn btn-success btn-small" onclick="saveAllData()">
                    <i class="fas fa-save"></i> Сохранить всё
                </button>
                <button class="btn btn-primary btn-small" onclick="previewSite()">
                    <i class="fas fa-eye"></i> Просмотр
                </button>
            </div>
        </div>
        
        <div class="tabs">
            <div class="tab active" data-tab="main">
                <i class="fas fa-home"></i> Основное
            </div>
            <div class="tab" data-tab="directions">
                <i class="fas fa-dance"></i> Направления
                <span class="tab-badge" id="directionsBadge">0</span>
            </div>
            <div class="tab" data-tab="schedule">
                <i class="fas fa-calendar-alt"></i> Расписание
                <span class="tab-badge" id="scheduleBadge">0</span>
            </div>
            <div class="tab" data-tab="prices">
                <i class="fas fa-tags"></i> Цены
                <span class="tab-badge" id="pricesBadge">0</span>
            </div>
            <div class="tab" data-tab="team">
                <i class="fas fa-users"></i> Команда
                <span class="tab-badge" id="teamBadge">0</span>
            </div>
            <div class="tab" data-tab="photos">
                <i class="fas fa-images"></i> Фотогалерея
                <span class="tab-badge" id="photosBadge">0</span>
            </div>
            <div class="tab" data-tab="reviews">
                <i class="fas fa-comments"></i> Отзывы
                <span class="tab-badge" id="reviewsBadge">0</span>
            </div>
            <div class="tab" data-tab="news">
                <i class="fas fa-newspaper"></i> Новости
                <span class="tab-badge" id="newsBadge">0</span>
            </div>
            <div class="tab" data-tab="faq">
                <i class="fas fa-question-circle"></i> FAQ
                <span class="tab-badge" id="faqBadge">0</span>
            </div>
            <div class="tab" data-tab="settings">
                <i class="fas fa-cog"></i> Настройки
            </div>
        </div>
        
        <!-- Вкладка: Основное -->
        <div class="tab-content active" id="main">
            <div class="info-box">
                <div class="info-box-title">
                    <i class="fas fa-info-circle"></i> Основная информация о студии
                </div>
                <div class="info-box-content">
                    Заполните основную информацию, которая будет отображаться на главной странице сайта
                </div>
            </div>
            
            <div class="form-section">
                <h3><i class="fas fa-building"></i> Информация о студии</h3>
                <div class="form-group">
                    <label class="label-required">Название студии</label>
                    <input type="text" id="studioName" placeholder="Первый ритм Ленинского" maxlength="100">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="label-required">Телефон</label>
                        <input type="tel" id="phone" placeholder="+7 (904) 123-31-75">
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="email" placeholder="info@primeritm.ru">
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="label-required">Адрес</label>
                    <textarea id="address" placeholder="г. Иркутск, ул. 1-й Ленинский квартал, д. 1" rows="2"></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="label-required">Часы работы</label>
                        <input type="text" id="workingHours" placeholder="Ежедневно с 8:00 до 22:00">
                    </div>
                    <div class="form-group">
                        <label class="label-required">Цена пробного занятия</label>
                        <input type="text" id="trialPrice" placeholder="300₽">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Описание студии</label>
                    <textarea id="studioDescription" placeholder="Краткое описание вашей танцевальной студии..." rows="4"></textarea>
                </div>
            </div>
            
            <div class="form-section">
                <h3><i class="fas fa-share-alt"></i> Социальные сети</h3>
                <div id="socialLinksList">
                    <!-- Ссылки будут добавляться динамически -->
                </div>
                <button class="btn btn-primary" onclick="addSocialLink()">
                    <i class="fas fa-plus"></i> Добавить соцсеть
                </button>
            </div>
            
            <div class="actions">
                <button class="btn btn-success" onclick="saveMainSettings()">
                    <i class="fas fa-save"></i> Сохранить настройки
                </button>
                <button class="btn btn-warning" onclick="resetMainSettings()">
                    <i class="fas fa-undo"></i> Сбросить
                </button>
            </div>
        </div>
        
        <!-- Вкладка: Направления -->
        <div class="tab-content" id="directions">
            <div class="editor-toolbar">
                <div>
                    <strong>Танцевальные направления</strong>
                    <span class="counter" id="directionsCount">0</span>
                </div>
                <div>
                    <button class="btn btn-primary btn-small" onclick="showDirectionModal()">
                        <i class="fas fa-plus"></i> Добавить направление
                    </button>
                    <button class="btn btn-info btn-small" onclick="importDemoDirections()">
                        <i class="fas fa-magic"></i> Демо-данные
                    </button>
                </div>
            </div>
            
            <div id="directionsList" class="item-list">
                <!-- Направления будут добавляться динамически -->
            </div>
            
            <div class="actions">
                <button class="btn btn-success" onclick="saveDirections()">
                    <i class="fas fa-save"></i> Сохранить направления
                </button>
                <button class="btn btn-danger" onclick="clearDirections()">
                    <i class="fas fa-trash"></i> Очистить все
                </button>
            </div>
        </div>
        
        <!-- Вкладка: Расписание -->
        <div class="tab-content" id="schedule">
            <div class="info-box">
                <div class="info-box-title">
                    <i class="fas fa-calendar-alt"></i> Редактор расписания занятий
                </div>
                <div class="info-box-content">
                    Создайте и управляйте расписанием занятий. Расписание будет отображаться на сайте в удобном виде.
                </div>
            </div>
            
            <div class="editor-toolbar">
                <div>
                    <strong>Расписание занятий</strong>
                    <span class="counter" id="scheduleCount">0</span>
                </div>
                <div>
                    <button class="btn btn-primary btn-small" onclick="showScheduleModal()">
                        <i class="fas fa-plus"></i> Добавить занятие
                    </button>
                    <button class="btn btn-info btn-small" onclick="importDemoSchedule()">
                        <i class="fas fa-magic"></i> Демо-расписание
                    </button>
                    <button class="btn btn-warning btn-small" onclick="clearSchedule()">
                        <i class="fas fa-trash"></i> Очистить все
                    </button>
                </div>
            </div>
            
            <div class="form-section">
                <h3><i class="fas fa-filter"></i> Фильтр по дням недели</h3>
                <div class="schedule-days" id="scheduleDays">
                    <!-- Дни недели будут добавляться динамически -->
                </div>
                <div class="form-group">
                    <button class="btn btn-small" onclick="showAllDays()">
                        <i class="fas fa-eye"></i> Показать все дни
                    </button>
                    <button class="btn btn-small" onclick="showTodaySchedule()">
                        <i class="fas fa-calendar-day"></i> Сегодня
                    </button>
                </div>
            </div>
            
            <div id="scheduleTableContainer">
                <!-- Расписание будет отображаться здесь -->
            </div>
            
            <div id="emptySchedule" style="display: none; text-align: center; padding: 60px 20px;">
                <i class="fas fa-calendar-times" style="font-size: 64px; color: #ddd; margin-bottom: 20px;"></i>
                <h3 style="color: #666; margin-bottom: 15px;">Расписание пусто</h3>
                <p style="color: #888; margin-bottom: 25px;">Добавьте занятия, чтобы создать расписание</p>
                <button class="btn btn-primary" onclick="showScheduleModal()">
                    <i class="fas fa-plus"></i> Добавить первое занятие
                </button>
            </div>
            
            <div class="actions">
                <button class="btn btn-success" onclick="saveSchedule()">
                    <i class="fas fa-save"></i> Сохранить расписание
                </button>
                <button class="btn btn-info" onclick="printSchedule()">
                    <i class="fas fa-print"></i> Распечатать расписание
                </button>
                <button class="btn btn-purple" onclick="exportSchedule()">
                    <i class="fas fa-download"></i> Экспорт в PDF
                </button>
            </div>
        </div>
        
        <!-- Вкладка: Цены -->
        <div class="tab-content" id="prices">
            <div class="editor-toolbar">
                <div>
                    <strong>Тарифы и цены</strong>
                    <span class="counter" id="pricesCount">0</span>
                </div>
                <button class="btn btn-primary btn-small" onclick="showPriceModal()">
                    <i class="fas fa-plus"></i> Добавить тариф
                </button>
            </div>
            
            <div id="pricesList" class="item-list">
                <!-- Цены будут добавляться динамически -->
            </div>
            
            <div class="actions">
                <button class="btn btn-success" onclick="savePrices()">
                    <i class="fas fa-save"></i> Сохранить цены
                </button>
                <button class="btn btn-warning" onclick="sortPricesByPrice()">
                    <i class="fas fa-sort-amount-up"></i> Сортировать по цене
                </button>
            </div>
        </div>
        
        <!-- Вкладка: Команда -->
        <div class="tab-content" id="team">
            <div class="editor-toolbar">
                <div>
                    <strong>Команда преподавателей</strong>
                    <span class="counter" id="teamCount">0</span>
                </div>
                <button class="btn btn-primary btn-small" onclick="showTeamModal()">
                    <i class="fas fa-plus"></i> Добавить участника
                </button>
            </div>
            
            <div id="teamList" class="item-list">
                <!-- Команда будет добавляться динамически -->
            </div>
            
            <div class="actions">
                <button class="btn btn-success" onclick="saveTeam()">
                    <i class="fas fa-save"></i> Сохранить команду
                </button>
            </div>
        </div>
        
        <!-- Вкладка: Фотогалерея -->
        <div class="tab-content" id="photos">
            <div class="editor-toolbar">
                <div>
                    <strong>Фотогалерея</strong>
                    <span class="counter" id="photosCount">0</span>
                </div>
                <div>
                    <button class="btn btn-primary btn-small" onclick="showUploadPhotoModal()">
                        <i class="fas fa-upload"></i> Загрузить фото
                    </button>
                    <button class="btn btn-info btn-small" onclick="importDemoPhotos()">
                        <i class="fas fa-magic"></i> Демо-фото
                    </button>
                </div>
            </div>
            
            <div class="category-tags" id="galleryCategories">
                <!-- Категории будут добавляться динамически -->
            </div>
            
            <div id="galleryContainer" class="photo-container">
                <!-- Галерея будет отображаться здесь -->
            </div>
            
            <div id="emptyGallery" style="display: none; text-align: center; padding: 60px 20px;">
                <i class="fas fa-images" style="font-size: 64px; color: #ddd; margin-bottom: 20px;"></i>
                <h3 style="color: #666; margin-bottom: 15px;">Галерея пуста</h3>
                <p style="color: #888; margin-bottom: 25px;">Добавьте фотографии, чтобы наполнить галерею</p>
                <button class="btn btn-primary" onclick="showUploadPhotoModal()">
                    <i class="fas fa-plus"></i> Добавить первое фото
                </button>
            </div>
            
            <div class="actions">
                <button class="btn btn-success" onclick="saveGallery()">
                    <i class="fas fa-save"></i> Сохранить галерею
                </button>
                <button class="btn btn-danger" onclick="clearGallery()">
                    <i class="fas fa-trash"></i> Очистить галерею
                </button>
            </div>
        </div>
        
        <!-- Вкладка: Отзывы -->
        <div class="tab-content" id="reviews">
            <div class="editor-toolbar">
                <div>
                    <strong>Отзывы клиентов</strong>
                    <span class="counter" id="reviewsCount">0</span>
                </div>
                <div>
                    <button class="btn btn-primary btn-small" onclick="showReviewModal()">
                        <i class="fas fa-plus"></i> Добавить отзыв
                    </button>
                    <button class="btn btn-info btn-small" onclick="generateTestimonials()">
                        <i class="fas fa-comment-medical"></i> Сгенерировать отзывы
                    </button>
                </div>
            </div>
            
            <div id="reviewsList" class="item-list">
                <!-- Отзывы будут добавляться динамически -->
            </div>
            
            <div class="actions">
                <button class="btn btn-success" onclick="saveReviews()">
                    <i class="fas fa-save"></i> Сохранить отзывы
                </button>
            </div>
        </div>
        
        <!-- Вкладка: Новости -->
        <div class="tab-content" id="news">
            <div class="editor-toolbar">
                <div>
                    <strong>Новости студии</strong>
                    <span class="counter" id="newsCount">0</span>
                </div>
                <button class="btn btn-primary btn-small" onclick="showNewsModal()">
                    <i class="fas fa-plus"></i> Добавить новость
                </button>
            </div>
            
            <div id="newsList" class="item-list">
                <!-- Новости будут добавляться динамически -->
            </div>
            
            <div class="actions">
                <button class="btn btn-success" onclick="saveNews()">
                    <i class="fas fa-save"></i> Сохранить новости
                </button>
            </div>
        </div>
        
        <!-- Вкладка: FAQ -->
        <div class="tab-content" id="faq">
            <div class="editor-toolbar">
                <div>
                    <strong>Частые вопросы</strong>
                    <span class="counter" id="faqCount">0</span>
                </div>
                <button class="btn btn-primary btn-small" onclick="showFAQModal()">
                    <i class="fas fa-plus"></i> Добавить вопрос
                </button>
            </div>
            
            <div id="faqList" class="item-list">
                <!-- FAQ будет добавляться динамически -->
            </div>
            
            <div class="actions">
                <button class="btn btn-success" onclick="saveFAQ()">
                    <i class="fas fa-save"></i> Сохранить FAQ
                </button>
                <button class="btn btn-info" onclick="sortFAQ()">
                    <i class="fas fa-sort-alpha-down"></i> Сортировать
                </button>
            </div>
        </div>
        
        <!-- Вкладка: Настройки -->
        <div class="tab-content" id="settings">
            <div class="info-box">
                <div class="info-box-title">
                    <i class="fas fa-cogs"></i> Системные настройки
                </div>
                <div class="info-box-content">
                    Настройки редактора, экспорт/импорт данных, резервное копирование
                </div>
            </div>
            
            <div class="form-section">
                <h3><i class="fas fa-database"></i> Управление данными</h3>
                
                <div class="form-group">
                    <label>Статистика данных</label>
                    <div style="background: #f9f9f9; padding: 20px; border-radius: 10px;">
                        <div class="form-row">
                            <div style="flex: 1;">
                                <div style="font-size: 12px; color: #666;">Всего элементов</div>
                                <div style="font-size: 24px; font-weight: bold; color: var(--primary);" id="totalStats">0</div>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-size: 12px; color: #666;">Размер данных</div>
                                <div style="font-size: 24px; font-weight: bold; color: var(--info);" id="dataSize">0 КБ</div>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-size: 12px; color: #666;">Последнее сохранение</div>
                                <div style="font-size: 14px; font-weight: bold; color: var(--success);" id="lastSave">-</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="actions">
                    <button class="btn btn-success" onclick="createBackup()">
                        <i class="fas fa-save"></i> Создать резервную копию
                    </button>
                    <button class="btn btn-info" onclick="restoreBackup()">
                        <i class="fas fa-history"></i> Восстановить из копии
                    </button>
                </div>
            </div>
            
            <div class="form-section">
                <h3><i class="fas fa-file-export"></i> Экспорт и импорт</h3>
                
                <div class="form-group">
                    <label>Выберите разделы для экспорта</label>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px; margin-top: 10px;">
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="exportMain" checked> Основное
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="exportDirections" checked> Направления
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="exportSchedule" checked> Расписание
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="exportPrices" checked> Цены
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="exportTeam" checked> Команда
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="exportPhotos" checked> Фотогалерея
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="exportReviews" checked> Отзывы
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="exportNews" checked> Новости
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="exportFAQ" checked> FAQ
                        </label>
                    </div>
                </div>
                
                <div class="actions">
                    <button class="btn btn-primary" onclick="exportSelectedData()">
                        <i class="fas fa-download"></i> Экспорт выбранного
                    </button>
                    <button class="btn btn-warning" onclick="importData()">
                        <i class="fas fa-upload"></i> Импорт данных
                    </button>
                    <button class="btn btn-danger" onclick="clearAllData()">
                        <i class="fas fa-trash"></i> Очистить все
                    </button>
                </div>
            </div>
        </div>
        
        <div class="actions" style="margin: 30px; border-top: none;">
            <button class="btn btn-success btn-block pulse" onclick="saveAllData()" style="flex: 2;">
                <i class="fas fa-cloud-upload-alt"></i> СОХРАНИТЬ ВСЕ ИЗМЕНЕНИЯ НА САЙТ
            </button>
            <button class="btn btn-primary" onclick="loadFromWebsite()">
                <i class="fas fa-sync-alt"></i> Загрузить данные с сайта
            </button>
            <button class="btn btn-info" onclick="showDataSummary()">
                <i class="fas fa-chart-bar"></i> Статистика
            </button>
        </div>
    </div>
    
    <!-- ОБЩЕЕ МОДАЛЬНОЕ ОКНО -->
    <div class="modal-overlay" id="modalOverlay"></div>
    <div class="modal" id="commonModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle"><i class="fas fa-edit"></i> Редактирование</h2>
                <button class="modal-close" onclick="closeModal()">×</button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Контент будет загружен динамически -->
            </div>
            <div class="modal-footer" id="modalFooter">
                <!-- Кнопки будут добавляться динамически -->
            </div>
        </div>
    </div>
    
    <!-- Статус бар -->
    <div class="status-bar">
        <div class="status-message" id="statusMessage">
            Готово
        </div>
    </div>
    
    <script>
        // === КОНСТАНТЫ И ПЕРЕМЕННЫЕ ===
        let currentData = {
            main: {
                studioName: "Первый ритм Ленинского",
                phone: "+7 (904) 123-31-75",
                email: "info@primeritm.ru",
                address: "г. Иркутск, ул. 1-й Ленинский квартал, д. 1",
                workingHours: "Ежедневно с 8:00 до 22:00",
                trialPrice: "300₽",
                studioDescription: "Профессиональная студия танцев для всех возрастов. Современное оборудование, опытные преподаватели, индивидуальный подход.",
                socialLinks: [
                    { name: "VK", url: "https://vk.com/club233766207", icon: "fab fa-vk" },
                    { name: "Telegram", url: "#", icon: "fab fa-telegram" },
                    { name: "Instagram", url: "#", icon: "fab fa-instagram" }
                ]
            },
            directions: [],
            schedule: [],
            prices: [],
            team: [],
            gallery: [],
            reviews: [],
            news: [],
            faq: []
        };
        
        let pendingReviews = [];
        let currentPhotoCategory = 'studio';
        let editingItem = { type: null, index: -1 };
        let currentRating = 5;
        let currentScheduleDay = 'all';
        
        // === ИНИЦИАЛИЗАЦИЯ ===
        document.addEventListener('DOMContentLoaded', function() {
            loadFromWebsite();
            setupTabs();
            updateTotalCount();
        });
        
        // === НАСТРОЙКА ВКЛАДОК ===
        function setupTabs() {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // Скрываем все вкладки
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // Убираем активный класс у всех вкладок
                    tabs.forEach(t => t.classList.remove('active'));
                    
                    // Показываем выбранную вкладку
                    document.getElementById(tabId).classList.add('active');
                    this.classList.add('active');
                    
                    // Обновляем контент в зависимости от вкладки
                    if (tabId === 'photos') {
                        updateGalleryView();
                    } else if (tabId === 'schedule') {
                        updateScheduleSection();
                    }
                });
            });
        }
        
        // === ЗАГРУЗКА И СОХРАНЕНИЕ ДАННЫХ ===
        function loadFromWebsite() {
            showLoader('Загрузка данных с сайта...');
            
            setTimeout(() => {
                try {
                    const savedData = localStorage.getItem('studioData');
                    
                    if (savedData) {
                        const parsedData = JSON.parse(savedData);
                        
                        // Объединяем данные
                        if (parsedData.main) {
                            currentData.main = { ...currentData.main, ...parsedData.main };
                        }
                        
                        // Загружаем остальные данные
                        ['directions', 'schedule', 'prices', 'team', 'gallery', 'reviews', 'news', 'faq'].forEach(key => {
                            if (parsedData[key] && Array.isArray(parsedData[key])) {
                                currentData[key] = parsedData[key];
                            }
                        });
                        
                        showStatus('Данные загружены с сайта', 'success');
                    } else {
                        loadDemoData();
                        showStatus('Загружены демо-данные', 'info');
                    }
                    
                    updateAllSections();
                    hideLoader();
                    
                } catch (error) {
                    console.error('Ошибка загрузки данных:', error);
                    showStatus('Ошибка загрузки данных', 'error');
                    hideLoader();
                }
            }, 500);
        }
        
        function loadDemoData() {
            // Основные настройки уже установлены по умолчанию
            
            // Демо направления
            currentData.directions = [
                {
                    id: 'baby-dance',
                    title: 'Танец-игра / Ритмика',
                    age: '3-7 лет',
                    schedule: 'Понедельник и среда в 17:00',
                    price: 'Пробное занятие: 300₽',
                    description: 'Развитие чувства ритма, координации и любви к движению через веселые игры.',
                    features: ['Игровая форма', 'Развитие ритма', 'Координация']
                },
                {
                    id: 'kids-classic',
                    title: 'Классическая хореография',
                    age: '8-12 лет',
                    schedule: 'Понедельник, среда, пятница в 16:00',
                    price: 'Абонемент: 2800₽/мес',
                    description: 'Углубленное изучение основ балета. Укрепление мышечного корсета.',
                    features: ['Осанка', 'Гибкость', 'Дисциплина']
                }
            ];
            
            // Демо расписание
            currentData.schedule = [
                {
                    id: 's1',
                    day: 'monday',
                    dayName: 'Понедельник',
                    time: '17:00',
                    duration: '60',
                    direction: 'Танец-игра / Ритмика',
                    age: '3-7 лет',
                    instructor: 'Анна Петрова',
                    room: 'Зал №1',
                    maxParticipants: '12',
                    isHighlighted: true
                },
                {
                    id: 's2',
                    day: 'monday',
                    dayName: 'Понедельник',
                    time: '18:30',
                    duration: '90',
                    direction: 'Contemporary для начинающих',
                    age: '13-17 лет',
                    instructor: 'Елена Сидорова',
                    room: 'Зал №2',
                    maxParticipants: '15',
                    isHighlighted: false
                },
                {
                    id: 's3',
                    day: 'wednesday',
                    dayName: 'Среда',
                    time: '17:00',
                    duration: '60',
                    direction: 'Танец-игра / Ритмика',
                    age: '3-7 лет',
                    instructor: 'Анна Петрова',
                    room: 'Зал №1',
                    maxParticipants: '12',
                    isHighlighted: true
                },
                {
                    id: 's4',
                    day: 'friday',
                    dayName: 'Пятница',
                    time: '16:00',
                    duration: '90',
                    direction: 'Классическая хореография',
                    age: '8-12 лет',
                    instructor: 'Ирина Ковалева',
                    room: 'Зал №1',
                    maxParticipants: '10',
                    isHighlighted: false
                }
            ];
            
            // Демо цены
            currentData.prices = [
                {
                    featured: true,
                    title: "ПРОБНОЕ ЗАНЯТИЕ",
                    subtitle: "Любое направление",
                    price: "300₽",
                    period: "1 занятие",
                    features: ["Первое занятие", "Консультация педагога", "Подбор направления"]
                },
                {
                    title: "ДЕТСКИЙ",
                    subtitle: "3-16 лет",
                    price: "2 800₽",
                    period: "8 занятий",
                    features: ["Абонемент на 30 дней", "Любое направление", "Заморозка на 7 дней"]
                }
            ];
            
            // Демо команда
            currentData.team = [
                {
                    initials: "АП",
                    name: "Анна Петрова",
                    role: "Главный хореограф",
                    experience: "14 лет",
                    description: "Профессиональный хореограф с международным опытом."
                },
                {
                    initials: "ЕС",
                    name: "Елена Сидорова",
                    role: "Педагог детских групп",
                    experience: "8 лет",
                    description: "Специалист по работе с детьми 3-7 лет."
                }
            ];
            
            // Демо галерея
            currentData.gallery = [
                {
                    id: 1,
                    title: "Основной зал студии",
                    description: "Профессиональное покрытие, зеркала, современное оборудование",
                    image: "https://images.unsplash.com/photo-1518834103328-93d45986dce1?auto=format&fit=crop&w=600&q=80",
                    category: "studio",
                    date: new Date().toLocaleDateString('ru-RU')
                },
                {
                    id: 2,
                    title: "Детская группа 4-6 лет",
                    description: "Яркие и веселые занятия для самых маленьких",
                    image: "https://images.unsplash.com/photo-1500462918059-b1a0cb512f1d?auto=format&fit=crop&w=600&q=80",
                    category: "kids",
                    date: new Date().toLocaleDateString('ru-RU')
                }
            ];
            
            // Демо отзывы
            currentData.reviews = [
                {
                    rating: 5,
                    text: '"Дочь ходит второй год, вижу огромный прогреск! Преподаватели очень внимательные, находят подход к каждому ребенку. Рекомендую!"',
                    author: "Анна К.",
                    role: "Мама Софии (6 лет)",
                    initials: "АК"
                }
            ];
            
            // Демо новости
            currentData.news = [
                {
                    id: 1,
                    title: "Новый набор на детские группы!",
                    date: new Date().toLocaleDateString('ru-RU'),
                    image: "https://images.unsplash.com/photo-1518834103328-93d45986dce1?auto=format&fit=crop&w=600&q=80",
                    description: "Открыт набор в группы для детей 3-6 лет.",
                    shortText: "Открыт набор в детские группы 3-6 лет",
                    link: "#directions"
                }
            ];
            
            // Демо FAQ
            currentData.faq = [
                {
                    question: "С какого возраста можно начинать заниматься?",
                    answer: "Мы принимаем детей с 3 лет на программу 'Танцы-игра'."
                },
                {
                    question: "Нужна ли специальная подготовка?",
                    answer: "Нет, большинство наших групп рассчитаны на начинающих."
                }
            ];
        }
        
        function saveAllData() {
            showLoader('Сохранение данных на сайт...');
            
            setTimeout(() => {
                try {
                    localStorage.setItem('studioData', JSON.stringify(currentData));
                    
                    // Сохраняем время последнего сохранения
                    localStorage.setItem('lastSaveTime', new Date().toISOString());
                    
                    updateStats();
                    hideLoader();
                    showStatus('Все данные успешно сохранены на сайт!', 'success');
                    
                    // Обновляем счетчики
                    updateTotalCount();
                    
                } catch (error) {
                    console.error('Ошибка сохранения данных:', error);
                    hideLoader();
                    showStatus('Ошибка сохранения: ' + error.message, 'error');
                }
            }, 800);
        }
        
        // === ОБНОВЛЕНИЕ СЕКЦИЙ ===
        function updateAllSections() {
            updateMainSection();
            updateDirectionsSection();
            updateScheduleSection();
            updatePricesSection();
            updateTeamSection();
            updateGallerySection();
            updateReviewsSection();
            updateNewsSection();
            updateFAQSection();
            updateCounters();
            updateStats();
        }
        
        function updateCounters() {
            document.getElementById('directionsCount').textContent = currentData.directions.length;
            document.getElementById('scheduleCount').textContent = currentData.schedule.length;
            document.getElementById('pricesCount').textContent = currentData.prices.length;
            document.getElementById('teamCount').textContent = currentData.team.length;
            document.getElementById('photosCount').textContent = currentData.gallery.length;
            document.getElementById('reviewsCount').textContent = currentData.reviews.length;
            document.getElementById('newsCount').textContent = currentData.news.length;
            document.getElementById('faqCount').textContent = currentData.faq.length;
            
            // Обновляем бейджи на вкладках
            document.getElementById('directionsBadge').textContent = currentData.directions.length;
            document.getElementById('scheduleBadge').textContent = currentData.schedule.length;
            document.getElementById('pricesBadge').textContent = currentData.prices.length;
            document.getElementById('teamBadge').textContent = currentData.team.length;
            document.getElementById('photosBadge').textContent = currentData.gallery.length;
            document.getElementById('reviewsBadge').textContent = currentData.reviews.length;
            document.getElementById('newsBadge').textContent = currentData.news.length;
            document.getElementById('faqBadge').textContent = currentData.faq.length;
        }
        
        function updateTotalCount() {
            const total = Object.values(currentData).reduce((sum, section) => {
                if (Array.isArray(section)) {
                    return sum + section.length;
                }
                return sum;
            }, 0);
            
            document.getElementById('totalItemsCount').textContent = total;
        }
        
        // === МОДАЛЬНЫЕ ОКНА ===
        function openModal() {
            document.getElementById('modalOverlay').classList.add('active');
            document.getElementById('commonModal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function closeModal() {
            document.getElementById('modalOverlay').classList.remove('active');
            document.getElementById('commonModal').classList.remove('active');
            document.body.style.overflow = 'auto';
            editingItem = { type: null, index: -1 };
            currentRating = 5;
        }
        
        function showModal(title, content, footer = '') {
            document.getElementById('modalTitle').innerHTML = title;
            document.getElementById('modalBody').innerHTML = content;
            document.getElementById('modalFooter').innerHTML = footer;
            openModal();
        }
        
        // === СЕКЦИЯ: ОСНОВНОЕ ===
        function updateMainSection() {
            const main = currentData.main;
            
            document.getElementById('studioName').value = main.studioName || '';
            document.getElementById('phone').value = main.phone || '';
            document.getElementById('email').value = main.email || '';
            document.getElementById('address').value = main.address || '';
            document.getElementById('workingHours').value = main.workingHours || '';
            document.getElementById('trialPrice').value = main.trialPrice || '';
            document.getElementById('studioDescription').value = main.studioDescription || '';
            
            updateSocialLinks();
        }
        
        function updateSocialLinks() {
            const container = document.getElementById('socialLinksList');
            container.innerHTML = '';
            
            currentData.main.socialLinks.forEach((link, index) => {
                const div = document.createElement('div');
                div.className = 'form-row';
                div.innerHTML = `
                    <div class="form-group">
                        <label>Название</label>
                        <input type="text" value="${link.name || ''}" 
                               onchange="updateSocialLinkField(${index}, 'name', this.value)">
                    </div>
                    <div class="form-group">
                        <label>Ссылка</label>
                        <input type="text" value="${link.url || ''}" 
                               onchange="updateSocialLinkField(${index}, 'url', this.value)">
                    </div>
                    <div class="form-group">
                        <label>Иконка (FontAwesome)</label>
                        <input type="text" value="${link.icon || ''}" 
                               onchange="updateSocialLinkField(${index}, 'icon', this.value)">
                    </div>
                    <div class="form-group" style="flex: 0 0 auto; padding-top: 25px;">
                        <button class="btn btn-danger btn-small" onclick="removeSocialLink(${index})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                container.appendChild(div);
            });
        }
        
        function updateSocialLinkField(index, field, value) {
            if (currentData.main.socialLinks[index]) {
                currentData.main.socialLinks[index][field] = value;
            }
        }
        
        function addSocialLink() {
            currentData.main.socialLinks.push({
                name: 'Новая соцсеть',
                url: '#',
                icon: 'fab fa-facebook'
            });
            updateSocialLinks();
        }
        
        function removeSocialLink(index) {
            if (confirm('Удалить эту социальную сеть?')) {
                currentData.main.socialLinks.splice(index, 1);
                updateSocialLinks();
            }
        }
        
        function saveMainSettings() {
            currentData.main.studioName = document.getElementById('studioName').value;
            currentData.main.phone = document.getElementById('phone').value;
            currentData.main.email = document.getElementById('email').value;
            currentData.main.address = document.getElementById('address').value;
            currentData.main.workingHours = document.getElementById('workingHours').value;
            currentData.main.trialPrice = document.getElementById('trialPrice').value;
            currentData.main.studioDescription = document.getElementById('studioDescription').value;
            
            saveAllData();
            showStatus('Основные настройки сохранены', 'success');
        }
        
        function resetMainSettings() {
            if (confirm('Сбросить основные настройки к значениям по умолчанию?')) {
                currentData.main = {
                    studioName: "Первый ритм Ленинского",
                    phone: "+7 (904) 123-31-75",
                    email: "info@primeritm.ru",
                    address: "г. Иркутск, ул. 1-й Ленинский квартал, д. 1",
                    workingHours: "Ежедневно с 8:00 до 22:00",
                    trialPrice: "300₽",
                    studioDescription: "Профессиональная студия танцев для всех возрастов. Современное оборудование, опытные преподаватели, индивидуальный подход.",
                    socialLinks: [
                        { name: "VK", url: "https://vk.com/club233766207", icon: "fab fa-vk" },
                        { name: "Telegram", url: "#", icon: "fab fa-telegram" },
                        { name: "Instagram", url: "#", icon: "fab fa-instagram" }
                    ]
                };
                
                updateMainSection();
                showStatus('Настройки сброшены', 'success');
            }
        }
        
        // === СЕКЦИЯ: НАПРАВЛЕНИЯ ===
        function updateDirectionsSection() {
            const container = document.getElementById('directionsList');
            container.innerHTML = '';
            
            if (currentData.directions.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #666;">
                        <i class="fas fa-dance" style="font-size: 48px; margin-bottom: 20px; opacity: 0.3;"></i>
                        <h3>Нет направлений</h3>
                        <p>Добавьте танцевальные направления вашей студии</p>
                    </div>
                `;
                return;
            }
            
            currentData.directions.forEach((direction, index) => {
                const div = document.createElement('div');
                div.className = 'item';
                div.innerHTML = `
                    <div class="item-info">
                        <h4>
                            <i class="fas fa-music"></i>
                            ${direction.title || 'Новое направление'}
                            ${direction.featured ? ' <span style="color: var(--warning);">★</span>' : ''}
                        </h4>
                        <p>
                            <span style="background: rgba(52, 152, 219, 0.1); padding: 2px 8px; border-radius: 10px; font-size: 12px;">
                                <i class="fas fa-user"></i> ${direction.age || 'Все возрасты'}
                            </span>
                            <span style="margin-left: 10px; color: var(--primary); font-weight: bold;">
                                ${direction.price || 'Цена по запросу'}
                            </span>
                        </p>
                        <p style="font-size: 13px; color: #666; margin-top: 5px;">
                            <i class="fas fa-calendar-alt"></i> ${direction.schedule || 'По расписанию'}
                        </p>
                        <p style="font-size: 12px; color: #888; margin-top: 5px;">
                            ${direction.description || ''}
                        </p>
                    </div>
                    <div class="item-actions">
                        <button class="btn btn-primary btn-small" onclick="editDirection(${index})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-danger btn-small" onclick="removeDirection(${index})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                container.appendChild(div);
            });
        }
        
        function showDirectionModal(index = -1) {
            editingItem = { type: 'direction', index: index };
            let direction = index >= 0 ? currentData.directions[index] : null;
            
            const title = index >= 0 ? '<i class="fas fa-edit"></i> Редактировать направление' : '<i class="fas fa-plus"></i> Добавить направление';
            
            const content = `
                <div class="form-group">
                    <label>Название направления *</label>
                    <input type="text" id="modalDirectionTitle" value="${direction ? direction.title : ''}" placeholder="Например: Contemporary dance" class="modal-input">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Возрастная группа</label>
                        <input type="text" id="modalDirectionAge" value="${direction ? direction.age : ''}" placeholder="3-7 лет" class="modal-input">
                    </div>
                    <div class="form-group">
                        <label>Цена</label>
                        <input type="text" id="modalDirectionPrice" value="${direction ? direction.price : ''}" placeholder="300₽ (пробное)" class="modal-input">
                    </div>
                </div>
                <div class="form-group">
                    <label>Расписание</label>
                    <input type="text" id="modalDirectionSchedule" value="${direction ? direction.schedule : ''}" placeholder="Пн и Ср в 17:00" class="modal-input">
                </div>
                <div class="form-group">
                    <label>Описание</label>
                    <textarea id="modalDirectionDescription" placeholder="Подробное описание направления..." rows="4" class="modal-input">${direction ? direction.description : ''}</textarea>
                </div>
                <div class="form-group">
                    <label>Преимущества (каждое с новой строки)</label>
                    <textarea id="modalDirectionFeatures" placeholder="Развитие гибкости
Улучшение координации
Развитие музыкальности" rows="4" class="modal-input">${direction && direction.features ? direction.features.join('\n') : ''}</textarea>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="modalDirectionFeatured" ${direction && direction.featured ? 'checked' : ''}>
                        Сделать рекомендуемым направлением
                    </label>
                </div>
            `;
            
            const footer = `
                <button class="btn btn-success" onclick="saveDirection()">
                    <i class="fas fa-save"></i> ${index >= 0 ? 'Сохранить' : 'Добавить'}
                </button>
                ${index >= 0 ? `
                <button class="btn btn-danger" onclick="removeDirection(${index}); closeModal();">
                    <i class="fas fa-trash"></i> Удалить
                </button>
                ` : ''}
                <button class="btn" onclick="closeModal()">
                    <i class="fas fa-times"></i> Отмена
                </button>
            `;
            
            showModal(title, content, footer);
        }
        
        function editDirection(index) {
            showDirectionModal(index);
        }
        
        function saveDirection() {
            const title = document.getElementById('modalDirectionTitle').value.trim();
            if (!title) {
                showStatus('Введите название направления', 'error');
                return;
            }
            
            const featuresText = document.getElementById('modalDirectionFeatures').value;
            const features = featuresText.split('\n').map(f => f.trim()).filter(f => f);
            
            const directionData = {
                id: editingItem.index >= 0 ? currentData.directions[editingItem.index].id : 'direction-' + Date.now(),
                title: title,
                age: document.getElementById('modalDirectionAge').value,
                price: document.getElementById('modalDirectionPrice').value,
                schedule: document.getElementById('modalDirectionSchedule').value,
                description: document.getElementById('modalDirectionDescription').value,
                features: features,
                featured: document.getElementById('modalDirectionFeatured').checked
            };
            
            if (editingItem.index >= 0) {
                currentData.directions[editingItem.index] = directionData;
            } else {
                currentData.directions.push(directionData);
            }
            
            updateDirectionsSection();
            updateCounters();
            closeModal();
            showStatus('Направление сохранено', 'success');
        }
        
        function removeDirection(index) {
            if (confirm('Удалить это направление?')) {
                currentData.directions.splice(index, 1);
                updateDirectionsSection();
                updateCounters();
                showStatus('Направление удалено', 'success');
            }
        }
        
        function importDemoDirections() {
            const demoDirections = [
                {
                    id: 'baby-dance',
                    title: 'Танец-игра / Ритмика',
                    age: '3-7 лет',
                    schedule: 'Понедельник и среда в 17:00',
                    price: 'Пробное занятие: 300₽',
                    description: 'Развитие чувства ритма, координации и любви к движению через веселые игры и простые танцевальные комбинации.',
                    features: ['Игровая форма', 'Развитие ритма', 'Координация', 'Гибкость']
                },
                {
                    id: 'baby-classic',
                    title: 'Азбука классического танца',
                    age: '3-7 лет',
                    schedule: 'Вторник и четверг в 17:30',
                    price: 'Пробное занятие: 300₽',
                    description: 'Первое знакомство с основами балета в игровой форме. Постановка корпуса, развитие гибкости и музыкальности.',
                    features: ['Основы балета', 'Постановка корпуса', 'Развитие гибкости']
                }
            ];
            
            currentData.directions = [...currentData.directions, ...demoDirections];
            updateDirectionsSection();
            updateCounters();
            showStatus('Демо-направления добавлены', 'success');
        }
        
        function clearDirections() {
            if (currentData.directions.length === 0) {
                showStatus('Нет направлений для очистки', 'warning');
                return;
            }
            
            if (confirm('Очистить все направления? Это действие нельзя отменить.')) {
                currentData.directions = [];
                updateDirectionsSection();
                updateCounters();
                showStatus('Все направления очищены', 'success');
            }
        }
        
        function saveDirections() {
            saveAllData();
            showStatus('Направления сохранены', 'success');
        }
        
        // === СЕКЦИЯ: РАСПИСАНИЕ ===
        function updateScheduleSection() {
            updateScheduleDays();
            updateScheduleTable();
            updateScheduleEmptyState();
        }
        
        function updateScheduleDays() {
            const days = [
                { id: 'all', name: 'Все дни' },
                { id: 'monday', name: 'Понедельник' },
                { id: 'tuesday', name: 'Вторник' },
                { id: 'wednesday', name: 'Среда' },
                { id: 'thursday', name: 'Четверг' },
                { id: 'friday', name: 'Пятница' },
                { id: 'saturday', name: 'Суббота' },
                { id: 'sunday', name: 'Воскресенье' }
            ];
            
            const container = document.getElementById('scheduleDays');
            container.innerHTML = '';
            
            days.forEach(day => {
                const count = day.id === 'all' 
                    ? currentData.schedule.length 
                    : currentData.schedule.filter(item => item.day === day.id).length;
                
                const div = document.createElement('div');
                div.className = `schedule-day ${currentScheduleDay === day.id ? 'active' : ''}`;
                div.innerHTML = `
                    ${day.name}
                    <span style="font-size: 12px; background: rgba(255,255,255,0.2); padding: 1px 6px; border-radius: 10px; margin-left: 5px;">${count}</span>
                `;
                div.onclick = () => filterScheduleByDay(day.id);
                container.appendChild(div);
            });
        }
        
        function filterScheduleByDay(dayId) {
            currentScheduleDay = dayId;
            updateScheduleDays();
            updateScheduleTable();
        }
        
        function showAllDays() {
            filterScheduleByDay('all');
        }
        
        function showTodaySchedule() {
            const days = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
            const today = new Date().getDay(); // 0 - воскресенье, 1 - понедельник и т.д.
            const todayId = days[today];
            filterScheduleByDay(todayId);
        }
        
        function updateScheduleTable() {
            const container = document.getElementById('scheduleTableContainer');
            const empty = document.getElementById('emptySchedule');
            
            // Фильтруем занятия по выбранному дню
            let filteredSchedule = currentData.schedule;
            if (currentScheduleDay !== 'all') {
                filteredSchedule = currentData.schedule.filter(item => item.day === currentScheduleDay);
            }
            
            if (filteredSchedule.length === 0) {
                container.innerHTML = '';
                empty.style.display = 'block';
                return;
            }
            
            empty.style.display = 'none';
            
            // Сортируем по времени
            filteredSchedule.sort((a, b) => {
                const timeA = a.time.replace(':', '');
                const timeB = b.time.replace(':', '');
                return timeA - timeB;
            });
            
            // Группируем по времени для таблицы
            const timeSlots = [...new Set(filteredSchedule.map(item => item.time))].sort();
            
            let html = `
                <table class="schedule-table">
                    <thead>
                        <tr>
                            <th>Время</th>
                            <th>Направление / Группа</th>
                            <th>Возраст</th>
                            <th>Преподаватель</th>
                            <th>Зал</th>
                            <th>Действия</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            timeSlots.forEach(timeSlot => {
                const items = filteredSchedule.filter(item => item.time === timeSlot);
                
                items.forEach((item, index) => {
                    const isFirst = index === 0;
                    const rowSpan = items.length;
                    
                    html += `
                        <tr>
                            ${isFirst ? `<td rowspan="${rowSpan}" style="font-weight: bold; font-size: 16px;">${item.time}</td>` : ''}
                            <td>
                                <div class="schedule-item ${item.isHighlighted ? 'schedule-item-highlight' : ''}">
                                    <div class="schedule-direction">${item.direction}</div>
                                    <div class="schedule-time">${item.duration} минут</div>
                                    <div class="schedule-actions">
                                        <button class="schedule-action-btn edit-schedule" onclick="editScheduleItem('${item.id}')">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="schedule-action-btn delete-schedule" onclick="removeScheduleItem('${item.id}')">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            </td>
                            <td>
                                <span class="schedule-age">${item.age}</span>
                            </td>
                            <td>
                                <div class="schedule-instructor">${item.instructor}</div>
                            </td>
                            <td>
                                ${item.room}
                                ${item.maxParticipants ? `<br><small>до ${item.maxParticipants} чел.</small>` : ''}
                            </td>
                            ${isFirst ? `<td rowspan="${rowSpan}">
                                <button class="btn btn-small btn-primary" onclick="editScheduleItem('${item.id}')">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-small btn-danger" onclick="removeScheduleItem('${item.id}')">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </td>` : ''}
                        </tr>
                    `;
                });
            });
            
            html += `
                    </tbody>
                </table>
            `;
            
            container.innerHTML = html;
        }
        
        function updateScheduleEmptyState() {
            const empty = document.getElementById('emptySchedule');
            if (currentData.schedule.length === 0) {
                empty.style.display = 'block';
            } else {
                empty.style.display = 'none';
            }
        }
        
        function showScheduleModal(index = -1) {
            editingItem = { type: 'schedule', index: index };
            
            // Если передали index, ищем по индексу, иначе по id
            let scheduleItem;
            if (typeof index === 'number' && index >= 0) {
                scheduleItem = currentData.schedule[index];
            } else if (typeof index === 'string') {
                const itemIndex = currentData.schedule.findIndex(item => item.id === index);
                if (itemIndex >= 0) {
                    scheduleItem = currentData.schedule[itemIndex];
                    editingItem.index = itemIndex;
                }
            }
            
            const title = scheduleItem ? '<i class="fas fa-edit"></i> Редактировать занятие' : '<i class="fas fa-plus"></i> Добавить занятие';
            
            // Подготавливаем списки направлений и преподавателей
            const directionOptions = currentData.directions.map(dir => 
                `<option value="${dir.title}" ${scheduleItem && scheduleItem.direction === dir.title ? 'selected' : ''}>${dir.title}</option>`
            ).join('');
            
            const instructorOptions = currentData.team.map(member => 
                `<option value="${member.name}" ${scheduleItem && scheduleItem.instructor === member.name ? 'selected' : ''}>${member.name}</option>`
            ).join('');
            
            // Стандартные временные слоты
            const timeSlots = [
                '09:00', '10:00', '11:00', '12:00', '13:00', '14:00', 
                '15:00', '16:00', '17:00', '18:00', '19:00', '20:00'
            ];
            
            const timeOptions = timeSlots.map(time => 
                `<option value="${time}" ${scheduleItem && scheduleItem.time === time ? 'selected' : ''}>${time}</option>`
            ).join('');
            
            const content = `
                <div class="form-row">
                    <div class="form-group">
                        <label>День недели *</label>
                        <select id="modalScheduleDay" class="modal-input">
                            <option value="monday" ${scheduleItem && scheduleItem.day === 'monday' ? 'selected' : ''}>Понедельник</option>
                            <option value="tuesday" ${scheduleItem && scheduleItem.day === 'tuesday' ? 'selected' : ''}>Вторник</option>
                            <option value="wednesday" ${scheduleItem && scheduleItem.day === 'wednesday' ? 'selected' : ''}>Среда</option>
                            <option value="thursday" ${scheduleItem && scheduleItem.day === 'thursday' ? 'selected' : ''}>Четверг</option>
                            <option value="friday" ${scheduleItem && scheduleItem.day === 'friday' ? 'selected' : ''}>Пятница</option>
                            <option value="saturday" ${scheduleItem && scheduleItem.day === 'saturday' ? 'selected' : ''}>Суббота</option>
                            <option value="sunday" ${scheduleItem && scheduleItem.day === 'sunday' ? 'selected' : ''}>Воскресенье</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Время начала *</label>
                        <select id="modalScheduleTime" class="modal-input">
                            ${timeOptions}
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Продолжительность (минут) *</label>
                        <select id="modalScheduleDuration" class="modal-input">
                            <option value="45" ${scheduleItem && scheduleItem.duration === '45' ? 'selected' : ''}>45 минут</option>
                            <option value="60" ${scheduleItem && scheduleItem.duration === '60' ? 'selected' : ''}>60 минут</option>
                            <option value="90" ${scheduleItem && scheduleItem.duration === '90' ? 'selected' : ''}>90 минут</option>
                            <option value="120" ${scheduleItem && scheduleItem.duration === '120' ? 'selected' : ''}>120 минут</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Макс. участников</label>
                        <input type="number" id="modalScheduleMaxParticipants" value="${scheduleItem ? scheduleItem.maxParticipants : '15'}" class="modal-input" min="1" max="50">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Направление *</label>
                    <select id="modalScheduleDirection" class="modal-input">
                        <option value="">Выберите направление</option>
                        ${directionOptions}
                        <option value="custom">Другое (ввести вручную)</option>
                    </select>
                    <input type="text" id="modalScheduleDirectionCustom" 
                           value="${scheduleItem && !currentData.directions.some(d => d.title === scheduleItem.direction) ? scheduleItem.direction : ''}" 
                           placeholder="Введите название направления" 
                           class="modal-input" 
                           style="margin-top: 10px; display: ${scheduleItem && !currentData.directions.some(d => d.title === scheduleItem.direction) ? 'block' : 'none'}">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Возрастная группа *</label>
                        <input type="text" id="modalScheduleAge" value="${scheduleItem ? scheduleItem.age : ''}" placeholder="3-7 лет" class="modal-input">
                    </div>
                    <div class="form-group">
                        <label>Преподаватель</label>
                        <select id="modalScheduleInstructor" class="modal-input">
                            <option value="">Выберите преподавателя</option>
                            ${instructorOptions}
                            <option value="custom">Другой (ввести вручную)</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Зал / Помещение</label>
                        <input type="text" id="modalScheduleRoom" value="${scheduleItem ? scheduleItem.room : 'Зал №1'}" placeholder="Зал №1" class="modal-input">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="modalScheduleHighlighted" ${scheduleItem && scheduleItem.isHighlighted ? 'checked' : ''}>
                        Выделить это занятие (рекомендованное / популярное)
                    </label>
                </div>
                
                <div class="form-group">
                    <label>Примечание</label>
                    <textarea id="modalScheduleNote" placeholder="Дополнительная информация..." rows="2" class="modal-input">${scheduleItem ? scheduleItem.note || '' : ''}</textarea>
                </div>
                
                <div class="info-box">
                    <div class="info-box-title">
                        <i class="fas fa-info-circle"></i> Подсказка
                    </div>
                    <div class="info-box-content">
                        Создавайте направления и преподавателей в соответствующих разделах, чтобы выбирать их здесь из списка.
                    </div>
                </div>
            `;
            
            const footer = `
                <button class="btn btn-success" onclick="saveScheduleItem()">
                    <i class="fas fa-save"></i> ${scheduleItem ? 'Сохранить' : 'Добавить'}
                </button>
                ${scheduleItem ? `
                <button class="btn btn-danger" onclick="removeScheduleItem('${scheduleItem.id}'); closeModal();">
                    <i class="fas fa-trash"></i> Удалить
                </button>
                ` : ''}
                <button class="btn" onclick="closeModal()">
                    <i class="fas fa-times"></i> Отмена
                </button>
            `;
            
            showModal(title, content, footer);
            
            // Настраиваем переключение между выбранным направлением и ручным вводом
            document.getElementById('modalScheduleDirection').addEventListener('change', function() {
                const customInput = document.getElementById('modalScheduleDirectionCustom');
                if (this.value === 'custom') {
                    customInput.style.display = 'block';
                    customInput.required = true;
                } else {
                    customInput.style.display = 'none';
                    customInput.required = false;
                }
            });
            
            document.getElementById('modalScheduleInstructor').addEventListener('change', function() {
                if (this.value === 'custom') {
                    // Создаем поле для ручного ввода преподавателя
                    const instructorGroup = this.closest('.form-group');
                    const customInput = document.createElement('input');
                    customInput.type = 'text';
                    customInput.id = 'modalScheduleInstructorCustom';
                    customInput.className = 'modal-input';
                    customInput.style.marginTop = '10px';
                    customInput.placeholder = 'Введите имя преподавателя';
                    customInput.required = true;
                    
                    if (!document.getElementById('modalScheduleInstructorCustom')) {
                        instructorGroup.appendChild(customInput);
                    }
                } else {
                    // Удаляем поле ручного ввода, если оно есть
                    const customInput = document.getElementById('modalScheduleInstructorCustom');
                    if (customInput) {
                        customInput.remove();
                    }
                }
            });
        }
        
        function editScheduleItem(id) {
            showScheduleModal(id);
        }
        
        function saveScheduleItem() {
            const day = document.getElementById('modalScheduleDay').value;
            const time = document.getElementById('modalScheduleTime').value;
            const duration = document.getElementById('modalScheduleDuration').value;
            
            // Получаем направление
            let direction;
            const directionSelect = document.getElementById('modalScheduleDirection');
            if (directionSelect.value === 'custom') {
                direction = document.getElementById('modalScheduleDirectionCustom').value.trim();
            } else {
                direction = directionSelect.value;
            }
            
            // Получаем преподавателя
            let instructor;
            const instructorSelect = document.getElementById('modalScheduleInstructor');
            if (instructorSelect.value === 'custom') {
                instructor = document.getElementById('modalScheduleInstructorCustom')?.value.trim() || '';
            } else {
                instructor = instructorSelect.value;
            }
            
            if (!day || !time || !duration || !direction) {
                showStatus('Заполните обязательные поля', 'error');
                return;
            }
            
            // Генерируем имя дня
            const dayNames = {
                monday: 'Понедельник',
                tuesday: 'Вторник',
                wednesday: 'Среда',
                thursday: 'Четверг',
                friday: 'Пятница',
                saturday: 'Суббота',
                sunday: 'Воскресенье'
            };
            
            const scheduleData = {
                id: editingItem.index >= 0 ? currentData.schedule[editingItem.index].id : 'schedule-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9),
                day: day,
                dayName: dayNames[day],
                time: time,
                duration: duration,
                direction: direction,
                age: document.getElementById('modalScheduleAge').value,
                instructor: instructor,
                room: document.getElementById('modalScheduleRoom').value,
                maxParticipants: document.getElementById('modalScheduleMaxParticipants').value,
                isHighlighted: document.getElementById('modalScheduleHighlighted').checked,
                note: document.getElementById('modalScheduleNote').value
            };
            
            if (editingItem.index >= 0) {
                currentData.schedule[editingItem.index] = scheduleData;
            } else {
                currentData.schedule.push(scheduleData);
            }
            
            // Сортируем расписание по дню и времени
            currentData.schedule.sort((a, b) => {
                const dayOrder = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
                const dayCompare = dayOrder.indexOf(a.day) - dayOrder.indexOf(b.day);
                if (dayCompare !== 0) return dayCompare;
                
                const timeA = a.time.replace(':', '');
                const timeB = b.time.replace(':', '');
                return timeA - timeB;
            });
            
            updateScheduleSection();
            updateCounters();
            closeModal();
            showStatus('Занятие сохранено в расписании', 'success');
        }
        
        function removeScheduleItem(id) {
            const index = currentData.schedule.findIndex(item => item.id === id);
            if (index === -1) return;
            
            if (confirm('Удалить это занятие из расписания?')) {
                currentData.schedule.splice(index, 1);
                updateScheduleSection();
                updateCounters();
                showStatus('Занятие удалено из расписания', 'success');
            }
        }
        
        function importDemoSchedule() {
            const demoSchedule = [
                {
                    id: 'demo1',
                    day: 'monday',
                    dayName: 'Понедельник',
                    time: '17:00',
                    duration: '60',
                    direction: 'Танец-игра / Ритмика',
                    age: '3-7 лет',
                    instructor: 'Анна Петрова',
                    room: 'Зал №1',
                    maxParticipants: '12',
                    isHighlighted: true
                },
                {
                    id: 'demo2',
                    day: 'wednesday',
                    dayName: 'Среда',
                    time: '17:00',
                    duration: '60',
                    direction: 'Танец-игра / Ритмика',
                    age: '3-7 лет',
                    instructor: 'Анна Петрова',
                    room: 'Зал №1',
                    maxParticipants: '12',
                    isHighlighted: true
                },
                {
                    id: 'demo3',
                    day: 'friday',
                    dayName: 'Пятница',
                    time: '16:00',
                    duration: '90',
                    direction: 'Классическая хореография',
                    age: '8-12 лет',
                    instructor: 'Ирина Ковалева',
                    room: 'Зал №1',
                    maxParticipants: '10',
                    isHighlighted: false
                },
                {
                    id: 'demo4',
                    day: 'saturday',
                    dayName: 'Суббота',
                    time: '11:00',
                    duration: '60',
                    direction: 'Хип-хоп для подростков',
                    age: '13-17 лет',
                    instructor: 'Дмитрий Волков',
                    room: 'Зал №2',
                    maxParticipants: '15',
                    isHighlighted: false
                }
            ];
            
            currentData.schedule = [...currentData.schedule, ...demoSchedule];
            updateScheduleSection();
            updateCounters();
            showStatus('Демо-расписание добавлено', 'success');
        }
        
        function clearSchedule() {
            if (currentData.schedule.length === 0) {
                showStatus('Расписание уже пусто', 'warning');
                return;
            }
            
            if (confirm('Очистить всё расписание? Это действие нельзя отменить.')) {
                currentData.schedule = [];
                updateScheduleSection();
                updateCounters();
                showStatus('Расписание очищено', 'success');
            }
        }
        
        function saveSchedule() {
            saveAllData();
            showStatus('Расписание сохранено', 'success');
        }
        
        function printSchedule() {
            // Создаем HTML для печати
            const printWindow = window.open('', '_blank');
            const printContent = `
                <html>
                <head>
                    <title>Расписание - ${currentData.main.studioName}</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 20px; }
                        h1 { color: #E67E22; text-align: center; }
                        .schedule-print { width: 100%; border-collapse: collapse; margin-top: 20px; }
                        .schedule-print th { background: #E67E22; color: white; padding: 10px; text-align: center; }
                        .schedule-print td { padding: 10px; border: 1px solid #ddd; text-align: center; }
                        .highlight { background: #FFF8F0; font-weight: bold; }
                        .day-header { background: #f5f5f5; font-weight: bold; padding: 15px; text-align: center; }
                        @media print {
                            body { padding: 10px; }
                            .no-print { display: none; }
                        }
                    </style>
                </head>
                <body>
                    <h1>Расписание занятий<br>${currentData.main.studioName}</h1>
                    <p style="text-align: center;">${currentData.main.address}<br>Тел: ${currentData.main.phone}</p>
                    <p style="text-align: center; color: #666;">Распечатано: ${new Date().toLocaleDateString('ru-RU')}</p>
                    
                    ${generateSchedulePrintTable()}
                    
                    <div style="margin-top: 30px; text-align: center; font-size: 12px; color: #888;" class="no-print">
                        <button onclick="window.print()">Распечатать</button>
                        <button onclick="window.close()">Закрыть</button>
                    </div>
                </body>
                </html>
            `;
            
            printWindow.document.write(printContent);
            printWindow.document.close();
        }
        
        function generateSchedulePrintTable() {
            // Группируем по дням
            const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
            const dayNames = {
                monday: 'Понедельник',
                tuesday: 'Вторник',
                wednesday: 'Среда',
                thursday: 'Четверг',
                friday: 'Пятница',
                saturday: 'Суббота',
                sunday: 'Воскресенье'
            };
            
            let html = '';
            
            days.forEach(day => {
                const daySchedule = currentData.schedule.filter(item => item.day === day);
                if (daySchedule.length === 0) return;
                
                // Сортируем по времени
                daySchedule.sort((a, b) => {
                    const timeA = a.time.replace(':', '');
                    const timeB = b.time.replace(':', '');
                    return timeA - timeB;
                });
                
                html += `
                    <div class="day-header">${dayNames[day]}</div>
                    <table class="schedule-print">
                        <thead>
                            <tr>
                                <th>Время</th>
                                <th>Направление</th>
                                <th>Возраст</th>
                                <th>Преподаватель</th>
                                <th>Зал</th>
                                <th>Длительность</th>
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                daySchedule.forEach(item => {
                    html += `
                        <tr ${item.isHighlighted ? 'class="highlight"' : ''}>
                            <td>${item.time}</td>
                            <td>${item.direction}</td>
                            <td>${item.age}</td>
                            <td>${item.instructor}</td>
                            <td>${item.room}</td>
                            <td>${item.duration} мин</td>
                        </tr>
                    `;
                });
                
                html += `
                        </tbody>
                    </table>
                    <br>
                `;
            });
            
            return html;
        }
        
        function exportSchedule() {
            // В реальном приложении здесь был бы экспорт в PDF
            // Для демонстрации просто показываем сообщение
            showStatus('Экспорт в PDF доступен в полной версии редактора', 'info');
        }
        
        // === СЕКЦИЯ: ЦЕНЫ ===
        function updatePricesSection() {
            const container = document.getElementById('pricesList');
            container.innerHTML = '';
            
            if (currentData.prices.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #666;">
                        <i class="fas fa-tags" style="font-size: 48px; margin-bottom: 20px; opacity: 0.3;"></i>
                        <h3>Нет тарифов</h3>
                        <p>Добавьте тарифные планы для вашей студии</p>
                    </div>
                `;
                return;
            }
            
            currentData.prices.forEach((price, index) => {
                const div = document.createElement('div');
                div.className = 'item';
                div.innerHTML = `
                    <div class="item-info">
                        <h4>
                            <i class="fas fa-tag"></i>
                            ${price.title || 'Новый тариф'}
                            ${price.featured ? ' <span style="color: var(--warning);">🔥 Популярный</span>' : ''}
                        </h4>
                        <p>${price.subtitle || ''}</p>
                        <p style="font-size: 24px; font-weight: bold; color: var(--primary); margin: 5px 0;">
                            ${price.price || '0₽'}
                            <span style="font-size: 14px; color: #666;">/ ${price.period || 'месяц'}</span>
                        </p>
                        <ul style="font-size: 12px; color: #666; margin-top: 10px; padding-left: 20px;">
                            ${(price.features || []).slice(0, 3).map(f => `<li>${f}</li>`).join('')}
                            ${(price.features || []).length > 3 ? '<li>...</li>' : ''}
                        </ul>
                    </div>
                    <div class="item-actions">
                        <button class="btn btn-primary btn-small" onclick="editPrice(${index})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-danger btn-small" onclick="removePrice(${index})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                container.appendChild(div);
            });
        }
        
        function showPriceModal(index = -1) {
            editingItem = { type: 'price', index: index };
            let price = index >= 0 ? currentData.prices[index] : null;
            
            const title = index >= 0 ? '<i class="fas fa-edit"></i> Редактировать тариф' : '<i class="fas fa-plus"></i> Добавить тариф';
            
            const content = `
                <div class="form-group">
                    <label>Название тарифа *</label>
                    <input type="text" id="modalPriceTitle" value="${price ? price.title : ''}" placeholder="ПРОБНОЕ ЗАНЯТИЕ" class="modal-input">
                </div>
                <div class="form-group">
                    <label>Подзаголовок</label>
                    <input type="text" id="modalPriceSubtitle" value="${price ? price.subtitle : ''}" placeholder="Любое направление" class="modal-input">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Цена *</label>
                        <input type="text" id="modalPricePrice" value="${price ? price.price : ''}" placeholder="300₽" class="modal-input">
                    </div>
                    <div class="form-group">
                        <label>Период</label>
                        <input type="text" id="modalPricePeriod" value="${price ? price.period : ''}" placeholder="1 занятие" class="modal-input">
                    </div>
                </div>
                <div class="form-group">
                    <label>Преимущества (каждое с новой строки)</label>
                    <textarea id="modalPriceFeatures" placeholder="Первое занятие
Консультация педагога
Подбор направления
Подарок при покупке абонемента" rows="4" class="modal-input">${price && price.features ? price.features.join('\n') : ''}</textarea>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="modalPriceFeatured" ${price && price.featured ? 'checked' : ''}>
                        Сделать рекомендуемым тарифом
                    </label>
                </div>
                
                <div class="price-preview" id="pricePreview">
                    <h4>Предпросмотр:</h4>
                    <div style="text-align: center; padding: 15px; background: linear-gradient(135deg, #f9f9f9, #fff); border-radius: 10px; margin-top: 10px;">
                        <div style="font-size: 20px; font-weight: bold;" id="previewTitle">${price ? price.title : 'ТАРИФ'}</div>
                        <div style="color: #666; font-size: 14px;" id="previewSubtitle">${price ? price.subtitle : 'Описание'}</div>
                        <div style="font-size: 32px; font-weight: bold; color: var(--primary); margin: 10px 0;" id="previewPrice">${price ? price.price : '0₽'}</div>
                        <div style="color: #888; font-size: 14px;" id="previewPeriod">${price ? price.period : 'период'}</div>
                    </div>
                </div>
            `;
            
            const footer = `
                <button class="btn btn-success" onclick="savePrice()">
                    <i class="fas fa-save"></i> ${index >= 0 ? 'Сохранить' : 'Добавить'}
                </button>
                ${index >= 0 ? `
                <button class="btn btn-danger" onclick="removePrice(${index}); closeModal();">
                    <i class="fas fa-trash"></i> Удалить
                </button>
                ` : ''}
                <button class="btn" onclick="closeModal()">
                    <i class="fas fa-times"></i> Отмена
                </button>
            `;
            
            showModal(title, content, footer);
            
            // Добавляем обновление превью при вводе
            ['modalPriceTitle', 'modalPriceSubtitle', 'modalPricePrice', 'modalPricePeriod'].forEach(id => {
                document.getElementById(id)?.addEventListener('input', updatePricePreview);
            });
        }
        
        function updatePricePreview() {
            const title = document.getElementById('modalPriceTitle')?.value || 'ТАРИФ';
            const subtitle = document.getElementById('modalPriceSubtitle')?.value || 'Описание';
            const price = document.getElementById('modalPricePrice')?.value || '0₽';
            const period = document.getElementById('modalPricePeriod')?.value || 'период';
            
            const preview = document.getElementById('pricePreview');
            if (preview) {
                preview.innerHTML = `
                    <h4>Предпросмотр:</h4>
                    <div style="text-align: center; padding: 15px; background: linear-gradient(135deg, #f9f9f9, #fff); border-radius: 10px; margin-top: 10px;">
                        <div style="font-size: 20px; font-weight: bold;">${title}</div>
                        <div style="color: #666; font-size: 14px;">${subtitle}</div>
                        <div style="font-size: 32px; font-weight: bold; color: var(--primary); margin: 10px 0;">${price}</div>
                        <div style="color: #888; font-size: 14px;">${period}</div>
                    </div>
                `;
            }
        }
        
        function editPrice(index) {
            showPriceModal(index);
        }
        
        function savePrice() {
            const title = document.getElementById('modalPriceTitle').value.trim();
            const price = document.getElementById('modalPricePrice').value.trim();
            
            if (!title || !price) {
                showStatus('Заполните обязательные поля', 'error');
                return;
            }
            
            const featuresText = document.getElementById('modalPriceFeatures').value;
            const features = featuresText.split('\n').map(f => f.trim()).filter(f => f);
            
            const priceData = {
                title: title,
                subtitle: document.getElementById('modalPriceSubtitle').value,
                price: price,
                period: document.getElementById('modalPricePeriod').value,
                features: features,
                featured: document.getElementById('modalPriceFeatured').checked
            };
            
            if (editingItem.index >= 0) {
                currentData.prices[editingItem.index] = priceData;
            } else {
                currentData.prices.push(priceData);
            }
            
            updatePricesSection();
            updateCounters();
            closeModal();
            showStatus('Тариф сохранен', 'success');
        }
        
        function removePrice(index) {
            if (confirm('Удалить этот тариф?')) {
                currentData.prices.splice(index, 1);
                updatePricesSection();
                updateCounters();
                showStatus('Тариф удалён', 'success');
            }
        }
        
        function sortPricesByPrice() {
            currentData.prices.sort((a, b) => {
                const priceA = parseInt(a.price.replace(/[^\d]/g, '')) || 0;
                const priceB = parseInt(b.price.replace(/[^\d]/g, '')) || 0;
                return priceA - priceB;
            });
            
            updatePricesSection();
            showStatus('Тарифы отсортированы по цене', 'success');
        }
        
        function savePrices() {
            saveAllData();
            showStatus('Цены сохранены', 'success');
        }
        
        // === СЕКЦИЯ: КОМАНДА ===
        function updateTeamSection() {
            const container = document.getElementById('teamList');
            container.innerHTML = '';
            
            if (currentData.team.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #666;">
                        <i class="fas fa-users" style="font-size: 48px; margin-bottom: 20px; opacity: 0.3;"></i>
                        <h3>Нет участников</h3>
                        <p>Добавьте преподавателей вашей студии</p>
                    </div>
                `;
                return;
            }
            
            currentData.team.forEach((member, index) => {
                const div = document.createElement('div');
                div.className = 'item';
                div.innerHTML = `
                    <div class="item-info">
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <div style="width: 60px; height: 60px; background: linear-gradient(135deg, var(--primary), var(--secondary)); 
                                        border-radius: 50%; display: flex; align-items: center; justify-content: center; 
                                        color: white; font-weight: bold; font-size: 20px;">
                                ${member.initials || '??'}
                            </div>
                            <div>
                                <h4>${member.name || 'Новый преподаватель'}</h4>
                                <p>
                                    <span style="color: var(--primary); font-weight: 600;">${member.role || ''}</span>
                                    <span style="margin-left: 10px; font-size: 12px; color: #666;">
                                        <i class="fas fa-history"></i> Опыт: ${member.experience || 'Не указан'}
                                    </span>
                                </p>
                                <p style="font-size: 12px; color: #888; margin-top: 5px;">
                                    ${member.description || ''}
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="item-actions">
                        <button class="btn btn-primary btn-small" onclick="editTeamMember(${index})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-danger btn-small" onclick="removeTeamMember(${index})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                container.appendChild(div);
            });
        }
        
        function showTeamModal(index = -1) {
            editingItem = { type: 'team', index: index };
            let member = index >= 0 ? currentData.team[index] : null;
            
            const title = index >= 0 ? '<i class="fas fa-edit"></i> Редактировать преподавателя' : '<i class="fas fa-plus"></i> Добавить преподавателя';
            
            const initials = member ? member.initials : 'НП';
            const avatarColor = member ? getAvatarColor(member.name) : 'linear-gradient(135deg, var(--primary), var(--secondary))';
            
            const content = `
                <div style="text-align: center; margin-bottom: 20px;">
                    <div class="teacher-avatar" style="background: ${avatarColor};">
                        ${initials}
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Имя и фамилия *</label>
                        <input type="text" id="modalTeamName" value="${member ? member.name : ''}" placeholder="Анна Петрова" class="modal-input" oninput="updateTeamAvatar()">
                    </div>
                    <div class="form-group">
                        <label>Должность *</label>
                        <input type="text" id="modalTeamRole" value="${member ? member.role : ''}" placeholder="Главный хореограф" class="modal-input">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Опыт работы</label>
                        <input type="text" id="modalTeamExperience" value="${member ? member.experience : ''}" placeholder="14 лет" class="modal-input">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Описание</label>
                    <textarea id="modalTeamDescription" placeholder="Профессиональный хореограф с международным опытом. Ученики - победители всероссийских конкурсов." rows="4" class="modal-input">${member ? member.description : ''}</textarea>
                </div>
                
                <div class="form-group">
                    <label>Дополнительная информация (каждое с новой строки)</label>
                    <textarea id="modalTeamAdditional" placeholder="Образование: Московская академия хореографии
Специализация: Contemporary dance
Достижения: Призер международных конкурсов" rows="4" class="modal-input">${member && member.additional ? member.additional.join('\n') : ''}</textarea>
                </div>
            `;
            
            const footer = `
                <button class="btn btn-success" onclick="saveTeamMember()">
                    <i class="fas fa-save"></i> ${index >= 0 ? 'Сохранить' : 'Добавить'}
                </button>
                ${index >= 0 ? `
                <button class="btn btn-danger" onclick="removeTeamMember(${index}); closeModal();">
                    <i class="fas fa-trash"></i> Удалить
                </button>
                ` : ''}
                <button class="btn" onclick="closeModal()">
                    <i class="fas fa-times"></i> Отмена
                </button>
            `;
            
            showModal(title, content, footer);
        }
        
        function getAvatarColor(name) {
            const colors = [
                'linear-gradient(135deg, var(--primary), var(--secondary))',
                'linear-gradient(135deg, var(--info), #3498DB)',
                'linear-gradient(135deg, var(--success), #2ECC71)',
                'linear-gradient(135deg, var(--purple), #8E44AD)',
                'linear-gradient(135deg, var(--warning), #F39C12)'
            ];
            
            if (!name) return colors[0];
            const hash = name.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
            return colors[hash % colors.length];
        }
        
        function updateTeamAvatar() {
            const name = document.getElementById('modalTeamName').value;
            if (!name) return;
            
            const nameParts = name.split(' ');
            const initials = (nameParts[0][0] + (nameParts[1] ? nameParts[1][0] : nameParts[0][1] || '')).toUpperCase();
            
            const avatar = document.querySelector('.teacher-avatar');
            if (avatar) {
                avatar.textContent = initials;
                avatar.style.background = getAvatarColor(name);
            }
        }
        
        function editTeamMember(index) {
            showTeamModal(index);
        }
        
        function saveTeamMember() {
            const name = document.getElementById('modalTeamName').value.trim();
            const role = document.getElementById('modalTeamRole').value.trim();
            
            if (!name || !role) {
                showStatus('Заполните обязательные поля', 'error');
                return;
            }
            
            const additionalText = document.getElementById('modalTeamAdditional').value;
            const additional = additionalText.split('\n').map(f => f.trim()).filter(f => f);
            
            // Генерируем инициалы
            const nameParts = name.split(' ');
            const initials = (nameParts[0][0] + (nameParts[1] ? nameParts[1][0] : nameParts[0][1] || '')).toUpperCase();
            
            const memberData = {
                initials: initials,
                name: name,
                role: role,
                experience: document.getElementById('modalTeamExperience').value,
                description: document.getElementById('modalTeamDescription').value,
                additional: additional
            };
            
            if (editingItem.index >= 0) {
                currentData.team[editingItem.index] = memberData;
            } else {
                currentData.team.push(memberData);
            }
            
            updateTeamSection();
            updateCounters();
            closeModal();
            showStatus('Преподаватель сохранен', 'success');
        }
        
        function removeTeamMember(index) {
            if (confirm('Удалить этого участника команды?')) {
                currentData.team.splice(index, 1);
                updateTeamSection();
                updateCounters();
                showStatus('Участник команды удалён', 'success');
            }
        }
        
        function saveTeam() {
            saveAllData();
            showStatus('Команда сохранена', 'success');
        }
        
        // === СЕКЦИЯ: ФОТОГАЛЕРЕЯ ===
        function updateGallerySection() {
            updateGalleryView();
            updateGalleryCategories();
        }
        
        function updateGalleryView() {
            const container = document.getElementById('galleryContainer');
            const empty = document.getElementById('emptyGallery');
            
            if (currentData.gallery.length === 0) {
                container.innerHTML = '';
                empty.style.display = 'block';
                return;
            }
            
            empty.style.display = 'none';
            
            let html = '';
            currentData.gallery.forEach((photo, index) => {
                html += `
                    <div class="photo-item">
                        <div class="photo-preview">
                            <img src="${photo.image || 'https://via.placeholder.com/300x200?text=Нет+фото'}" 
                                 alt="${photo.title || 'Фото'}"
                                 onerror="this.src='data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"300\" height=\"200\" viewBox=\"0 0 300 200\"><rect width=\"300\" height=\"200\" fill=\"%23f0f0f0\"/><text x=\"150\" y=\"100\" text-anchor=\"middle\" dy=\".3em\" fill=\"%23999\">Нет изображения</text></svg>'">
                        </div>
                        <div class="photo-info">
                            <div class="photo-title">${photo.title || 'Без названия'}</div>
                            <div class="photo-description">${photo.description || ''}</div>
                            <div class="photo-meta">
                                <span>${photo.date || ''}</span>
                                <span class="photo-category">${getCategoryName(photo.category)}</span>
                            </div>
                            <div class="photo-actions">
                                <button class="btn btn-small btn-primary" onclick="editPhoto(${index})">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-small btn-danger" onclick="removePhoto(${index})">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        function updateGalleryCategories() {
            const container = document.getElementById('galleryCategories');
            
            // Получаем уникальные категории
            const categories = ['all', ...new Set(currentData.gallery.map(p => p.category).filter(Boolean))];
            
            let html = '';
            categories.forEach(category => {
                const name = getCategoryName(category);
                const count = category === 'all' 
                    ? currentData.gallery.length 
                    : currentData.gallery.filter(p => p.category === category).length;
                
                html += `
                    <div class="category-tag ${category === currentPhotoCategory ? 'active' : ''}" 
                         onclick="filterByCategory('${category}')">
                        ${name} (${count})
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        function getCategoryName(category) {
            const names = {
                'all': 'Все',
                'studio': 'Зал студии',
                'kids': 'Детские занятия',
                'adults': 'Взрослые группы',
                'performances': 'Выступления',
                'stretching': 'Растяжка',
                'hiphop': 'Хип-хоп',
                'other': 'Другое'
            };
            
            return names[category] || category;
        }
        
        function filterByCategory(category) {
            currentPhotoCategory = category;
            updateGalleryView();
            updateGalleryCategories();
        }
        
        function showUploadPhotoModal(index = -1) {
            editingItem = { type: 'photo', index: index };
            let photo = index >= 0 ? currentData.gallery[index] : null;
            
            const title = index >= 0 ? '<i class="fas fa-edit"></i> Редактировать фото' : '<i class="fas fa-plus"></i> Добавить фото';
            
            const categories = ['studio', 'kids', 'adults', 'performances', 'stretching', 'hiphop', 'other'];
            let categoryOptions = '';
            categories.forEach(cat => {
                const selected = (photo && photo.category === cat) || (!photo && cat === 'studio') ? 'selected' : '';
                categoryOptions += `<option value="${cat}" ${selected}>${getCategoryName(cat)}</option>`;
            });
            
            const content = `
                <div class="upload-area" id="modalPhotoDropArea" onclick="document.getElementById('modalPhotoFileInput').click()">
                    <div class="upload-icon">
                        <i class="fas fa-cloud-upload-alt"></i>
                    </div>
                    <div class="upload-text">
                        <h3>Перетащите фото сюда</h3>
                        <p>или нажмите, чтобы выбрать файлы</p>
                    </div>
                    <div class="upload-hint" style="font-size: 12px; color: #999; margin-top: 10px;">
                        Поддерживаются JPG, PNG, GIF, WEBP (максимум 5 МБ)
                    </div>
                    <input type="file" id="modalPhotoFileInput" accept="image/*" style="display: none;" onchange="handlePhotoFileSelect(event)">
                </div>
                
                <div class="form-group" style="margin-top: 20px;">
                    <label>Или введите URL изображения</label>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="modalPhotoUrl" value="${photo ? photo.image : ''}" placeholder="https://example.com/photo.jpg" class="modal-input" style="flex: 1;">
                        <button class="btn btn-primary" onclick="loadPhotoFromUrl()">
                            <i class="fas fa-link"></i>
                        </button>
                    </div>
                </div>
                
                <div id="modalPhotoPreview" class="preview-container" style="${photo ? '' : 'display: none;'}">
                    <img id="modalPreviewImage" src="${photo ? photo.image : ''}" alt="Предпросмотр" class="preview-image">
                </div>
                
                <div class="form-group">
                    <label>Название фото *</label>
                    <input type="text" id="modalPhotoTitle" value="${photo ? photo.title : ''}" placeholder="Например: Занятие contemporary" class="modal-input">
                </div>
                
                <div class="form-group">
                    <label>Описание</label>
                    <textarea id="modalPhotoDescription" placeholder="Краткое описание фотографии..." rows="3" class="modal-input">${photo ? photo.description : ''}</textarea>
                </div>
                
                <div class="form-group">
                    <label>Категория</label>
                    <select id="modalPhotoCategory" class="modal-input">
                        ${categoryOptions}
                    </select>
                </div>
            `;
            
            const footer = `
                <button class="btn btn-success" onclick="savePhoto()">
                    <i class="fas fa-save"></i> ${index >= 0 ? 'Сохранить' : 'Добавить'}
                </button>
                ${index >= 0 ? `
                <button class="btn btn-danger" onclick="removePhoto(${index}); closeModal();">
                    <i class="fas fa-trash"></i> Удалить
                </button>
                ` : ''}
                <button class="btn" onclick="closeModal()">
                    <i class="fas fa-times"></i> Отмена
                </button>
            `;
            
            showModal(title, content, footer);
            
            // Настраиваем перетаскивание
            setupPhotoDragAndDrop();
        }
        
        function setupPhotoDragAndDrop() {
            const dropArea = document.getElementById('modalPhotoDropArea');
            const fileInput = document.getElementById('modalPhotoFileInput');
            
            if (dropArea && fileInput) {
                dropArea.addEventListener('click', () => fileInput.click());
                
                ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                    dropArea.addEventListener(eventName, preventDefaults, false);
                });
                
                function preventDefaults(e) {
                    e.preventDefault();
                    e.stopPropagation();
                }
                
                ['dragenter', 'dragover'].forEach(eventName => {
                    dropArea.addEventListener(eventName, () => {
                        dropArea.classList.add('drag-over');
                    }, false);
                });
                
                ['dragleave', 'drop'].forEach(eventName => {
                    dropArea.addEventListener(eventName, () => {
                        dropArea.classList.remove('drag-over');
                    }, false);
                });
                
                dropArea.addEventListener('drop', handleDrop, false);
                
                function handleDrop(e) {
                    const dt = e.dataTransfer;
                    const files = dt.files;
                    
                    if (files.length > 0) {
                        handlePhotoFileSelect({ target: { files: files } });
                    }
                }
            }
        }
        
        function handlePhotoFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('modalPreviewImage').src = e.target.result;
                    document.getElementById('modalPhotoPreview').style.display = 'block';
                    
                    // Предлагаем название из имени файла
                    const nameWithoutExt = file.name.replace(/\.[^/.]+$/, "");
                    if (!document.getElementById('modalPhotoTitle').value) {
                        document.getElementById('modalPhotoTitle').value = nameWithoutExt.replace(/[-_]/g, ' ');
                    }
                };
                reader.readAsDataURL(file);
            }
        }
        
        function loadPhotoFromUrl() {
            const url = document.getElementById('modalPhotoUrl').value.trim();
            if (!url) {
                showStatus('Введите URL изображения', 'error');
                return;
            }
            
            if (!url.startsWith('http')) {
                showStatus('Некорректный URL', 'error');
                return;
            }
            
            document.getElementById('modalPreviewImage').src = url;
            document.getElementById('modalPhotoPreview').style.display = 'block';
            
            // Предлагаем название из URL
            const filename = url.split('/').pop().split('?')[0];
            const nameWithoutExt = filename.replace(/\.[^/.]+$/, "");
            if (nameWithoutExt && !document.getElementById('modalPhotoTitle').value) {
                document.getElementById('modalPhotoTitle').value = nameWithoutExt.replace(/[-_]/g, ' ');
            }
        }
        
        function editPhoto(index) {
            showUploadPhotoModal(index);
        }
        
        function savePhoto() {
            const title = document.getElementById('modalPhotoTitle').value.trim();
            const url = document.getElementById('modalPhotoUrl').value.trim();
            const imageSrc = document.getElementById('modalPreviewImage').src;
            
            if (!title) {
                showStatus('Введите название фото', 'error');
                return;
            }
            
            if (!url && imageSrc.includes('data:image')) {
                // Используем base64 из загруженного файла
            } else if (!url) {
                showStatus('Загрузите фото или введите URL', 'error');
                return;
            }
            
            const photoData = {
                id: editingItem.index >= 0 ? currentData.gallery[editingItem.index].id : Date.now(),
                title: title,
                description: document.getElementById('modalPhotoDescription').value,
                image: url || imageSrc,
                category: document.getElementById('modalPhotoCategory').value,
                date: editingItem.index >= 0 ? currentData.gallery[editingItem.index].date : new Date().toLocaleDateString('ru-RU')
            };
            
            if (editingItem.index >= 0) {
                currentData.gallery[editingItem.index] = photoData;
            } else {
                currentData.gallery.push(photoData);
            }
            
            updateGallerySection();
            updateCounters();
            closeModal();
            showStatus('Фото сохранено', 'success');
        }
        
        function removePhoto(index) {
            if (confirm('Удалить эту фотографию?')) {
                currentData.gallery.splice(index, 1);
                updateGallerySection();
                updateCounters();
                showStatus('Фотография удалена', 'success');
            }
        }
        
        function importDemoPhotos() {
            const demoPhotos = [
                {
                    id: Date.now() + 1,
                    title: "Contemporary для взрослых",
                    description: "Современный танец для снятия стресса",
                    image: "https://images.unsplash.com/photo-1547153760-18fc86324498?auto=format&fit=crop&w=600&q=80",
                    category: "adults",
                    date: new Date().toLocaleDateString('ru-RU')
                },
                {
                    id: Date.now() + 2,
                    title: "Хип-хоп группа",
                    description: "Энергичные занятия по уличным стилям",
                    image: "https://images.unsplash.com/photo-1536922246289-88c42f957773?auto=format&fit=crop&w=600&q=80",
                    category: "hiphop",
                    date: new Date().toLocaleDateString('ru-RU')
                }
            ];
            
            currentData.gallery = [...currentData.gallery, ...demoPhotos];
            updateGallerySection();
            updateCounters();
            showStatus('Демо-фото добавлены', 'success');
        }
        
        function clearGallery() {
            if (currentData.gallery.length === 0) {
                showStatus('Галерея уже пуста', 'warning');
                return;
            }
            
            if (confirm('Очистить всю галерею? Это действие нельзя отменить.')) {
                currentData.gallery = [];
                updateGallerySection();
                updateCounters();
                showStatus('Галерея очищена', 'success');
            }
        }
        
        function saveGallery() {
            saveAllData();
            showStatus('Галерея сохранена', 'success');
        }
        
        // === СЕКЦИЯ: ОТЗЫВЫ ===
        function updateReviewsSection() {
            const container = document.getElementById('reviewsList');
            container.innerHTML = '';
            
            if (currentData.reviews.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #666;">
                        <i class="fas fa-comments" style="font-size: 48px; margin-bottom: 20px; opacity: 0.3;"></i>
                        <h3>Нет отзывов</h3>
                        <p>Добавьте отзывы ваших клиентов</p>
                    </div>
                `;
                return;
            }
            
            currentData.reviews.forEach((review, index) => {
                const stars = '★'.repeat(review.rating || 5);
                const div = document.createElement('div');
                div.className = 'item';
                div.innerHTML = `
                    <div class="item-info">
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <div style="width: 50px; height: 50px; background: linear-gradient(135deg, var(--info), #3498DB); 
                                        border-radius: 50%; display: flex; align-items: center; justify-content: center; 
                                        color: white; font-weight: bold; font-size: 18px;">
                                ${review.initials || '??'}
                            </div>
                            <div>
                                <h4>${review.author || 'Аноним'} 
                                    <span style="color: var(--warning); font-size: 14px;">${stars}</span>
                                </h4>
                                <p style="color: #666; font-size: 13px;">${review.role || ''}</p>
                                <p style="font-size: 12px; color: #888; margin-top: 5px; font-style: italic;">
                                    ${review.text || ''}
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="item-actions">
                        <button class="btn btn-primary btn-small" onclick="editReview(${index})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-danger btn-small" onclick="removeReview(${index})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                container.appendChild(div);
            });
        }
        
        function showReviewModal(index = -1) {
            editingItem = { type: 'review', index: index };
            let review = index >= 0 ? currentData.reviews[index] : null;
            
            const title = index >= 0 ? '<i class="fas fa-edit"></i> Редактировать отзыв' : '<i class="fas fa-plus"></i> Добавить отзыв';
            
            const rating = review ? review.rating : 5;
            currentRating = rating;
            
            let starsHtml = '';
            for (let i = 1; i <= 5; i++) {
                starsHtml += `<span class="star ${i <= rating ? 'active' : ''}" onclick="setRating(${i})">★</span>`;
            }
            
            const content = `
                <div style="text-align: center; margin-bottom: 20px;">
                    <div class="teacher-avatar" style="background: linear-gradient(135deg, var(--info), #3498DB);" id="reviewAvatar">
                        ${review ? review.initials : '??'}
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Имя автора *</label>
                        <input type="text" id="modalReviewAuthor" value="${review ? review.author : ''}" placeholder="Анна К." class="modal-input" oninput="updateReviewAvatar()">
                    </div>
                    <div class="form-group">
                        <label>Роль</label>
                        <input type="text" id="modalReviewRole" value="${review ? review.role : ''}" placeholder="Мама Софии (6 лет)" class="modal-input">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Оценка</label>
                    <div class="rating-stars" style="justify-content: center;">
                        ${starsHtml}
                    </div>
                    <div style="text-align: center; margin-top: 5px; color: #666; font-size: 14px;" id="ratingText">
                        ${rating} из 5 звезд
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Текст отзыва *</label>
                    <textarea id="modalReviewText" placeholder='"Дочь ходит второй год, вижу огромный прогреск! Преподаватели очень внимательные..."' rows="4" class="modal-input">${review ? review.text : ''}</textarea>
                </div>
            `;
            
            const footer = `
                <button class="btn btn-success" onclick="saveReview()">
                    <i class="fas fa-save"></i> ${index >= 0 ? 'Сохранить' : 'Добавить'}
                </button>
                ${index >= 0 ? `
                <button class="btn btn-danger" onclick="removeReview(${index}); closeModal();">
                    <i class="fas fa-trash"></i> Удалить
                </button>
                ` : ''}
                <button class="btn" onclick="closeModal()">
                    <i class="fas fa-times"></i> Отмена
                </button>
            `;
            
            showModal(title, content, footer);
        }
        
        function setRating(rating) {
            currentRating = rating;
            
            // Обновляем звезды
            document.querySelectorAll('.star').forEach((star, index) => {
                if (index < rating) {
                    star.classList.add('active');
                } else {
                    star.classList.remove('active');
                }
            });
            
            // Обновляем текст
            document.getElementById('ratingText').textContent = `${rating} из 5 звезд`;
        }
        
        function updateReviewAvatar() {
            const author = document.getElementById('modalReviewAuthor').value;
            if (!author) return;
            
            const nameParts = author.split(' ');
            const initials = (nameParts[0][0] + (nameParts[1] ? nameParts[1][0] : nameParts[0][1] || '')).toUpperCase();
            
            const avatar = document.getElementById('reviewAvatar');
            if (avatar) {
                avatar.textContent = initials;
            }
        }
        
        function editReview(index) {
            showReviewModal(index);
        }
        
        function saveReview() {
            const author = document.getElementById('modalReviewAuthor').value.trim();
            const text = document.getElementById('modalReviewText').value.trim();
            
            if (!author || !text) {
                showStatus('Заполните обязательные поля', 'error');
                return;
            }
            
            // Генерируем инициалы
            const nameParts = author.split(' ');
            const initials = (nameParts[0][0] + (nameParts[1] ? nameParts[1][0] : nameParts[0][1] || '')).toUpperCase();
            
            const reviewData = {
                rating: currentRating,
                text: text,
                author: author,
                role: document.getElementById('modalReviewRole').value,
                initials: initials
            };
            
            if (editingItem.index >= 0) {
                currentData.reviews[editingItem.index] = reviewData;
            } else {
                currentData.reviews.push(reviewData);
            }
            
            updateReviewsSection();
            updateCounters();
            closeModal();
            showStatus('Отзыв сохранен', 'success');
        }
        
        function removeReview(index) {
            if (confirm('Удалить этот отзыв?')) {
                currentData.reviews.splice(index, 1);
                updateReviewsSection();
                updateCounters();
                showStatus('Отзыв удалён', 'success');
            }
        }
        
        function generateTestimonials() {
            const testimonials = [
                {
                    rating: 5,
                    text: '"Прекрасная студия! Ребенок ходит с удовольствием, педагоги внимательные и профессиональные."',
                    author: "Ольга М.",
                    role: "Мама Даниила (5 лет)"
                },
                {
                    rating: 5,
                    text: '"Начала заниматься в 45 лет, никогда не думала что смогу так двигаться! Спасибо преподавателям за терпение."',
                    author: "Светлана П.",
                    role: "Ученица 45+"
                }
            ];
            
            testimonials.forEach(testimonial => {
                const nameParts = testimonial.author.split(' ');
                testimonial.initials = (nameParts[0][0] + (nameParts[1] ? nameParts[1][0] : '')).toUpperCase();
                currentData.reviews.push(testimonial);
            });
            
            updateReviewsSection();
            updateCounters();
            showStatus('Тестовые отзывы добавлены', 'success');
        }
        
        function saveReviews() {
            saveAllData();
            showStatus('Отзывы сохранены', 'success');
        }
        
        // === СЕКЦИЯ: НОВОСТИ ===
        function updateNewsSection() {
            const container = document.getElementById('newsList');
            container.innerHTML = '';
            
            if (currentData.news.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #666;">
                        <i class="fas fa-newspaper" style="font-size: 48px; margin-bottom: 20px; opacity: 0.3;"></i>
                        <h3>Нет новостей</h3>
                        <p>Добавьте новости вашей студии</p>
                    </div>
                `;
                return;
            }
            
            currentData.news.forEach((news, index) => {
                const div = document.createElement('div');
                div.className = 'item';
                div.innerHTML = `
                    <div class="item-info">
                        <h4><i class="fas fa-bullhorn"></i> ${news.title || 'Новая новость'}</h4>
                        <p style="color: #666; font-size: 13px;">
                            <i class="fas fa-calendar"></i> ${news.date || ''}
                        </p>
                        <p style="font-size: 12px; color: #888; margin-top: 5px;">
                            ${news.shortText || news.description || ''}
                        </p>
                    </div>
                    <div class="item-actions">
                        <button class="btn btn-primary btn-small" onclick="editNews(${index})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-danger btn-small" onclick="removeNews(${index})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                container.appendChild(div);
            });
        }
        
        function showNewsModal(index = -1) {
            editingItem = { type: 'news', index: index };
            let news = index >= 0 ? currentData.news[index] : null;
            
            const title = index >= 0 ? '<i class="fas fa-edit"></i> Редактировать новость' : '<i class="fas fa-plus"></i> Добавить новость';
            
            const content = `
                <div class="form-group">
                    <label>Заголовок новости *</label>
                    <input type="text" id="modalNewsTitle" value="${news ? news.title : ''}" placeholder="Новый набор на детские группы!" class="modal-input">
                </div>
                
                <div class="form-group">
                    <label>Дата</label>
                    <input type="text" id="modalNewsDate" value="${news ? news.date : new Date().toLocaleDateString('ru-RU')}" placeholder="15.12.2024" class="modal-input">
                </div>
                
                <div class="form-group">
                    <label>URL изображения</label>
                    <input type="text" id="modalNewsImage" value="${news ? news.image : ''}" placeholder="https://example.com/photo.jpg" class="modal-input">
                </div>
                
                <div class="form-group">
                    <label>Краткий текст (для карточки)</label>
                    <textarea id="modalNewsShortText" placeholder="Открыт набор в детские группы 3-6 лет" rows="2" class="modal-input">${news ? news.shortText : ''}</textarea>
                </div>
                
                <div class="form-group">
                    <label>Полное описание *</label>
                    <textarea id="modalNewsDescription" placeholder="Открыт набор в группы для детей 3-6 лет. Танцы-игра, первые па, развитие координации." rows="4" class="modal-input">${news ? news.description : ''}</textarea>
                </div>
                
                <div class="form-group">
                    <label>Ссылка</label>
                    <input type="text" id="modalNewsLink" value="${news ? news.link : ''}" placeholder="#directions" class="modal-input">
                </div>
            `;
            
            const footer = `
                <button class="btn btn-success" onclick="saveNewsItem()">
                    <i class="fas fa-save"></i> ${index >= 0 ? 'Сохранить' : 'Добавить'}
                </button>
                ${index >= 0 ? `
                <button class="btn btn-danger" onclick="removeNews(${index}); closeModal();">
                    <i class="fas fa-trash"></i> Удалить
                </button>
                ` : ''}
                <button class="btn" onclick="closeModal()">
                    <i class="fas fa-times"></i> Отмена
                </button>
            `;
            
            showModal(title, content, footer);
        }
        
        function editNews(index) {
            showNewsModal(index);
        }
        
        function saveNewsItem() {
            const title = document.getElementById('modalNewsTitle').value.trim();
            const description = document.getElementById('modalNewsDescription').value.trim();
            
            if (!title || !description) {
                showStatus('Заполните обязательные поля', 'error');
                return;
            }
            
            const newsData = {
                id: editingItem.index >= 0 ? currentData.news[editingItem.index].id : Date.now(),
                title: title,
                date: document.getElementById('modalNewsDate').value,
                image: document.getElementById('modalNewsImage').value,
                shortText: document.getElementById('modalNewsShortText').value,
                description: description,
                link: document.getElementById('modalNewsLink').value
            };
            
            if (editingItem.index >= 0) {
                currentData.news[editingItem.index] = newsData;
            } else {
                currentData.news.push(newsData);
            }
            
            updateNewsSection();
            updateCounters();
            closeModal();
            showStatus('Новость сохранена', 'success');
        }
        
        function removeNews(index) {
            if (confirm('Удалить эту новость?')) {
                currentData.news.splice(index, 1);
                updateNewsSection();
                updateCounters();
                showStatus('Новость удалена', 'success');
            }
        }
        
        function saveNews() {
            saveAllData();
            showStatus('Новости сохранены', 'success');
        }
        
        // === СЕКЦИЯ: FAQ ===
        function updateFAQSection() {
            const container = document.getElementById('faqList');
            container.innerHTML = '';
            
            if (currentData.faq.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #666;">
                        <i class="fas fa-question-circle" style="font-size: 48px; margin-bottom: 20px; opacity: 0.3;"></i>
                        <h3>Нет вопросов</h3>
                        <p>Добавьте часто задаваемые вопросы</p>
                    </div>
                `;
                return;
            }
            
            currentData.faq.forEach((faq, index) => {
                const div = document.createElement('div');
                div.className = 'item';
                div.innerHTML = `
                    <div class="item-info">
                        <h4><i class="fas fa-question"></i> ${faq.question || 'Новый вопрос?'}</h4>
                        <p style="font-size: 12px; color: #888; margin-top: 5px;">
                            <i class="fas fa-reply"></i> ${faq.answer || ''}
                        </p>
                    </div>
                    <div class="item-actions">
                        <button class="btn btn-primary btn-small" onclick="editFAQ(${index})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-danger btn-small" onclick="removeFAQ(${index})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                container.appendChild(div);
            });
        }
        
        function showFAQModal(index = -1) {
            editingItem = { type: 'faq', index: index };
            let faq = index >= 0 ? currentData.faq[index] : null;
            
            const title = index >= 0 ? '<i class="fas fa-edit"></i> Редактировать вопрос' : '<i class="fas fa-plus"></i> Добавить вопрос';
            
            const content = `
                <div class="form-group">
                    <label>Вопрос *</label>
                    <input type="text" id="modalFAQQuestion" value="${faq ? faq.question : ''}" placeholder="С какого возраста можно начинать заниматься?" class="modal-input">
                </div>
                
                <div class="form-group">
                    <label>Ответ *</label>
                    <textarea id="modalFAQAnswer" placeholder="Мы принимаем детей с 3 лет на программу 'Танцы-игра'. Для каждого возраста разработаны специальные программы с учетом физического и психологического развития." rows="4" class="modal-input">${faq ? faq.answer : ''}</textarea>
                </div>
                
                <div class="form-group">
                    <label>Категория</label>
                    <input type="text" id="modalFAQCategory" value="${faq ? faq.category : ''}" placeholder="Общая информация" class="modal-input">
                </div>
            `;
            
            const footer = `
                <button class="btn btn-success" onclick="saveFAQItem()">
                    <i class="fas fa-save"></i> ${index >= 0 ? 'Сохранить' : 'Добавить'}
                </button>
                ${index >= 0 ? `
                <button class="btn btn-danger" onclick="removeFAQ(${index}); closeModal();">
                    <i class="fas fa-trash"></i> Удалить
                </button>
                ` : ''}
                <button class="btn" onclick="closeModal()">
                    <i class="fas fa-times"></i> Отмена
                </button>
            `;
            
            showModal(title, content, footer);
        }
        
        function editFAQ(index) {
            showFAQModal(index);
        }
        
        function saveFAQItem() {
            const question = document.getElementById('modalFAQQuestion').value.trim();
            const answer = document.getElementById('modalFAQAnswer').value.trim();
            
            if (!question || !answer) {
                showStatus('Заполните обязательные поля', 'error');
                return;
            }
            
            const faqData = {
                question: question,
                answer: answer,
                category: document.getElementById('modalFAQCategory').value
            };
            
            if (editingItem.index >= 0) {
                currentData.faq[editingItem.index] = faqData;
            } else {
                currentData.faq.push(faqData);
            }
            
            updateFAQSection();
            updateCounters();
            closeModal();
            showStatus('Вопрос сохранен', 'success');
        }
        
        function removeFAQ(index) {
            if (confirm('Удалить этот вопрос?')) {
                currentData.faq.splice(index, 1);
                updateFAQSection();
                updateCounters();
                showStatus('Вопрос удалён', 'success');
            }
        }
        
        function sortFAQ() {
            currentData.faq.sort((a, b) => a.question.localeCompare(b.question));
            updateFAQSection();
            showStatus('Вопросы отсортированы по алфавиту', 'success');
        }
        
        function saveFAQ() {
            saveAllData();
            showStatus('FAQ сохранён', 'success');
        }
        
        // === СЕКЦИЯ: НАСТРОЙКИ ===
        function updateStats() {
            const totalItems = Object.values(currentData).reduce((sum, section) => {
                if (Array.isArray(section)) return sum + section.length;
                return sum;
            }, 0);
            
            const dataSize = JSON.stringify(currentData).length;
            const dataSizeKB = (dataSize / 1024).toFixed(2);
            
            const lastSaveTime = localStorage.getItem('lastSaveTime');
            const lastSave = lastSaveTime ? new Date(lastSaveTime).toLocaleString('ru-RU') : 'Никогда';
            
            document.getElementById('totalStats').textContent = totalItems;
            document.getElementById('dataSize').textContent = dataSizeKB + ' КБ';
            document.getElementById('lastSave').textContent = lastSave;
        }
        
        function createBackup() {
            const backupData = {
                ...currentData,
                backupDate: new Date().toISOString(),
                version: '1.0'
            };
            
            const dataStr = JSON.stringify(backupData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const fileName = `studio-backup-${new Date().toISOString().slice(0,10)}.json`;
            
            const link = document.createElement('a');
            link.setAttribute('href', dataUri);
            link.setAttribute('download', fileName);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showStatus('Резервная копия создана', 'success');
        }
        
        function restoreBackup() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const backupData = JSON.parse(e.target.result);
                        
                        if (confirm('Восстановить данные из резервной копии? Текущие данные будут заменены.')) {
                            currentData = backupData;
                            updateAllSections();
                            showStatus('Данные восстановлены из резервной копии', 'success');
                        }
                    } catch (error) {
                        showStatus('Ошибка загрузки резервной копии: ' + error.message, 'error');
                    }
                };
                reader.readAsText(file);
            };
            
            input.click();
        }
        
        function exportSelectedData() {
            const exportData = {};
            
            if (document.getElementById('exportMain').checked) exportData.main = currentData.main;
            if (document.getElementById('exportDirections').checked) exportData.directions = currentData.directions;
            if (document.getElementById('exportSchedule').checked) exportData.schedule = currentData.schedule;
            if (document.getElementById('exportPrices').checked) exportData.prices = currentData.prices;
            if (document.getElementById('exportTeam').checked) exportData.team = currentData.team;
            if (document.getElementById('exportPhotos').checked) exportData.gallery = currentData.gallery;
            if (document.getElementById('exportReviews').checked) exportData.reviews = currentData.reviews;
            if (document.getElementById('exportNews').checked) exportData.news = currentData.news;
            if (document.getElementById('exportFAQ').checked) exportData.faq = currentData.faq;
            
            exportData.exportDate = new Date().toISOString();
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const fileName = `studio-export-${new Date().toISOString().slice(0,10)}.json`;
            
            const link = document.createElement('a');
            link.setAttribute('href', dataUri);
            link.setAttribute('download', fileName);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showStatus('Данные экспортированы', 'success');
        }
        
        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const importedData = JSON.parse(e.target.result);
                        
                        if (confirm('Импортировать данные? Текущие данные будут объединены с импортированными.')) {
                            // Объединяем данные
                            Object.keys(importedData).forEach(key => {
                                if (key === 'main' && importedData.main) {
                                    currentData.main = { ...currentData.main, ...importedData.main };
                                } else if (Array.isArray(currentData[key]) && Array.isArray(importedData[key])) {
                                    currentData[key] = [...currentData[key], ...importedData[key]];
                                }
                            });
                            
                            updateAllSections();
                            showStatus('Данные импортированы', 'success');
                        }
                    } catch (error) {
                        showStatus('Ошибка импорта: ' + error.message, 'error');
                    }
                };
                reader.readAsText(file);
            };
            
            input.click();
        }
        
        function clearAllData() {
            if (confirm('ВНИМАНИЕ: Это удалит ВСЕ данные на сайте! Продолжить?')) {
                localStorage.removeItem('studioData');
                localStorage.removeItem('pendingReviews');
                
                currentData = {
                    main: {
                        studioName: "",
                        phone: "",
                        email: "",
                        address: "",
                        workingHours: "",
                        trialPrice: "",
                        studioDescription: "",
                        socialLinks: []
                    },
                    directions: [],
                    schedule: [],
                    prices: [],
                    team: [],
                    gallery: [],
                    reviews: [],
                    news: [],
                    faq: []
                };
                
                updateAllSections();
                showStatus('Все данные очищены', 'success');
            }
        }
        
        // === УТИЛИТЫ ===
        function showLoader(text = 'Загрузка...') {
            document.getElementById('loader').classList.add('active');
            document.getElementById('loaderText').textContent = text;
        }
        
        function hideLoader() {
            document.getElementById('loader').classList.remove('active');
        }
        
        function showStatus(message, type = 'success', duration = 3000) {
            const status = document.getElementById('statusMessage');
            status.textContent = message;
            status.className = 'status-message ' + type;
            status.classList.add('show');
            
            setTimeout(() => {
                status.classList.remove('show');
            }, duration);
        }
        
        function previewSite() {
            saveAllData();
            
            // В реальном проекте здесь открывался бы сайт
            showStatus('Сайт готов к просмотру. Данные сохранены.', 'success');
            
            // Создаем временную страницу для предпросмотра
            const previewWindow = window.open('', '_blank');
            if (previewWindow) {
                previewWindow.document.write(`
                    <html>
                    <head>
                        <title>Предпросмотр сайта студии</title>
                        <style>
                            body { font-family: Arial, sans-serif; padding: 20px; }
                            .container { max-width: 800px; margin: 0 auto; }
                            .section { margin: 30px 0; padding: 20px; background: #f9f9f9; border-radius: 10px; }
                        </style>
                    </head>
                    <body>
                        <div class="container">
                            <h1>${currentData.main.studioName || 'Студия танцев'}</h1>
                            <p>Это предпросмотр сайта. Данные загружены из редактора.</p>
                            <div class="section">
                                <h2>Основная информация</h2>
                                <p>Телефон: ${currentData.main.phone || 'Не указан'}</p>
                                <p>Адрес: ${currentData.main.address || 'Не указан'}</p>
                                <p>Часы работы: ${currentData.main.workingHours || 'Не указаны'}</p>
                            </div>
                            <div class="section">
                                <h2>Направления (${currentData.directions.length})</h2>
                                <p>Количество направлений: ${currentData.directions.length}</p>
                            </div>
                            <div class="section">
                                <h2>Расписание (${currentData.schedule.length})</h2>
                                <p>Количество занятий в расписании: ${currentData.schedule.length}</p>
                            </div>
                            <div class="section">
                                <h2>Фотогалерея (${currentData.gallery.length})</h2>
                                <p>Количество фото: ${currentData.gallery.length}</p>
                            </div>
                            <button onclick="window.close()">Закрыть предпросмотр</button>
                        </div>
                    </body>
                    </html>
                `);
                previewWindow.document.close();
            }
        }
        
        function showDataSummary() {
            const content = `
                <div style="margin: 20px 0;">
                    <h3 style="margin-bottom: 15px;">Статистика данных</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px;">
                        <div style="background: rgba(230, 126, 34, 0.1); padding: 15px; border-radius: 10px;">
                            <div style="font-size: 12px; color: #666;">Направления</div>
                            <div style="font-size: 32px; font-weight: bold; color: var(--primary);">
                                ${currentData.directions.length}
                            </div>
                        </div>
                        <div style="background: rgba(39, 174, 96, 0.1); padding: 15px; border-radius: 10px;">
                            <div style="font-size: 12px; color: #666;">Занятия в расписании</div>
                            <div style="font-size: 32px; font-weight: bold; color: var(--success);">
                                ${currentData.schedule.length}
                            </div>
                        </div>
                        <div style="background: rgba(52, 152, 219, 0.1); padding: 15px; border-radius: 10px;">
                            <div style="font-size: 12px; color: #666;">Тарифы</div>
                            <div style="font-size: 32px; font-weight: bold; color: var(--info);">
                                ${currentData.prices.length}
                            </div>
                        </div>
                        <div style="background: rgba(155, 89, 182, 0.1); padding: 15px; border-radius: 10px;">
                            <div style="font-size: 12px; color: #666;">Команда</div>
                            <div style="font-size: 32px; font-weight: bold; color: var(--purple);">
                                ${currentData.team.length}
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="margin: 20px 0;">
                    <h3 style="margin-bottom: 15px;">Общая статистика</h3>
                    <div style="background: #f9f9f9; padding: 20px; border-radius: 10px;">
                        <div class="form-row">
                            <div style="flex: 1;">
                                <div style="font-size: 12px; color: #666;">Всего элементов</div>
                                <div style="font-size: 24px; font-weight: bold; color: var(--primary);">
                                    ${Object.values(currentData).reduce((sum, section) => Array.isArray(section) ? sum + section.length : sum, 0)}
                                </div>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-size: 12px; color: #666;">Размер данных</div>
                                <div style="font-size: 24px; font-weight: bold; color: var(--info);">
                                    ${(JSON.stringify(currentData).length / 1024).toFixed(2)} КБ
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            const footer = `
                <button class="btn" onclick="closeModal()">
                    <i class="fas fa-times"></i> Закрыть
                </button>
            `;
            
            showModal('<i class="fas fa-chart-bar"></i> Статистика данных', content, footer);
        }
        
        // Инициализация при загрузке
        window.onload = function() {
            // Устанавливаем чекбоксы экспорта
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
                cb.checked = true;
            });
        };
    </script>
</body>
</html>
