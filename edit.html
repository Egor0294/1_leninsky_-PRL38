<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Полный редактор сайта - Студия танцев</title>
    <style>
        :root {
            --primary: #E67E22;
            --secondary: #D35400;
            --light: #FFF8F0;
            --dark: #2C1810;
            --success: #27AE60;
            --danger: #E74C3C;
            --info: #3498DB;
            --warning: #F39C12;
            --purple: #9B59B6;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }
        
        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 16px;
        }
        
        .header-actions {
            position: absolute;
            top: 30px;
            right: 30px;
            display: flex;
            gap: 10px;
        }
        
        .tabs {
            display: flex;
            background: var(--light);
            border-bottom: 2px solid var(--primary);
            flex-wrap: wrap;
            overflow-x: auto;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .tab {
            padding: 18px 25px;
            cursor: pointer;
            font-weight: 600;
            color: var(--dark);
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
            min-width: fit-content;
            position: relative;
        }
        
        .tab:hover {
            background: rgba(230, 126, 34, 0.1);
        }
        
        .tab.active {
            background: white;
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
        }
        
        .tab-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            background: var(--danger);
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            min-width: 18px;
            text-align: center;
        }
        
        .tab-content {
            display: none;
            padding: 30px;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .form-section {
            background: #f9f9f9;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 1px solid #eee;
        }
        
        .form-section h3 {
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-row .form-group {
            flex: 1;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .label-required:after {
            content: " *";
            color: var(--danger);
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        input:focus, textarea:focus, select:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(230, 126, 34, 0.1);
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(230, 126, 34, 0.3);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success), #2ECC71);
            color: white;
        }
        
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(39, 174, 96, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #FF6B6B);
            color: white;
        }
        
        .btn-info {
            background: linear-gradient(135deg, var(--info), #3498DB);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, var(--warning), #F39C12);
            color: white;
        }
        
        .btn-purple {
            background: linear-gradient(135deg, var(--purple), #8E44AD);
            color: white;
        }
        
        .btn-small {
            padding: 8px 16px;
            font-size: 14px;
        }
        
        .btn-block {
            width: 100%;
            justify-content: center;
        }
        
        .actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #eee;
            flex-wrap: wrap;
        }
        
        .item-list {
            background: white;
            border-radius: 10px;
            border: 1px solid #eee;
            margin-top: 20px;
            max-height: 500px;
            overflow-y: auto;
        }
        
        .item {
            padding: 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }
        
        .item:hover {
            background: #f9f9f9;
        }
        
        .item:last-child {
            border-bottom: none;
        }
        
        .item-info {
            flex: 1;
        }
        
        .item-info h4 {
            margin-bottom: 5px;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .item-info p {
            color: #666;
            font-size: 14px;
        }
        
        .item-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .photo-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .photo-item {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border: 1px solid #eee;
        }
        
        .photo-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .photo-preview {
            width: 100%;
            height: 200px;
            background: #f5f5f5;
            overflow: hidden;
            position: relative;
        }
        
        .photo-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        
        .photo-item:hover .photo-preview img {
            transform: scale(1.05);
        }
        
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(44, 24, 16, 0.9);
            z-index: 2000;
            animation: fadeIn 0.3s ease;
            backdrop-filter: blur(5px);
        }
        
        .modal-overlay.active {
            display: block;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 2001;
            animation: modalSlideIn 0.4s ease;
        }
        
        .modal.active {
            display: block;
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translate(-50%, -60%);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%);
            }
        }
        
        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            width: 90vw;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 30px 80px rgba(0,0,0,0.4);
        }
        
        .modal-header {
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .modal-close {
            font-size: 28px;
            cursor: pointer;
            color: var(--primary);
            transition: all 0.3s ease;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: white;
            border: none;
        }
        
        .modal-close:hover {
            color: var(--danger);
            transform: rotate(90deg);
            background: #f9f9f9;
        }
        
        .modal-body {
            margin-bottom: 20px;
        }
        
        .modal-footer {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        .upload-area {
            border: 3px dashed #ddd;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f9f9f9;
            margin-bottom: 20px;
        }
        
        .upload-area:hover {
            border-color: var(--primary);
            background: rgba(230, 126, 34, 0.05);
        }
        
        .upload-area.drag-over {
            border-color: var(--success);
            background: rgba(39, 174, 96, 0.05);
        }
        
        .upload-icon {
            font-size: 48px;
            color: var(--primary);
            margin-bottom: 15px;
        }
        
        .info-box {
            background: linear-gradient(135deg, rgba(230, 126, 34, 0.1), rgba(255, 255, 255, 0.8));
            border-left: 4px solid var(--primary);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .info-box-title {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .info-box-content {
            color: #666;
            font-size: 14px;
            line-height: 1.6;
        }
        
        .editor-toolbar {
            background: #f0f0f0;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .counter {
            background: var(--primary);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-left: 10px;
        }
        
        .status-bar {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: flex-end;
        }
        
        .status-message {
            padding: 15px 25px;
            border-radius: 10px;
            background: var(--success);
            color: white;
            font-weight: 600;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.5s ease;
        }
        
        .status-message.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        .status-message.error {
            background: var(--danger);
        }
        
        .status-message.warning {
            background: var(--warning);
        }
        
        .status-message.info {
            background: var(--info);
        }
        
        .category-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        
        .category-tag {
            padding: 8px 15px;
            background: #f0f0f0;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .category-tag:hover {
            background: #e0e0e0;
        }
        
        .category-tag.active {
            background: var(--primary);
            color: white;
        }
        
        .preview-image {
            max-width: 100%;
            max-height: 200px;
            border-radius: 10px;
            margin: 15px 0;
            display: block;
            border: 2px solid #eee;
        }
        
        .preview-container {
            text-align: center;
            margin: 15px 0;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 10px;
        }
        
        .loader {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.9);
            z-index: 3000;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 20px;
        }
        
        .loader.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }
        
        .loader-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .toggle-panel {
            background: #f9f9f9;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            border-left: 4px solid var(--info);
        }
        
        .toggle-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }
        
        .toggle-content {
            display: none;
            padding-top: 15px;
        }
        
        .toggle-content.active {
            display: block;
        }
        
        .schedule-days {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .schedule-day {
            padding: 10px 20px;
            background: #f0f0f0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            text-align: center;
            min-width: 80px;
        }
        
        .schedule-day:hover {
            background: #e0e0e0;
        }
        
        .schedule-day.active {
            background: var(--primary);
            color: white;
        }
        
        .schedule-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .schedule-table th {
            background: var(--primary);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: 600;
            border: 1px solid var(--secondary);
        }
        
        .schedule-table td {
            padding: 15px;
            border: 1px solid #eee;
            text-align: center;
            vertical-align: top;
        }
        
        .schedule-table tr:hover td {
            background: #f9f9f9;
        }
        
        .schedule-item {
            background: linear-gradient(135deg, rgba(52, 152, 219, 0.1), rgba(52, 152, 219, 0.05));
            border-radius: 8px;
            padding: 12px;
            margin: 5px 0;
            border-left: 4px solid var(--info);
            text-align: left;
            position: relative;
        }
        
        .schedule-item-highlight {
            background: linear-gradient(135deg, rgba(230, 126, 34, 0.1), rgba(230, 126, 34, 0.05));
            border-left: 4px solid var(--primary);
        }
        
        .schedule-time {
            font-weight: bold;
            color: var(--dark);
            margin-bottom: 5px;
        }
        
        .schedule-direction {
            font-size: 14px;
            color: var(--primary);
            margin-bottom: 3px;
        }
        
        .schedule-age {
            font-size: 12px;
            color: #666;
            background: rgba(0,0,0,0.05);
            padding: 2px 6px;
            border-radius: 10px;
            display: inline-block;
        }
        
        .schedule-instructor {
            font-size: 12px;
            color: #888;
            margin-top: 5px;
            font-style: italic;
        }
        
        .time-slots {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }
        
        .time-slot {
            padding: 8px 12px;
            background: #f0f0f0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 14px;
        }
        
        .time-slot:hover {
            background: #e0e0e0;
        }
        
        .time-slot.selected {
            background: var(--primary);
            color: white;
        }
        
        .schedule-actions {
            position: absolute;
            top: 5px;
            right: 5px;
            display: flex;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .schedule-item:hover .schedule-actions {
            opacity: 1;
        }
        
        .schedule-action-btn {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            cursor: pointer;
            border: none;
            color: white;
        }
        
        .edit-schedule {
            background: var(--info);
        }
        
        .delete-schedule {
            background: var(--danger);
        }
        
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                text-align: center;
                border-bottom: 1px solid #ddd;
            }
            
            .tab.active {
                border-right: 3px solid var(--primary);
                border-bottom: none;
            }
            
            .actions {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .photo-container {
                grid-template-columns: 1fr;
            }
            
            .header-actions {
                position: static;
                justify-content: center;
                margin-top: 20px;
            }
            
            .item {
                flex-direction: column;
                gap: 15px;
                align-items: stretch;
            }
            
            .item-actions {
                justify-content: center;
            }
            
            .modal-content {
                padding: 25px;
                width: 95vw;
            }
            
            .schedule-table {
                display: block;
                overflow-x: auto;
            }
            
            .schedule-days {
                overflow-x: auto;
                flex-wrap: nowrap;
                padding-bottom: 10px;
            }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(230, 126, 34, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(230, 126, 34, 0); }
            100% { box-shadow: 0 0 0 0 rgba(230, 126, 34, 0); }
        }
        
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary);
        }
        
        .rating-stars {
            display: flex;
            gap: 5px;
            margin: 10px 0;
        }
        
        .star {
            font-size: 24px;
            cursor: pointer;
            color: #ddd;
            transition: color 0.3s ease;
        }
        
        .star.active {
            color: var(--warning);
        }
        
        .teacher-avatar {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 32px;
            font-weight: bold;
            margin: 0 auto 20px;
        }
        
        .price-preview {
            background: linear-gradient(135deg, #f9f9f9, #fff);
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
            border: 2px solid #eee;
            text-align: center;
        }
        
        .price-value {
            font-size: 32px;
            font-weight: bold;
            color: var(--primary);
            margin: 10px 0;
        }
        
        .price-period {
            color: #666;
            font-size: 14px;
        }
        
        .features-list {
            margin: 15px 0;
            padding-left: 20px;
        }
        
        .feature-item {
            margin: 5px 0;
            color: #555;
            font-size: 14px;
        }
        
        .feature-item:before {
            content: "✓ ";
            color: var(--success);
            font-weight: bold;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="loader" id="loader">
        <div class="loader-spinner"></div>
        <div id="loaderText">Загрузка...</div>
    </div>
    
    <div class="container">
        <div class="header">
            <h1>
                <i class="fas fa-edit"></i>
                <span>Редактор сайта танцевальной студии</span>
                <span class="counter" id="totalItemsCount">0</span>
            </h1>
            <p>Управляйте всеми данными сайта: контент, цены, команда, фото и отзывы</p>
            
            <div class="header-actions">
                <button class="btn btn-success btn-small" onclick="saveAllData()">
                    <i class="fas fa-save"></i> Сохранить всё
                </button>
                <button class="btn btn-primary btn-small" onclick="previewSite()">
                    <i class="fas fa-eye"></i> Просмотр
                </button>
            </div>
        </div>
        
        <div class="tabs">
            <div class="tab active" data-tab="main">
                <i class="fas fa-home"></i> Основное
            </div>
            <div class="tab" data-tab="directions">
                <i class="fas fa-dance"></i> Направления
                <span class="tab-badge" id="directionsBadge">0</span>
            </div>
            <div class="tab" data-tab="schedule">
                <i class="fas fa-calendar-alt"></i> Расписание
                <span class="tab-badge" id="scheduleBadge">0</span>
            </div>
            <div class="tab" data-tab="prices">
                <i class="fas fa-tags"></i> Цены
                <span class="tab-badge" id="pricesBadge">0</span>
            </div>
            <div class="tab" data-tab="team">
                <i class="fas fa-users"></i> Команда
                <span class="tab-badge" id="teamBadge">0</span>
            </div>
            <div class="tab" data-tab="photos">
                <i class="fas fa-images"></i> Фотогалерея
                <span class="tab-badge" id="photosBadge">0</span>
            </div>
            <div class="tab" data-tab="reviews">
                <i class="fas fa-comments"></i> Отзывы
                <span class="tab-badge" id="reviewsBadge">0</span>
            </div>
            <div class="tab" data-tab="news">
                <i class="fas fa-newspaper"></i> Новости
                <span class="tab-badge" id="newsBadge">0</span>
            </div>
            <div class="tab" data-tab="faq">
                <i class="fas fa-question-circle"></i> FAQ
                <span class="tab-badge" id="faqBadge">0</span>
            </div>
            <div class="tab" data-tab="settings">
                <i class="fas fa-cog"></i> Настройки
            </div>
        </div>
        
        <div class="tab-content active" id="main">
            <div class="info-box">
                <div class="info-box-title">
                    <i class="fas fa-info-circle"></i> Основная информация о студии
                </div>
                <div class="info-box-content">
                    Заполните основную информацию, которая будет отображаться на главной странице сайта
                </div>
            </div>
            
            <div class="form-section">
                <h3><i class="fas fa-building"></i> Информация о студии</h3>
                <div class="form-group">
                    <label class="label-required">Название студии</label>
                    <input type="text" id="studioName" placeholder="Первый ритм Ленинского" maxlength="100">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="label-required">Телефон</label>
                        <input type="tel" id="phone" placeholder="+7 (904) 123-31-75">
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="email" placeholder="info@primeritm.ru">
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="label-required">Адрес</label>
                    <textarea id="address" placeholder="г. Иркутск, ул. 1-й Ленинский квартал, д. 1" rows="2"></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="label-required">Часы работы</label>
                        <input type="text" id="workingHours" placeholder="Ежедневно с 8:00 до 22:00">
                    </div>
                    <div class="form-group">
                        <label class="label-required">Цена пробного занятия</label>
                        <input type="text" id="trialPrice" placeholder="300₽">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Описание студии</label>
                    <textarea id="studioDescription" placeholder="Краткое описание вашей танцевальной студии..." rows="4"></textarea>
                </div>
            </div>
            
            <div class="form-section">
                <h3><i class="fas fa-share-alt"></i> Социальные сети</h3>
                <div id="socialLinksList"></div>
                <button class="btn btn-primary" onclick="addSocialLink()">
                    <i class="fas fa-plus"></i> Добавить соцсеть
                </button>
            </div>
            
            <div class="actions">
                <button class="btn btn-success" onclick="saveMainSettings()">
                    <i class="fas fa-save"></i> Сохранить настройки
                </button>
                <button class="btn btn-warning" onclick="resetMainSettings()">
                    <i class="fas fa-undo"></i> Сбросить
                </button>
            </div>
        </div>
        
        <div class="tab-content" id="directions">
            <div class="editor-toolbar">
                <div>
                    <strong>Танцевальные направления</strong>
                    <span class="counter" id="directionsCount">0</span>
                </div>
                <div>
                    <button class="btn btn-primary btn-small" onclick="showDirectionModal()">
                        <i class="fas fa-plus"></i> Добавить направление
                    </button>
                    <button class="btn btn-info btn-small" onclick="importDemoDirections()">
                        <i class="fas fa-magic"></i> Демо-данные
                    </button>
                </div>
            </div>
            
            <div id="directionsList" class="item-list"></div>
            
            <div class="actions">
                <button class="btn btn-success" onclick="saveDirections()">
                    <i class="fas fa-save"></i> Сохранить направления
                </button>
                <button class="btn btn-danger" onclick="clearDirections()">
                    <i class="fas fa-trash"></i> Очистить все
                </button>
            </div>
        </div>
        
        <div class="tab-content" id="schedule">
            <div class="info-box">
                <div class="info-box-title">
                    <i class="fas fa-calendar-alt"></i> Редактор расписания занятий
                </div>
                <div class="info-box-content">
                    Создайте и управляйте расписанием занятий. Расписание будет отображаться на сайте в удобном виде.
                </div>
            </div>
            
            <div class="editor-toolbar">
                <div>
                    <strong>Расписание занятий</strong>
                    <span class="counter" id="scheduleCount">0</span>
                </div>
                <div>
                    <button class="btn btn-primary btn-small" onclick="showScheduleModal()">
                        <i class="fas fa-plus"></i> Добавить занятие
                    </button>
                    <button class="btn btn-info btn-small" onclick="showQuickTimeSlotsModal()">
                        <i class="fas fa-bolt"></i> Быстрое добавление
                    </button>
                    <button class="btn btn-info btn-small" onclick="importDemoSchedule()">
                        <i class="fas fa-magic"></i> Демо-расписание
                    </button>
                    <button class="btn btn-warning btn-small" onclick="clearSchedule()">
                        <i class="fas fa-trash"></i> Очистить все
                    </button>
                </div>
            </div>
            
            <div class="form-section">
                <h3><i class="fas fa-filter"></i> Фильтр по дням недели</h3>
                <div class="schedule-days" id="scheduleDays"></div>
                <div class="form-group">
                    <button class="btn btn-small" onclick="showAllDays()">
                        <i class="fas fa-eye"></i> Показать все дни
                    </button>
                    <button class="btn btn-small" onclick="showTodaySchedule()">
                        <i class="fas fa-calendar-day"></i> Сегодня
                    </button>
                </div>
            </div>
            
            <div id="scheduleTableContainer"></div>
            
            <div id="emptySchedule" style="display: none; text-align: center; padding: 60px 20px;">
                <i class="fas fa-calendar-times" style="font-size: 64px; color: #ddd; margin-bottom: 20px;"></i>
                <h3 style="color: #666; margin-bottom: 15px;">Расписание пусто</h3>
                <p style="color: #888; margin-bottom: 25px;">Добавьте занятия, чтобы создать расписание</p>
                <button class="btn btn-primary" onclick="showScheduleModal()">
                    <i class="fas fa-plus"></i> Добавить первое занятие
                </button>
            </div>
            
            <div class="actions">
                <button class="btn btn-success" onclick="saveSchedule()">
                    <i class="fas fa-save"></i> Сохранить расписание
                </button>
                <button class="btn btn-info" onclick="printSchedule()">
                    <i class="fas fa-print"></i> Распечатать расписание
                </button>
                <button class="btn btn-purple" onclick="exportSchedule()">
                    <i class="fas fa-download"></i> Экспорт в PDF
                </button>
            </div>
        </div>
        
        <div class="tab-content" id="prices">
            <div class="editor-toolbar">
                <div>
                    <strong>Тарифы и цены</strong>
                    <span class="counter" id="pricesCount">0</span>
                </div>
                <button class="btn btn-primary btn-small" onclick="showPriceModal()">
                    <i class="fas fa-plus"></i> Добавить тариф
                </button>
            </div>
            
            <div id="pricesList" class="item-list"></div>
            
            <div class="actions">
                <button class="btn btn-success" onclick="savePrices()">
                    <i class="fas fa-save"></i> Сохранить цены
                </button>
                <button class="btn btn-warning" onclick="sortPricesByPrice()">
                    <i class="fas fa-sort-amount-up"></i> Сортировать по цене
                </button>
            </div>
        </div>
        
        <div class="tab-content" id="team">
            <div class="editor-toolbar">
                <div>
                    <strong>Команда преподавателей</strong>
                    <span class="counter" id="teamCount">0</span>
                </div>
                <button class="btn btn-primary btn-small" onclick="showTeamModal()">
                    <i class="fas fa-plus"></i> Добавить участника
                </button>
            </div>
            
            <div id="teamList" class="item-list"></div>
            
            <div class="actions">
                <button class="btn btn-success" onclick="saveTeam()">
                    <i class="fas fa-save"></i> Сохранить команду
                </button>
            </div>
        </div>
        
        <div class="tab-content" id="photos">
            <div class="editor-toolbar">
                <div>
                    <strong>Фотогалерея</strong>
                    <span class="counter" id="photosCount">0</span>
                </div>
                <div>
                    <button class="btn btn-primary btn-small" onclick="showUploadPhotoModal()">
                        <i class="fas fa-upload"></i> Загрузить фото
                    </button>
                    <button class="btn btn-info btn-small" onclick="importDemoPhotos()">
                        <i class="fas fa-magic"></i> Демо-фото
                    </button>
                </div>
            </div>
            
            <div class="category-tags" id="galleryCategories"></div>
            
            <div id="galleryContainer" class="photo-container"></div>
            
            <div id="emptyGallery" style="display: none; text-align: center; padding: 60px 20px;">
                <i class="fas fa-images" style="font-size: 64px; color: #ddd; margin-bottom: 20px;"></i>
                <h3 style="color: #666; margin-bottom: 15px;">Галерея пуста</h3>
                <p style="color: #888; margin-bottom: 25px;">Добавьте фотографии, чтобы наполнить галерею</p>
                <button class="btn btn-primary" onclick="showUploadPhotoModal()">
                    <i class="fas fa-plus"></i> Добавить первое фото
                </button>
            </div>
            
            <div class="actions">
                <button class="btn btn-success" onclick="saveGallery()">
                    <i class="fas fa-save"></i> Сохранить галерею
                </button>
                <button class="btn btn-danger" onclick="clearGallery()">
                    <i class="fas fa-trash"></i> Очистить галерею
                </button>
            </div>
        </div>
        
        <div class="tab-content" id="reviews">
            <div class="editor-toolbar">
                <div>
                    <strong>Отзывы клиентов</strong>
                    <span class="counter" id="reviewsCount">0</span>
                </div>
                <div>
                    <button class="btn btn-primary btn-small" onclick="showReviewModal()">
                        <i class="fas fa-plus"></i> Добавить отзыв
                    </button>
                    <button class="btn btn-info btn-small" onclick="generateTestimonials()">
                        <i class="fas fa-comment-medical"></i> Сгенерировать отзывы
                    </button>
                </div>
            </div>
            
            <div id="reviewsList" class="item-list"></div>
            
            <div class="actions">
                <button class="btn btn-success" onclick="saveReviews()">
                    <i class="fas fa-save"></i> Сохранить отзывы
                </button>
            </div>
        </div>
        
        <div class="tab-content" id="news">
            <div class="editor-toolbar">
                <div>
                    <strong>Новости студии</strong>
                    <span class="counter" id="newsCount">0</span>
                </div>
                <button class="btn btn-primary btn-small" onclick="showNewsModal()">
                    <i class="fas fa-plus"></i> Добавить новость
                </button>
            </div>
            
            <div id="newsList" class="item-list"></div>
            
            <div class="actions">
                <button class="btn btn-success" onclick="saveNews()">
                    <i class="fas fa-save"></i> Сохранить новости
                </button>
            </div>
        </div>
        
        <div class="tab-content" id="faq">
            <div class="editor-toolbar">
                <div>
                    <strong>Частые вопросы</strong>
                    <span class="counter" id="faqCount">0</span>
                </div>
                <button class="btn btn-primary btn-small" onclick="showFAQModal()">
                    <i class="fas fa-plus"></i> Добавить вопрос
                </button>
            </div>
            
            <div id="faqList" class="item-list"></div>
            
            <div class="actions">
                <button class="btn btn-success" onclick="saveFAQ()">
                    <i class="fas fa-save"></i> Сохранить FAQ
                </button>
                <button class="btn btn-info" onclick="sortFAQ()">
                    <i class="fas fa-sort-alpha-down"></i> Сортировать
                </button>
            </div>
        </div>
        
        <div class="tab-content" id="settings">
            <div class="info-box">
                <div class="info-box-title">
                    <i class="fas fa-cogs"></i> Системные настройки
                </div>
                <div class="info-box-content">
                    Настройки редактора, экспорт/импорт данных, резервное копирование
                </div>
            </div>
            
            <div class="form-section">
                <h3><i class="fas fa-database"></i> Управление данными</h3>
                
                <div class="form-group">
                    <label>Статистика данных</label>
                    <div style="background: #f9f9f9; padding: 20px; border-radius: 10px;">
                        <div class="form-row">
                            <div style="flex: 1;">
                                <div style="font-size: 12px; color: #666;">Всего элементов</div>
                                <div style="font-size: 24px; font-weight: bold; color: var(--primary);" id="totalStats">0</div>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-size: 12px; color: #666;">Размер данных</div>
                                <div style="font-size: 24px; font-weight: bold; color: var(--info);" id="dataSize">0 КБ</div>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-size: 12px; color: #666;">Последнее сохранение</div>
                                <div style="font-size: 14px; font-weight: bold; color: var(--success);" id="lastSave">-</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="actions">
                    <button class="btn btn-success" onclick="createBackup()">
                        <i class="fas fa-save"></i> Создать резервную копию
                    </button>
                    <button class="btn btn-info" onclick="restoreBackup()">
                        <i class="fas fa-history"></i> Восстановить из копии
                    </button>
                </div>
            </div>
            
            <div class="form-section">
                <h3><i class="fas fa-file-export"></i> Экспорт и импорт</h3>
                
                <div class="form-group">
                    <label>Выберите разделы для экспорта</label>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px; margin-top: 10px;">
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="exportMain" checked> Основное
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="exportDirections" checked> Направления
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="exportSchedule" checked> Расписание
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="exportPrices" checked> Цены
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="exportTeam" checked> Команда
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="exportPhotos" checked> Фотогалерея
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="exportReviews" checked> Отзывы
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="exportNews" checked> Новости
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="exportFAQ" checked> FAQ
                        </label>
                    </div>
                </div>
                
                <div class="actions">
                    <button class="btn btn-primary" onclick="exportSelectedData()">
                        <i class="fas fa-download"></i> Экспорт выбранного
                    </button>
                    <button class="btn btn-warning" onclick="importData()">
                        <i class="fas fa-upload"></i> Импорт данных
                    </button>
                    <button class="btn btn-danger" onclick="clearAllData()">
                        <i class="fas fa-trash"></i> Очистить все
                    </button>
                </div>
            </div>
        </div>
        
        <div class="actions" style="margin: 30px; border-top: none;">
            <button class="btn btn-success btn-block pulse" onclick="saveAllData()" style="flex: 2;">
                <i class="fas fa-cloud-upload-alt"></i> СОХРАНИТЬ ВСЕ ИЗМЕНЕНИЯ НА САЙТ
            </button>
            <button class="btn btn-primary" onclick="loadFromWebsite()">
                <i class="fas fa-sync-alt"></i> Загрузить данные с сайта
            </button>
            <button class="btn btn-info" onclick="showDataSummary()">
                <i class="fas fa-chart-bar"></i> Статистика
            </button>
        </div>
    </div>
    
    <div class="modal-overlay" id="modalOverlay"></div>
    <div class="modal" id="commonModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle"><i class="fas fa-edit"></i> Редактирование</h2>
                <button class="modal-close" onclick="closeModal()">×</button>
            </div>
            <div class="modal-body" id="modalBody"></div>
            <div class="modal-footer" id="modalFooter"></div>
        </div>
    </div>
    
    <div class="status-bar">
        <div class="status-message" id="statusMessage">Готово</div>
    </div>
    
    <script>
        let currentData = {
            main: {
                studioName: "Первый ритм Ленинского",
                phone: "+7 (904) 123-31-75",
                email: "info@primeritm.ru",
                address: "г. Иркутск, ул. 1-й Ленинский квартал, д. 1",
                workingHours: "Ежедневно с 8:00 до 22:00",
                trialPrice: "300₽",
                studioDescription: "Профессиональная студия танцев для всех возрастов. Современное оборудование, опытные преподаватели, индивидуальный подход.",
                socialLinks: [
                    { name: "VK", url: "https://vk.com/club233766207", icon: "fab fa-vk" },
                    { name: "Telegram", url: "#", icon: "fab fa-telegram" },
                    { name: "Instagram", url: "#", icon: "fab fa-instagram" }
                ]
            },
            directions: [],
            schedule: [],
            prices: [],
            team: [],
            gallery: [],
            reviews: [],
            news: [],
            faq: []
        };
        
        let pendingReviews = [];
        let currentPhotoCategory = 'studio';
        let editingItem = { type: null, index: -1 };
        let currentRating = 5;
        let currentScheduleDay = 'all';
        let selectedQuickTime = null;
        
        document.addEventListener('DOMContentLoaded', function() {
            loadFromWebsite();
            setupTabs();
            updateTotalCount();
        });
        
        function setupTabs() {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    tabs.forEach(t => t.classList.remove('active'));
                    
                    document.getElementById(tabId).classList.add('active');
                    this.classList.add('active');
                    
                    if (tabId === 'photos') {
                        updateGalleryView();
                    } else if (tabId === 'schedule') {
                        updateScheduleSection();
                    }
                });
            });
        }
        
        function loadFromWebsite() {
            showLoader('Загрузка данных с сайта...');
            
            setTimeout(() => {
                try {
                    const savedData = localStorage.getItem('studioData');
                    
                    if (savedData) {
                        const parsedData = JSON.parse(savedData);
                        
                        if (parsedData.main) {
                            currentData.main = { ...currentData.main, ...parsedData.main };
                        }
                        
                        ['directions', 'schedule', 'prices', 'team', 'gallery', 'reviews', 'news', 'faq'].forEach(key => {
                            if (parsedData[key] && Array.isArray(parsedData[key])) {
                                currentData[key] = parsedData[key];
                            }
                        });
                        
                        showStatus('Данные загружены с сайта', 'success');
                    } else {
                        loadDemoData();
                        showStatus('Загружены демо-данные', 'info');
                    }
                    
                    updateAllSections();
                    hideLoader();
                    
                } catch (error) {
                    console.error('Ошибка загрузки данных:', error);
                    showStatus('Ошибка загрузки данных', 'error');
                    hideLoader();
                }
            }, 500);
        }
        
        function loadDemoData() {
            currentData.directions = [
                {
                    id: 'baby-dance',
                    title: 'Танец-игра / Ритмика',
                    age: '3-7 лет',
                    schedule: 'Понедельник и среда в 17:00',
                    price: 'Пробное занятие: 300₽',
                    description: 'Развитие чувства ритма, координации и любви к движению через веселые игры.',
                    features: ['Игровая форма', 'Развитие ритма', 'Координация']
                }
            ];
            
            currentData.schedule = [
                {
                    id: 's1',
                    day: 'monday',
                    dayName: 'Понедельник',
                    time: '17:00',
                    duration: '60',
                    direction: 'Танец-игра / Ритмика',
                    age: '3-7 лет',
                    instructor: 'Анна Петрова',
                    room: 'Зал №1',
                    maxParticipants: '12',
                    isHighlighted: true
                }
            ];
            
            currentData.prices = [
                {
                    featured: true,
                    title: "ПРОБНОЕ ЗАНЯТИЕ",
                    subtitle: "Любое направление",
                    price: "300₽",
                    period: "1 занятие",
                    features: ["Первое занятие", "Консультация педагога", "Подбор направления"]
                }
            ];
            
            currentData.team = [
                {
                    initials: "АП",
                    name: "Анна Петрова",
                    role: "Главный хореограф",
                    experience: "14 лет",
                    description: "Профессиональный хореограф с международным опытом."
                }
            ];
            
            currentData.gallery = [
                {
                    id: 1,
                    title: "Основной зал студии",
                    description: "Профессиональное покрытие, зеркала, современное оборудование",
                    image: "https://images.unsplash.com/photo-1518834103328-93d45986dce1?auto=format&fit=crop&w=600&q=80",
                    category: "studio",
                    date: new Date().toLocaleDateString('ru-RU')
                }
            ];
            
            currentData.reviews = [
                {
                    rating: 5,
                    text: '"Дочь ходит второй год, вижу огромный прогреск! Преподаватели очень внимательные, находят подход к каждому ребенку. Рекомендую!"',
                    author: "Анна К.",
                    role: "Мама Софии (6 лет)",
                    initials: "АК"
                }
            ];
            
            currentData.news = [
                {
                    id: 1,
                    title: "Новый набор на детские группы!",
                    date: new Date().toLocaleDateString('ru-RU'),
                    image: "https://images.unsplash.com/photo-1518834103328-93d45986dce1?auto=format&fit=crop&w=600&q=80",
                    description: "Открыт набор в группы для детей 3-6 лет.",
                    shortText: "Открыт набор в детские группы 3-6 лет",
                    link: "#directions"
                }
            ];
            
            currentData.faq = [
                {
                    question: "С какого возраста можно начинать заниматься?",
                    answer: "Мы принимаем детей с 3 лет на программу 'Танцы-игра'."
                }
            ];
        }
        
        function saveAllData() {
            showLoader('Сохранение данных на сайт...');
            
            setTimeout(() => {
                try {
                    localStorage.setItem('studioData', JSON.stringify(currentData));
                    localStorage.setItem('lastSaveTime', new Date().toISOString());
                    
                    updateStats();
                    hideLoader();
                    showStatus('Все данные успешно сохранены на сайт!', 'success');
                    updateTotalCount();
                    
                } catch (error) {
                    console.error('Ошибка сохранения данных:', error);
                    hideLoader();
                    showStatus('Ошибка сохранения: ' + error.message, 'error');
                }
            }, 800);
        }
        
        function updateAllSections() {
            updateMainSection();
            updateDirectionsSection();
            updateScheduleSection();
            updatePricesSection();
            updateTeamSection();
            updateGallerySection();
            updateReviewsSection();
            updateNewsSection();
            updateFAQSection();
            updateCounters();
            updateStats();
        }
        
        function updateCounters() {
            document.getElementById('directionsCount').textContent = currentData.directions.length;
            document.getElementById('scheduleCount').textContent = currentData.schedule.length;
            document.getElementById('pricesCount').textContent = currentData.prices.length;
            document.getElementById('teamCount').textContent = currentData.team.length;
            document.getElementById('photosCount').textContent = currentData.gallery.length;
            document.getElementById('reviewsCount').textContent = currentData.reviews.length;
            document.getElementById('newsCount').textContent = currentData.news.length;
            document.getElementById('faqCount').textContent = currentData.faq.length;
            
            document.getElementById('directionsBadge').textContent = currentData.directions.length;
            document.getElementById('scheduleBadge').textContent = currentData.schedule.length;
            document.getElementById('pricesBadge').textContent = currentData.prices.length;
            document.getElementById('teamBadge').textContent = currentData.team.length;
            document.getElementById('photosBadge').textContent = currentData.gallery.length;
            document.getElementById('reviewsBadge').textContent = currentData.reviews.length;
            document.getElementById('newsBadge').textContent = currentData.news.length;
            document.getElementById('faqBadge').textContent = currentData.faq.length;
        }
        
        function updateTotalCount() {
            const total = Object.values(currentData).reduce((sum, section) => {
                if (Array.isArray(section)) {
                    return sum + section.length;
                }
                return sum;
            }, 0);
            
            document.getElementById('totalItemsCount').textContent = total;
        }
        
        function openModal() {
            document.getElementById('modalOverlay').classList.add('active');
            document.getElementById('commonModal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function closeModal() {
            document.getElementById('modalOverlay').classList.remove('active');
            document.getElementById('commonModal').classList.remove('active');
            document.body.style.overflow = 'auto';
            editingItem = { type: null, index: -1 };
            currentRating = 5;
            selectedQuickTime = null;
        }
        
        function showModal(title, content, footer = '') {
            document.getElementById('modalTitle').innerHTML = title;
            document.getElementById('modalBody').innerHTML = content;
            document.getElementById('modalFooter').innerHTML = footer;
            openModal();
        }
        
        // === ОСНОВНЫЕ НАСТРОЙКИ ===
        function updateMainSection() {
            const main = currentData.main;
            
            document.getElementById('studioName').value = main.studioName || '';
            document.getElementById('phone').value = main.phone || '';
            document.getElementById('email').value = main.email || '';
            document.getElementById('address').value = main.address || '';
            document.getElementById('workingHours').value = main.workingHours || '';
            document.getElementById('trialPrice').value = main.trialPrice || '';
            document.getElementById('studioDescription').value = main.studioDescription || '';
            
            updateSocialLinks();
        }
        
        function updateSocialLinks() {
            const container = document.getElementById('socialLinksList');
            container.innerHTML = '';
            
            currentData.main.socialLinks.forEach((link, index) => {
                const div = document.createElement('div');
                div.className = 'form-row';
                div.innerHTML = `
                    <div class="form-group">
                        <label>Название</label>
                        <input type="text" value="${link.name || ''}" 
                               onchange="updateSocialLinkField(${index}, 'name', this.value)">
                    </div>
                    <div class="form-group">
                        <label>Ссылка</label>
                        <input type="text" value="${link.url || ''}" 
                               onchange="updateSocialLinkField(${index}, 'url', this.value)">
                    </div>
                    <div class="form-group">
                        <label>Иконка (FontAwesome)</label>
                        <input type="text" value="${link.icon || ''}" 
                               onchange="updateSocialLinkField(${index}, 'icon', this.value)">
                    </div>
                    <div class="form-group" style="flex: 0 0 auto; padding-top: 25px;">
                        <button class="btn btn-danger btn-small" onclick="removeSocialLink(${index})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                container.appendChild(div);
            });
        }
        
        function updateSocialLinkField(index, field, value) {
            if (currentData.main.socialLinks[index]) {
                currentData.main.socialLinks[index][field] = value;
            }
        }
        
        function addSocialLink() {
            currentData.main.socialLinks.push({
                name: 'Новая соцсеть',
                url: '#',
                icon: 'fab fa-facebook'
            });
            updateSocialLinks();
        }
        
        function removeSocialLink(index) {
            if (confirm('Удалить эту социальную сеть?')) {
                currentData.main.socialLinks.splice(index, 1);
                updateSocialLinks();
            }
        }
        
        function saveMainSettings() {
            currentData.main.studioName = document.getElementById('studioName').value;
            currentData.main.phone = document.getElementById('phone').value;
            currentData.main.email = document.getElementById('email').value;
            currentData.main.address = document.getElementById('address').value;
            currentData.main.workingHours = document.getElementById('workingHours').value;
            currentData.main.trialPrice = document.getElementById('trialPrice').value;
            currentData.main.studioDescription = document.getElementById('studioDescription').value;
            
            saveAllData();
            showStatus('Основные настройки сохранены', 'success');
        }
        
        function resetMainSettings() {
            if (confirm('Сбросить основные настройки к значениям по умолчанию?')) {
                currentData.main = {
                    studioName: "Первый ритм Ленинского",
                    phone: "+7 (904) 123-31-75",
                    email: "info@primeritm.ru",
                    address: "г. Иркутск, ул. 1-й Ленинский квартал, д. 1",
                    workingHours: "Ежедневно с 8:00 до 22:00",
                    trialPrice: "300₽",
                    studioDescription: "Профессиональная студия танцев для всех возрастов. Современное оборудование, опытные преподаватели, индивидуальный подход.",
                    socialLinks: [
                        { name: "VK", url: "https://vk.com/club233766207", icon: "fab fa-vk" },
                        { name: "Telegram", url: "#", icon: "fab fa-telegram" },
                        { name: "Instagram", url: "#", icon: "fab fa-instagram" }
                    ]
                };
                
                updateMainSection();
                showStatus('Настройки сброшены', 'success');
            }
        }
        
        // === НАПРАВЛЕНИЯ ===
        function updateDirectionsSection() {
            const container = document.getElementById('directionsList');
            container.innerHTML = '';
            
            if (currentData.directions.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #666;">
                        <i class="fas fa-dance" style="font-size: 48px; margin-bottom: 20px; opacity: 0.3;"></i>
                        <h3>Нет направлений</h3>
                        <p>Добавьте танцевальные направления вашей студии</p>
                    </div>
                `;
                return;
            }
            
            currentData.directions.forEach((direction, index) => {
                const div = document.createElement('div');
                div.className = 'item';
                div.innerHTML = `
                    <div class="item-info">
                        <h4>
                            <i class="fas fa-music"></i>
                            ${direction.title || 'Новое направление'}
                            ${direction.featured ? ' <span style="color: var(--warning);">★</span>' : ''}
                        </h4>
                        <p>
                            <span style="background: rgba(52, 152, 219, 0.1); padding: 2px 8px; border-radius: 10px; font-size: 12px;">
                                <i class="fas fa-user"></i> ${direction.age || 'Все возрасты'}
                            </span>
                            <span style="margin-left: 10px; color: var(--primary); font-weight: bold;">
                                ${direction.price || 'Цена по запросу'}
                            </span>
                        </p>
                        <p style="font-size: 13px; color: #666; margin-top: 5px;">
                            <i class="fas fa-calendar-alt"></i> ${direction.schedule || 'По расписанию'}
                        </p>
                        <p style="font-size: 12px; color: #888; margin-top: 5px;">
                            ${direction.description || ''}
                        </p>
                    </div>
                    <div class="item-actions">
                        <button class="btn btn-primary btn-small" onclick="editDirection(${index})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-danger btn-small" onclick="removeDirection(${index})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                container.appendChild(div);
            });
        }
        
        function showDirectionModal(index = -1) {
            editingItem = { type: 'direction', index: index };
            let direction = index >= 0 ? currentData.directions[index] : null;
            
            const title = index >= 0 ? '<i class="fas fa-edit"></i> Редактировать направление' : '<i class="fas fa-plus"></i> Добавить направление';
            
            const content = `
                <div class="form-group">
                    <label>Название направления *</label>
                    <input type="text" id="modalDirectionTitle" value="${direction ? direction.title : ''}" placeholder="Например: Contemporary dance" class="modal-input">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Возрастная группа</label>
                        <input type="text" id="modalDirectionAge" value="${direction ? direction.age : ''}" placeholder="3-7 лет" class="modal-input">
                    </div>
                    <div class="form-group">
                        <label>Цена</label>
                        <input type="text" id="modalDirectionPrice" value="${direction ? direction.price : ''}" placeholder="300₽ (пробное)" class="modal-input">
                    </div>
                </div>
                <div class="form-group">
                    <label>Расписание</label>
                    <input type="text" id="modalDirectionSchedule" value="${direction ? direction.schedule : ''}" placeholder="Пн и Ср в 17:00" class="modal-input">
                </div>
                <div class="form-group">
                    <label>Описание</label>
                    <textarea id="modalDirectionDescription" placeholder="Подробное описание направления..." rows="4" class="modal-input">${direction ? direction.description : ''}</textarea>
                </div>
                <div class="form-group">
                    <label>Преимущества (каждое с новой строки)</label>
                    <textarea id="modalDirectionFeatures" placeholder="Развитие гибкости
Улучшение координации
Развитие музыкальности" rows="4" class="modal-input">${direction && direction.features ? direction.features.join('\n') : ''}</textarea>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="modalDirectionFeatured" ${direction && direction.featured ? 'checked' : ''}>
                        Сделать рекомендуемым направлением
                    </label>
                </div>
            `;
            
            const footer = `
                <button class="btn btn-success" onclick="saveDirection()">
                    <i class="fas fa-save"></i> ${index >= 0 ? 'Сохранить' : 'Добавить'}
                </button>
                ${index >= 0 ? `
                <button class="btn btn-danger" onclick="removeDirection(${index}); closeModal();">
                    <i class="fas fa-trash"></i> Удалить
                </button>
                ` : ''}
                <button class="btn" onclick="closeModal()">
                    <i class="fas fa-times"></i> Отмена
                </button>
            `;
            
            showModal(title, content, footer);
        }
        
        function editDirection(index) {
            showDirectionModal(index);
        }
        
        function saveDirection() {
            const title = document.getElementById('modalDirectionTitle').value.trim();
            if (!title) {
                showStatus('Введите название направления', 'error');
                return;
            }
            
            const featuresText = document.getElementById('modalDirectionFeatures').value;
            const features = featuresText.split('\n').map(f => f.trim()).filter(f => f);
            
            const directionData = {
                id: editingItem.index >= 0 ? currentData.directions[editingItem.index].id : 'direction-' + Date.now(),
                title: title,
                age: document.getElementById('modalDirectionAge').value,
                price: document.getElementById('modalDirectionPrice').value,
                schedule: document.getElementById('modalDirectionSchedule').value,
                description: document.getElementById('modalDirectionDescription').value,
                features: features,
                featured: document.getElementById('modalDirectionFeatured').checked
            };
            
            if (editingItem.index >= 0) {
                currentData.directions[editingItem.index] = directionData;
            } else {
                currentData.directions.push(directionData);
            }
            
            updateDirectionsSection();
            updateCounters();
            closeModal();
            showStatus('Направление сохранено', 'success');
        }
        
        function removeDirection(index) {
            if (confirm('Удалить это направление?')) {
                currentData.directions.splice(index, 1);
                updateDirectionsSection();
                updateCounters();
                showStatus('Направление удалено', 'success');
            }
        }
        
        function importDemoDirections() {
            const demoDirections = [
                {
                    id: 'baby-dance',
                    title: 'Танец-игра / Ритмика',
                    age: '3-7 лет',
                    schedule: 'Понедельник и среда в 17:00',
                    price: 'Пробное занятие: 300₽',
                    description: 'Развитие чувства ритма, координации и любви к движению через веселые игры и простые танцевальные комбинации.',
                    features: ['Игровая форма', 'Развитие ритма', 'Координация', 'Гибкость']
                }
            ];
            
            currentData.directions = [...currentData.directions, ...demoDirections];
            updateDirectionsSection();
            updateCounters();
            showStatus('Демо-направления добавлены', 'success');
        }
        
        function clearDirections() {
            if (currentData.directions.length === 0) {
                showStatus('Нет направлений для очистки', 'warning');
                return;
            }
            
            if (confirm('Очистить все направления? Это действие нельзя отменить.')) {
                currentData.directions = [];
                updateDirectionsSection();
                updateCounters();
                showStatus('Все направления очищены', 'success');
            }
        }
        
        function saveDirections() {
            saveAllData();
            showStatus('Направления сохранены', 'success');
        }
        
        // === РАСПИСАНИЕ (С 30-МИНУТНЫМИ ИНТЕРВАЛАМИ) ===
        function updateScheduleSection() {
            updateScheduleDays();
            updateScheduleTable();
            updateScheduleEmptyState();
        }
        
        function updateScheduleDays() {
            const days = [
                { id: 'all', name: 'Все дни' },
                { id: 'monday', name: 'Понедельник' },
                { id: 'tuesday', name: 'Вторник' },
                { id: 'wednesday', name: 'Среда' },
                { id: 'thursday', name: 'Четверг' },
                { id: 'friday', name: 'Пятница' },
                { id: 'saturday', name: 'Суббота' },
                { id: 'sunday', name: 'Воскресенье' }
            ];
            
            const container = document.getElementById('scheduleDays');
            container.innerHTML = '';
            
            days.forEach(day => {
                const count = day.id === 'all' 
                    ? currentData.schedule.length 
                    : currentData.schedule.filter(item => item.day === day.id).length;
                
                const div = document.createElement('div');
                div.className = `schedule-day ${currentScheduleDay === day.id ? 'active' : ''}`;
                div.innerHTML = `
                    ${day.name}
                    <span style="font-size: 12px; background: rgba(255,255,255,0.2); padding: 1px 6px; border-radius: 10px; margin-left: 5px;">${count}</span>
                `;
                div.onclick = () => filterScheduleByDay(day.id);
                container.appendChild(div);
            });
        }
        
        function filterScheduleByDay(dayId) {
            currentScheduleDay = dayId;
            updateScheduleDays();
            updateScheduleTable();
        }
        
        function showAllDays() {
            filterScheduleByDay('all');
        }
        
        function showTodaySchedule() {
            const days = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
            const today = new Date().getDay();
            const todayId = days[today];
            filterScheduleByDay(todayId);
        }
        
        function updateScheduleTable() {
            const container = document.getElementById('scheduleTableContainer');
            const empty = document.getElementById('emptySchedule');
            
            let filteredSchedule = currentData.schedule;
            if (currentScheduleDay !== 'all') {
                filteredSchedule = currentData.schedule.filter(item => item.day === currentScheduleDay);
            }
            
            if (filteredSchedule.length === 0) {
                container.innerHTML = '';
                empty.style.display = 'block';
                return;
            }
            
            empty.style.display = 'none';
            
            filteredSchedule.sort((a, b) => {
                const timeA = a.time.replace(':', '');
                const timeB = b.time.replace(':', '');
                return timeA - timeB;
            });
            
            const timeSlots = [...new Set(filteredSchedule.map(item => item.time))].sort();
            
            let html = `
                <table class="schedule-table">
                    <thead>
                        <tr>
                            <th>Время</th>
                            <th>Направление / Группа</th>
                            <th>Возраст</th>
                            <th>Преподаватель</th>
                            <th>Зал</th>
                            <th>Действия</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            timeSlots.forEach(timeSlot => {
                const items = filteredSchedule.filter(item => item.time === timeSlot);
                
                items.forEach((item, index) => {
                    const isFirst = index === 0;
                    const rowSpan = items.length;
                    
                    html += `
                        <tr>
                            ${isFirst ? `<td rowspan="${rowSpan}" style="font-weight: bold; font-size: 16px;">${item.time}</td>` : ''}
                            <td>
                                <div class="schedule-item ${item.isHighlighted ? 'schedule-item-highlight' : ''}">
                                    <div class="schedule-direction">${item.direction}</div>
                                    <div class="schedule-time">${item.duration} минут</div>
                                    <div class="schedule-actions">
                                        <button class="schedule-action-btn edit-schedule" onclick="editScheduleItem('${item.id}')">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="schedule-action-btn delete-schedule" onclick="removeScheduleItem('${item.id}')">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            </td>
                            <td>
                                <span class="schedule-age">${item.age}</span>
                            </td>
                            <td>
                                <div class="schedule-instructor">${item.instructor}</div>
                            </td>
                            <td>
                                ${item.room}
                                ${item.maxParticipants ? `<br><small>до ${item.maxParticipants} чел.</small>` : ''}
                            </td>
                            ${isFirst ? `<td rowspan="${rowSpan}">
                                <button class="btn btn-small btn-primary" onclick="editScheduleItem('${item.id}')">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-small btn-danger" onclick="removeScheduleItem('${item.id}')">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </td>` : ''}
                        </tr>
                    `;
                });
            });
            
            html += `
                    </tbody>
                </table>
            `;
            
            container.innerHTML = html;
        }
        
        function updateScheduleEmptyState() {
            const empty = document.getElementById('emptySchedule');
            if (currentData.schedule.length === 0) {
                empty.style.display = 'block';
            } else {
                empty.style.display = 'none';
            }
        }
        
        // === ОСНОВНАЯ ФУНКЦИЯ ДОБАВЛЕНИЯ РАСПИСАНИЯ С 30-МИНУТНЫМИ ИНТЕРВАЛАМИ ===
        function showScheduleModal(index = -1) {
            editingItem = { type: 'schedule', index: index };
            
            let scheduleItem;
            if (typeof index === 'number' && index >= 0) {
                scheduleItem = currentData.schedule[index];
            } else if (typeof index === 'string') {
                const itemIndex = currentData.schedule.findIndex(item => item.id === index);
                if (itemIndex >= 0) {
                    scheduleItem = currentData.schedule[itemIndex];
                    editingItem.index = itemIndex;
                }
            }
            
            const title = scheduleItem ? '<i class="fas fa-edit"></i> Редактировать занятие' : '<i class="fas fa-plus"></i> Добавить занятие';
            
            const directionOptions = currentData.directions.map(dir => 
                `<option value="${dir.title}" ${scheduleItem && scheduleItem.direction === dir.title ? 'selected' : ''}>${dir.title}</option>`
            ).join('');
            
            const instructorOptions = currentData.team.map(member => 
                `<option value="${member.name}" ${scheduleItem && scheduleItem.instructor === member.name ? 'selected' : ''}>${member.name}</option>`
            ).join('');
            
            // === ВРЕМЕННЫЕ СЛОТЫ С ИНТЕРВАЛОМ 30 МИНУТ ===
            const timeSlots = [];
            for (let hour = 7; hour <= 21; hour++) {
                for (let minute = 0; minute < 60; minute += 30) {
                    const hourStr = hour.toString().padStart(2, '0');
                    const minuteStr = minute.toString().padStart(2, '0');
                    timeSlots.push(`${hourStr}:${minuteStr}`);
                }
            }
            
            if (timeSlots[timeSlots.length - 1] === '21:30') {
                timeSlots.pop();
            }
            
            const timeOptions = timeSlots.map(time => 
                `<option value="${time}" ${scheduleItem && scheduleItem.time === time ? 'selected' : ''}>${time}</option>`
            ).join('');
            // === КОНЕЦ 30-МИНУТНЫХ ИНТЕРВАЛОВ ===
            
            const content = `
                <div class="form-row">
                    <div class="form-group">
                        <label>День недели *</label>
                        <select id="modalScheduleDay" class="modal-input">
                            <option value="monday" ${scheduleItem && scheduleItem.day === 'monday' ? 'selected' : ''}>Понедельник</option>
                            <option value="tuesday" ${scheduleItem && scheduleItem.day === 'tuesday' ? 'selected' : ''}>Вторник</option>
                            <option value="wednesday" ${scheduleItem && scheduleItem.day === 'wednesday' ? 'selected' : ''}>Среда</option>
                            <option value="thursday" ${scheduleItem && scheduleItem.day === 'thursday' ? 'selected' : ''}>Четверг</option>
                            <option value="friday" ${scheduleItem && scheduleItem.day === 'friday' ? 'selected' : ''}>Пятница</option>
                            <option value="saturday" ${scheduleItem && scheduleItem.day === 'saturday' ? 'selected' : ''}>Суббота</option>
                            <option value="sunday" ${scheduleItem && scheduleItem.day === 'sunday' ? 'selected' : ''}>Воскресенье</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Время начала *</label>
                        <select id="modalScheduleTime" class="modal-input">
                            ${timeOptions}
                        </select>
                        <div style="font-size: 12px; color: #666; margin-top: 5px;">
                            Доступны интервалы по 30 минут с 9:00 до 21:00
                        </div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Продолжительность *</label>
                        <select id="modalScheduleDuration" class="modal-input">
                            <option value="30" ${scheduleItem && scheduleItem.duration === '30' ? 'selected' : ''}>30 минут</option>
                            <option value="45" ${scheduleItem && scheduleItem.duration === '45' ? 'selected' : ''}>45 минут</option>
                            <option value="60" ${scheduleItem && scheduleItem.duration === '60' ? 'selected' : ''}>60 минут</option>
                            <option value="90" ${scheduleItem && scheduleItem.duration === '90' ? 'selected' : ''}>90 минут</option>
                            <option value="120" ${scheduleItem && scheduleItem.duration === '120' ? 'selected' : ''}>120 минут</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Макс. участников</label>
                        <input type="number" id="modalScheduleMaxParticipants" value="${scheduleItem ? scheduleItem.maxParticipants : '15'}" class="modal-input" min="1" max="50">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Направление *</label>
                    <select id="modalScheduleDirection" class="modal-input">
                        <option value="">Выберите направление</option>
                        ${directionOptions}
                        <option value="custom">Другое (ввести вручную)</option>
                    </select>
                    <input type="text" id="modalScheduleDirectionCustom" 
                           value="${scheduleItem && !currentData.directions.some(d => d.title === scheduleItem.direction) ? scheduleItem.direction : ''}" 
                           placeholder="Введите название направления" 
                           class="modal-input" 
                           style="margin-top: 10px; display: ${scheduleItem && !currentData.directions.some(d => d.title === scheduleItem.direction) ? 'block' : 'none'}">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Возрастная группа *</label>
                        <input type="text" id="modalScheduleAge" value="${scheduleItem ? scheduleItem.age : ''}" placeholder="3-7 лет" class="modal-input">
                    </div>
                    <div class="form-group">
                        <label>Преподаватель</label>
                        <select id="modalScheduleInstructor" class="modal-input">
                            <option value="">Выберите преподавателя</option>
                            ${instructorOptions}
                            <option value="custom">Другой (ввести вручную)</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Зал / Помещение</label>
                        <input type="text" id="modalScheduleRoom" value="${scheduleItem ? scheduleItem.room : 'Зал №1'}" placeholder="Зал №1" class="modal-input">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="modalScheduleHighlighted" ${scheduleItem && scheduleItem.isHighlighted ? 'checked' : ''}>
                        Выделить это занятие (рекомендованное / популярное)
                    </label>
                </div>
                
                <div class="form-group">
                    <label>Примечание</label>
                    <textarea id="modalScheduleNote" placeholder="Дополнительная информация..." rows="2" class="modal-input">${scheduleItem ? scheduleItem.note || '' : ''}</textarea>
                </div>
            `;
            
            const footer = `
                <button class="btn btn-success" onclick="saveScheduleItem()">
                    <i class="fas fa-save"></i> ${scheduleItem ? 'Сохранить' : 'Добавить'}
                </button>
                ${scheduleItem ? `
                <button class="btn btn-danger" onclick="removeScheduleItem('${scheduleItem.id}'); closeModal();">
                    <i class="fas fa-trash"></i> Удалить
                </button>
                ` : ''}
                <button class="btn" onclick="closeModal()">
                    <i class="fas fa-times"></i> Отмена
                </button>
            `;
            
            showModal(title, content, footer);
            
            document.getElementById('modalScheduleDirection').addEventListener('change', function() {
                const customInput = document.getElementById('modalScheduleDirectionCustom');
                if (this.value === 'custom') {
                    customInput.style.display = 'block';
                    customInput.required = true;
                } else {
                    customInput.style.display = 'none';
                    customInput.required = false;
                }
            });
            
            document.getElementById('modalScheduleInstructor').addEventListener('change', function() {
                if (this.value === 'custom') {
                    const instructorGroup = this.closest('.form-group');
                    const customInput = document.createElement('input');
                    customInput.type = 'text';
                    customInput.id = 'modalScheduleInstructorCustom';
                    customInput.className = 'modal-input';
                    customInput.style.marginTop = '10px';
                    customInput.placeholder = 'Введите имя преподавателя';
                    customInput.required = true;
                    
                    if (!document.getElementById('modalScheduleInstructorCustom')) {
                        instructorGroup.appendChild(customInput);
                    }
                } else {
                    const customInput = document.getElementById('modalScheduleInstructorCustom');
                    if (customInput) {
                        customInput.remove();
                    }
                }
            });
        }
        
        // === ФУНКЦИЯ БЫСТРОГО ДОБАВЛЕНИЯ ПО ВРЕМЕНИ ===
        function showQuickTimeSlotsModal() {
            const title = '<i class="fas fa-clock"></i> Быстрое добавление по времени';
            
            const timeSlots = [];
            for (let hour = 9; hour <= 21; hour++) {
                for (let minute = 0; minute < 60; minute += 30) {
                    const hourStr = hour.toString().padStart(2, '0');
                    const minuteStr = minute.toString().padStart(2, '0');
                    timeSlots.push(`${hourStr}:${minuteStr}`);
                }
            }
            
            if (timeSlots[timeSlots.length - 1] === '21:30') {
                timeSlots.pop();
            }
            
            const columns = 3;
            const perColumn = Math.ceil(timeSlots.length / columns);
            let timeSlotsHTML = '<div class="form-row">';
            
            for (let col = 0; col < columns; col++) {
                timeSlotsHTML += '<div class="form-group" style="flex: 1;">';
                const start = col * perColumn;
                const end = Math.min(start + perColumn, timeSlots.length);
                
                for (let i = start; i < end; i++) {
                    const time = timeSlots[i];
                    timeSlotsHTML += `
                        <div class="time-slot" onclick="selectTimeSlot('${time}')">
                            ${time}
                        </div>
                    `;
                }
                timeSlotsHTML += '</div>';
            }
            
            timeSlotsHTML += '</div>';
            
            const content = `
                <div class="form-group">
                    <label>Выберите день недели</label>
                    <select id="quickDay" class="modal-input">
                        <option value="monday">Понедельник</option>
                        <option value="tuesday">Вторник</option>
                        <option value="wednesday">Среда</option>
                        <option value="thursday">Четверг</option>
                        <option value="friday">Пятница</option>
                        <option value="saturday">Суббота</option>
                        <option value="sunday">Воскресенье</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Выберите время начала (интервал 30 минут)</label>
                    ${timeSlotsHTML}
                    <div style="font-size: 12px; color: #666; margin-top: 10px;">
                        Нажмите на временной слот для выбора
                    </div>
                </div>
                
                <div id="selectedTimeInfo" style="display: none; background: rgba(52, 152, 219, 0.1); padding: 15px; border-radius: 10px; margin-top: 15px;">
                    <h4>Выбрано время: <span id="selectedTimeDisplay"></span></h4>
                    <p>Нажмите "Продолжить", чтобы заполнить остальные данные</p>
                </div>
            `;
            
            const footer = `
                <button class="btn btn-primary" id="continueBtn" disabled onclick="continueWithSelectedTime()">
                    <i class="fas fa-arrow-right"></i> Продолжить
                </button>
                <button class="btn" onclick="closeModal()">
                    <i class="fas fa-times"></i> Отмена
                </button>
            `;
            
            showModal(title, content, footer);
        }
        
        function selectTimeSlot(time) {
            selectedQuickTime = time;
            
            document.querySelectorAll('.time-slot').forEach(slot => {
                slot.classList.remove('selected');
            });
            
            const selectedSlot = Array.from(document.querySelectorAll('.time-slot')).find(slot => 
                slot.textContent.trim() === time
            );
            if (selectedSlot) {
                selectedSlot.classList.add('selected');
            }
            
            document.getElementById('selectedTimeDisplay').textContent = time;
            document.getElementById('selectedTimeInfo').style.display = 'block';
            document.getElementById('continueBtn').disabled = false;
        }
        
        function continueWithSelectedTime() {
            if (!selectedQuickTime) return;
            
            const day = document.getElementById('quickDay').value;
            closeModal();
            
            editingItem = { type: 'schedule', index: -1 };
            
            const dayNames = {
                monday: 'Понедельник',
                tuesday: 'Вторник',
                wednesday: 'Среда',
                thursday: 'Четверг',
                friday: 'Пятница',
                saturday: 'Суббота',
                sunday: 'Воскресенье'
            };
            
            const directionOptions = currentData.directions.map(dir => 
                `<option value="${dir.title}">${dir.title}</option>`
            ).join('');
            
            const instructorOptions = currentData.team.map(member => 
                `<option value="${member.name}">${member.name}</option>`
            ).join('');
            
            const timeSlots = [];
            for (let hour = 7; hour <= 21; hour++) {
                for (let minute = 0; minute < 60; minute += 30) {
                    const hourStr = hour.toString().padStart(2, '0');
                    const minuteStr = minute.toString().padStart(2, '0');
                    timeSlots.push(`${hourStr}:${minuteStr}`);
                }
            }
            
            if (timeSlots[timeSlots.length - 1] === '21:30') {
                timeSlots.pop();
            }
            
            const timeOptions = timeSlots.map(time => 
                `<option value="${time}" ${time === selectedQuickTime ? 'selected' : ''}>${time}</option>`
            ).join('');
            
            const content = `
                <div class="info-box">
                    <div class="info-box-title">
                        <i class="fas fa-info-circle"></i> Быстрое добавление
                    </div>
                    <div class="info-box-content">
                        <p>Вы выбрали: <strong>${dayNames[day]}, ${selectedQuickTime}</strong></p>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>День недели *</label>
                        <select id="modalScheduleDay" class="modal-input">
                            <option value="monday" ${day === 'monday' ? 'selected' : ''}>Понедельник</option>
                            <option value="tuesday" ${day === 'tuesday' ? 'selected' : ''}>Вторник</option>
                            <option value="wednesday" ${day === 'wednesday' ? 'selected' : ''}>Среда</option>
                            <option value="thursday" ${day === 'thursday' ? 'selected' : ''}>Четверг</option>
                            <option value="friday" ${day === 'friday' ? 'selected' : ''}>Пятница</option>
                            <option value="saturday" ${day === 'saturday' ? 'selected' : ''}>Суббота</option>
                            <option value="sunday" ${day === 'sunday' ? 'selected' : ''}>Воскресенье</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Время начала *</label>
                        <select id="modalScheduleTime" class="modal-input">
                            ${timeOptions}
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Продолжительность *</label>
                        <select id="modalScheduleDuration" class="modal-input">
                            <option value="30">30 минут</option>
                            <option value="45">45 минут</option>
                            <option value="60" selected>60 минут</option>
                            <option value="90">90 минут</option>
                            <option value="120">120 минут</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Макс. участников</label>
                        <input type="number" id="modalScheduleMaxParticipants" value="15" class="modal-input" min="1" max="50">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Направление *</label>
                    <select id="modalScheduleDirection" class="modal-input">
                        <option value="">Выберите направление</option>
                        ${directionOptions}
                        <option value="custom">Другое (ввести вручную)</option>
                    </select>
                    <input type="text" id="modalScheduleDirectionCustom" 
                           placeholder="Введите название направления" 
                           class="modal-input" 
                           style="margin-top: 10px; display: none;">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Возрастная группа *</label>
                        <input type="text" id="modalScheduleAge" placeholder="3-7 лет" class="modal-input">
                    </div>
                    <div class="form-group">
                        <label>Преподаватель</label>
                        <select id="modalScheduleInstructor" class="modal-input">
                            <option value="">Выберите преподавателя</option>
                            ${instructorOptions}
                            <option value="custom">Другой (ввести вручную)</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Зал / Помещение</label>
                        <input type="text" id="modalScheduleRoom" value="Зал №1" placeholder="Зал №1" class="modal-input">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="modalScheduleHighlighted">
                        Выделить это занятие (рекомендованное / популярное)
                    </label>
                </div>
                
                <div class="form-group">
                    <label>Примечание</label>
                    <textarea id="modalScheduleNote" placeholder="Дополнительная информация..." rows="2" class="modal-input"></textarea>
                </div>
            `;
            
            const footer = `
                <button class="btn btn-success" onclick="saveScheduleItem()">
                    <i class="fas fa-save"></i> Добавить
                </button>
                <button class="btn" onclick="closeModal()">
                    <i class="fas fa-times"></i> Отмена
                </button>
            `;
            
            showModal('<i class="fas fa-plus"></i> Добавить занятие', content, footer);
            
            document.getElementById('modalScheduleDirection').addEventListener('change', function() {
                const customInput = document.getElementById('modalScheduleDirectionCustom');
                if (this.value === 'custom') {
                    customInput.style.display = 'block';
                    customInput.required = true;
                } else {
                    customInput.style.display = 'none';
                    customInput.required = false;
                }
            });
            
            document.getElementById('modalScheduleInstructor').addEventListener('change', function() {
                if (this.value === 'custom') {
                    const instructorGroup = this.closest('.form-group');
                    const customInput = document.createElement('input');
                    customInput.type = 'text';
                    customInput.id = 'modalScheduleInstructorCustom';
                    customInput.className = 'modal-input';
                    customInput.style.marginTop = '10px';
                    customInput.placeholder = 'Введите имя преподавателя';
                    customInput.required = true;
                    
                    if (!document.getElementById('modalScheduleInstructorCustom')) {
                        instructorGroup.appendChild(customInput);
                    }
                } else {
                    const customInput = document.getElementById('modalScheduleInstructorCustom');
                    if (customInput) {
                        customInput.remove();
                    }
                }
            });
        }
        
        function editScheduleItem(id) {
            showScheduleModal(id);
        }
        
        function saveScheduleItem() {
            const day = document.getElementById('modalScheduleDay').value;
            const time = document.getElementById('modalScheduleTime').value;
            const duration = document.getElementById('modalScheduleDuration').value;
            
            let direction;
            const directionSelect = document.getElementById('modalScheduleDirection');
            if (directionSelect.value === 'custom') {
                direction = document.getElementById('modalScheduleDirectionCustom').value.trim();
            } else {
                direction = directionSelect.value;
            }
            
            let instructor;
            const instructorSelect = document.getElementById('modalScheduleInstructor');
            if (instructorSelect.value === 'custom') {
                instructor = document.getElementById('modalScheduleInstructorCustom')?.value.trim() || '';
            } else {
                instructor = instructorSelect.value;
            }
            
            if (!day || !time || !duration || !direction) {
                showStatus('Заполните обязательные поля', 'error');
                return;
            }
            
            const dayNames = {
                monday: 'Понедельник',
                tuesday: 'Вторник',
                wednesday: 'Среда',
                thursday: 'Четверг',
                friday: 'Пятница',
                saturday: 'Суббота',
                sunday: 'Воскресенье'
            };
            
            const scheduleData = {
                id: editingItem.index >= 0 ? currentData.schedule[editingItem.index].id : 'schedule-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9),
                day: day,
                dayName: dayNames[day],
                time: time,
                duration: duration,
                direction: direction,
                age: document.getElementById('modalScheduleAge').value,
                instructor: instructor,
                room: document.getElementById('modalScheduleRoom').value,
                maxParticipants: document.getElementById('modalScheduleMaxParticipants').value,
                isHighlighted: document.getElementById('modalScheduleHighlighted').checked,
                note: document.getElementById('modalScheduleNote').value
            };
            
            if (editingItem.index >= 0) {
                currentData.schedule[editingItem.index] = scheduleData;
            } else {
                currentData.schedule.push(scheduleData);
            }
            
            currentData.schedule.sort((a, b) => {
                const dayOrder = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
                const dayCompare = dayOrder.indexOf(a.day) - dayOrder.indexOf(b.day);
                if (dayCompare !== 0) return dayCompare;
                
                const timeA = a.time.replace(':', '');
                const timeB = b.time.replace(':', '');
                return timeA - timeB;
            });
            
            updateScheduleSection();
            updateCounters();
            closeModal();
            showStatus('Занятие сохранено в расписании', 'success');
        }
        
        function removeScheduleItem(id) {
            const index = currentData.schedule.findIndex(item => item.id === id);
            if (index === -1) return;
            
            if (confirm('Удалить это занятие из расписания?')) {
                currentData.schedule.splice(index, 1);
                updateScheduleSection();
                updateCounters();
                showStatus('Занятие удалено из расписания', 'success');
            }
        }
        
        function importDemoSchedule() {
            const demoSchedule = [
                {
                    id: 'demo1',
                    day: 'monday',
                    dayName: 'Понедельник',
                    time: '17:00',
                    duration: '60',
                    direction: 'Танец-игра / Ритмика',
                    age: '3-7 лет',
                    instructor: 'Анна Петрова',
                    room: 'Зал №1',
                    maxParticipants: '12',
                    isHighlighted: true
                },
                {
                    id: 'demo2',
                    day: 'wednesday',
                    dayName: 'Среда',
                    time: '17:00',
                    duration: '60',
                    direction: 'Танец-игра / Ритмика',
                    age: '3-7 лет',
                    instructor: 'Анна Петрова',
                    room: 'Зал №1',
                    maxParticipants: '12',
                    isHighlighted: true
                },
                {
                    id: 'demo3',
                    day: 'friday',
                    dayName: 'Пятница',
                    time: '16:30',
                    duration: '90',
                    direction: 'Классическая хореография',
                    age: '8-12 лет',
                    instructor: 'Ирина Ковалева',
                    room: 'Зал №1',
                    maxParticipants: '10',
                    isHighlighted: false
                }
            ];
            
            currentData.schedule = [...currentData.schedule, ...demoSchedule];
            updateScheduleSection();
            updateCounters();
            showStatus('Демо-расписание добавлено', 'success');
        }
        
        function clearSchedule() {
            if (currentData.schedule.length === 0) {
                showStatus('Расписание уже пусто', 'warning');
                return;
            }
            
            if (confirm('Очистить всё расписание? Это действие нельзя отменить.')) {
                currentData.schedule = [];
                updateScheduleSection();
                updateCounters();
                showStatus('Расписание очищено', 'success');
            }
        }
        
        function saveSchedule() {
            saveAllData();
            showStatus('Расписание сохранено', 'success');
        }
        
        function printSchedule() {
            const printWindow = window.open('', '_blank');
            const printContent = `
                <html>
                <head>
                    <title>Расписание - ${currentData.main.studioName}</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 20px; }
                        h1 { color: #E67E22; text-align: center; }
                        .schedule-print { width: 100%; border-collapse: collapse; margin-top: 20px; }
                        .schedule-print th { background: #E67E22; color: white; padding: 10px; text-align: center; }
                        .schedule-print td { padding: 10px; border: 1px solid #ddd; text-align: center; }
                        .highlight { background: #FFF8F0; font-weight: bold; }
                        .day-header { background: #f5f5f5; font-weight: bold; padding: 15px; text-align: center; }
                        @media print {
                            body { padding: 10px; }
                            .no-print { display: none; }
                        }
                    </style>
                </head>
                <body>
                    <h1>Расписание занятий<br>${currentData.main.studioName}</h1>
                    <p style="text-align: center;">${currentData.main.address}<br>Тел: ${currentData.main.phone}</p>
                    <p style="text-align: center; color: #666;">Распечатано: ${new Date().toLocaleDateString('ru-RU')}</p>
                    
                    ${generateSchedulePrintTable()}
                    
                    <div style="margin-top: 30px; text-align: center; font-size: 12px; color: #888;" class="no-print">
                        <button onclick="window.print()">Распечатать</button>
                        <button onclick="window.close()">Закрыть</button>
                    </div>
                </body>
                </html>
            `;
            
            printWindow.document.write(printContent);
            printWindow.document.close();
        }
        
        function generateSchedulePrintTable() {
            const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
            const dayNames = {
                monday: 'Понедельник',
                tuesday: 'Вторник',
                wednesday: 'Среда',
                thursday: 'Четверг',
                friday: 'Пятница',
                saturday: 'Суббота',
                sunday: 'Воскресенье'
            };
            
            let html = '';
            
            days.forEach(day => {
                const daySchedule = currentData.schedule.filter(item => item.day === day);
                if (daySchedule.length === 0) return;
                
                daySchedule.sort((a, b) => {
                    const timeA = a.time.replace(':', '');
                    const timeB = b.time.replace(':', '');
                    return timeA - timeB;
                });
                
                html += `
                    <div class="day-header">${dayNames[day]}</div>
                    <table class="schedule-print">
                        <thead>
                            <tr>
                                <th>Время</th>
                                <th>Направление</th>
                                <th>Возраст</th>
                                <th>Преподаватель</th>
                                <th>Зал</th>
                                <th>Длительность</th>
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                daySchedule.forEach(item => {
                    html += `
                        <tr ${item.isHighlighted ? 'class="highlight"' : ''}>
                            <td>${item.time}</td>
                            <td>${item.direction}</td>
                            <td>${item.age}</td>
                            <td>${item.instructor}</td>
                            <td>${item.room}</td>
                            <td>${item.duration} мин</td>
                        </tr>
                    `;
                });
                
                html += `
                        </tbody>
                    </table>
                    <br>
                `;
            });
            
            return html;
        }
        
        function exportSchedule() {
            showStatus('Экспорт в PDF доступен в полной версии редактора', 'info');
        }
        
        // === ОСТАЛЬНЫЕ РАЗДЕЛЫ (сокращены для экономии места) ===
        function updatePricesSection() {
            const container = document.getElementById('pricesList');
            container.innerHTML = '';
            
            if (currentData.prices.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #666;">
                        <i class="fas fa-tags" style="font-size: 48px; margin-bottom: 20px; opacity: 0.3;"></i>
                        <h3>Нет тарифов</h3>
                        <p>Добавьте тарифные планы для вашей студии</p>
                    </div>
                `;
                return;
            }
            
            currentData.prices.forEach((price, index) => {
                const div = document.createElement('div');
                div.className = 'item';
                div.innerHTML = `
                    <div class="item-info">
                        <h4>
                            <i class="fas fa-tag"></i>
                            ${price.title || 'Новый тариф'}
                            ${price.featured ? ' <span style="color: var(--warning);">🔥 Популярный</span>' : ''}
                        </h4>
                        <p>${price.subtitle || ''}</p>
                        <p style="font-size: 24px; font-weight: bold; color: var(--primary); margin: 5px 0;">
                            ${price.price || '0₽'}
                            <span style="font-size: 14px; color: #666;">/ ${price.period || 'месяц'}</span>
                        </p>
                        <ul style="font-size: 12px; color: #666; margin-top: 10px; padding-left: 20px;">
                            ${(price.features || []).slice(0, 3).map(f => `<li>${f}</li>`).join('')}
                            ${(price.features || []).length > 3 ? '<li>...</li>' : ''}
                        </ul>
                    </div>
                    <div class="item-actions">
                        <button class="btn btn-primary btn-small" onclick="editPrice(${index})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-danger btn-small" onclick="removePrice(${index})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                container.appendChild(div);
            });
        }
        
        function showPriceModal(index = -1) {
            editingItem = { type: 'price', index: index };
            let price = index >= 0 ? currentData.prices[index] : null;
            
            const title = index >= 0 ? '<i class="fas fa-edit"></i> Редактировать тариф' : '<i class="fas fa-plus"></i> Добавить тариф';
            
            const content = `
                <div class="form-group">
                    <label>Название тарифа *</label>
                    <input type="text" id="modalPriceTitle" value="${price ? price.title : ''}" placeholder="ПРОБНОЕ ЗАНЯТИЕ" class="modal-input">
                </div>
                <div class="form-group">
                    <label>Подзаголовок</label>
                    <input type="text" id="modalPriceSubtitle" value="${price ? price.subtitle : ''}" placeholder="Любое направление" class="modal-input">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Цена *</label>
                        <input type="text" id="modalPricePrice" value="${price ? price.price : ''}" placeholder="300₽" class="modal-input">
                    </div>
                    <div class="form-group">
                        <label>Период</label>
                        <input type="text" id="modalPricePeriod" value="${price ? price.period : ''}" placeholder="1 занятие" class="modal-input">
                    </div>
                </div>
                <div class="form-group">
                    <label>Преимущества (каждое с новой строки)</label>
                    <textarea id="modalPriceFeatures" placeholder="Первое занятие
Консультация педагога
Подбор направления
Подарок при покупке абонемента" rows="4" class="modal-input">${price && price.features ? price.features.join('\n') : ''}</textarea>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="modalPriceFeatured" ${price && price.featured ? 'checked' : ''}>
                        Сделать рекомендуемым тарифом
                    </label>
                </div>
            `;
            
            const footer = `
                <button class="btn btn-success" onclick="savePrice()">
                    <i class="fas fa-save"></i> ${index >= 0 ? 'Сохранить' : 'Добавить'}
                </button>
                ${index >= 0 ? `
                <button class="btn btn-danger" onclick="removePrice(${index}); closeModal();">
                    <i class="fas fa-trash"></i> Удалить
                </button>
                ` : ''}
                <button class="btn" onclick="closeModal()">
                    <i class="fas fa-times"></i> Отмена
                </button>
            `;
            
            showModal(title, content, footer);
        }
        
        function editPrice(index) {
            showPriceModal(index);
        }
        
        function savePrice() {
            const title = document.getElementById('modalPriceTitle').value.trim();
            const price = document.getElementById('modalPricePrice').value.trim();
            
            if (!title || !price) {
                showStatus('Заполните обязательные поля', 'error');
                return;
            }
            
            const featuresText = document.getElementById('modalPriceFeatures').value;
            const features = featuresText.split('\n').map(f => f.trim()).filter(f => f);
            
            const priceData = {
                title: title,
                subtitle: document.getElementById('modalPriceSubtitle').value,
                price: price,
                period: document.getElementById('modalPricePeriod').value,
                features: features,
                featured: document.getElementById('modalPriceFeatured').checked
            };
            
            if (editingItem.index >= 0) {
                currentData.prices[editingItem.index] = priceData;
            } else {
                currentData.prices.push(priceData);
            }
            
            updatePricesSection();
            updateCounters();
            closeModal();
            showStatus('Тариф сохранен', 'success');
        }
        
        function removePrice(index) {
            if (confirm('Удалить этот тариф?')) {
                currentData.prices.splice(index, 1);
                updatePricesSection();
                updateCounters();
                showStatus('Тариф удалён', 'success');
            }
        }
        
        function sortPricesByPrice() {
            currentData.prices.sort((a, b) => {
                const priceA = parseInt(a.price.replace(/[^\d]/g, '')) || 0;
                const priceB = parseInt(b.price.replace(/[^\d]/g, '')) || 0;
                return priceA - priceB;
            });
            
            updatePricesSection();
            showStatus('Тарифы отсортированы по цене', 'success');
        }
        
        function savePrices() {
            saveAllData();
            showStatus('Цены сохранены', 'success');
        }
        
        // === ТЕАМ, ГАЛЕРЕЯ, ОТЗЫВЫ, НОВОСТИ, FAQ (сокращены) ===
        function updateTeamSection() {
            const container = document.getElementById('teamList');
            container.innerHTML = '';
            
            if (currentData.team.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #666;">
                        <i class="fas fa-users" style="font-size: 48px; margin-bottom: 20px; opacity: 0.3;"></i>
                        <h3>Нет участников</h3>
                        <p>Добавьте преподавателей вашей студии</p>
                    </div>
                `;
                return;
            }
            
            currentData.team.forEach((member, index) => {
                const div = document.createElement('div');
                div.className = 'item';
                div.innerHTML = `
                    <div class="item-info">
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <div style="width: 60px; height: 60px; background: linear-gradient(135deg, var(--primary), var(--secondary)); 
                                        border-radius: 50%; display: flex; align-items: center; justify-content: center; 
                                        color: white; font-weight: bold; font-size: 20px;">
                                ${member.initials || '??'}
                            </div>
                            <div>
                                <h4>${member.name || 'Новый преподаватель'}</h4>
                                <p>
                                    <span style="color: var(--primary); font-weight: 600;">${member.role || ''}</span>
                                    <span style="margin-left: 10px; font-size: 12px; color: #666;">
                                        <i class="fas fa-history"></i> Опыт: ${member.experience || 'Не указан'}
                                    </span>
                                </p>
                                <p style="font-size: 12px; color: #888; margin-top: 5px;">
                                    ${member.description || ''}
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="item-actions">
                        <button class="btn btn-primary btn-small" onclick="editTeamMember(${index})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-danger btn-small" onclick="removeTeamMember(${index})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                container.appendChild(div);
            });
        }
        
        function showTeamModal(index = -1) {
            editingItem = { type: 'team', index: index };
            let member = index >= 0 ? currentData.team[index] : null;
            
            const title = index >= 0 ? '<i class="fas fa-edit"></i> Редактировать преподавателя' : '<i class="fas fa-plus"></i> Добавить преподавателя';
            
            const initials = member ? member.initials : 'НП';
            const avatarColor = member ? getAvatarColor(member.name) : 'linear-gradient(135deg, var(--primary), var(--secondary))';
            
            const content = `
                <div style="text-align: center; margin-bottom: 20px;">
                    <div class="teacher-avatar" style="background: ${avatarColor};">
                        ${initials}
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Имя и фамилия *</label>
                        <input type="text" id="modalTeamName" value="${member ? member.name : ''}" placeholder="Анна Петрова" class="modal-input" oninput="updateTeamAvatar()">
                    </div>
                    <div class="form-group">
                        <label>Должность *</label>
                        <input type="text" id="modalTeamRole" value="${member ? member.role : ''}" placeholder="Главный хореограф" class="modal-input">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Опыт работы</label>
                        <input type="text" id="modalTeamExperience" value="${member ? member.experience : ''}" placeholder="14 лет" class="modal-input">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Описание</label>
                    <textarea id="modalTeamDescription" placeholder="Профессиональный хореограф с международным опытом. Ученики - победители всероссийских конкурсов." rows="4" class="modal-input">${member ? member.description : ''}</textarea>
                </div>
            `;
            
            const footer = `
                <button class="btn btn-success" onclick="saveTeamMember()">
                    <i class="fas fa-save"></i> ${index >= 0 ? 'Сохранить' : 'Добавить'}
                </button>
                ${index >= 0 ? `
                <button class="btn btn-danger" onclick="removeTeamMember(${index}); closeModal();">
                    <i class="fas fa-trash"></i> Удалить
                </button>
                ` : ''}
                <button class="btn" onclick="closeModal()">
                    <i class="fas fa-times"></i> Отмена
                </button>
            `;
            
            showModal(title, content, footer);
        }
        
        function getAvatarColor(name) {
            const colors = [
                'linear-gradient(135deg, var(--primary), var(--secondary))',
                'linear-gradient(135deg, var(--info), #3498DB)',
                'linear-gradient(135deg, var(--success), #2ECC71)',
                'linear-gradient(135deg, var(--purple), #8E44AD)',
                'linear-gradient(135deg, var(--warning), #F39C12)'
            ];
            
            if (!name) return colors[0];
            const hash = name.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
            return colors[hash % colors.length];
        }
        
        function updateTeamAvatar() {
            const name = document.getElementById('modalTeamName').value;
            if (!name) return;
            
            const nameParts = name.split(' ');
            const initials = (nameParts[0][0] + (nameParts[1] ? nameParts[1][0] : nameParts[0][1] || '')).toUpperCase();
            
            const avatar = document.querySelector('.teacher-avatar');
            if (avatar) {
                avatar.textContent = initials;
                avatar.style.background = getAvatarColor(name);
            }
        }
        
        function editTeamMember(index) {
            showTeamModal(index);
        }
        
        function saveTeamMember() {
            const name = document.getElementById('modalTeamName').value.trim();
            const role = document.getElementById('modalTeamRole').value.trim();
            
            if (!name || !role) {
                showStatus('Заполните обязательные поля', 'error');
                return;
            }
            
            const nameParts = name.split(' ');
            const initials = (nameParts[0][0] + (nameParts[1] ? nameParts[1][0] : nameParts[0][1] || '')).toUpperCase();
            
            const memberData = {
                initials: initials,
                name: name,
                role: role,
                experience: document.getElementById('modalTeamExperience').value,
                description: document.getElementById('modalTeamDescription').value
            };
            
            if (editingItem.index >= 0) {
                currentData.team[editingItem.index] = memberData;
            } else {
                currentData.team.push(memberData);
            }
            
            updateTeamSection();
            updateCounters();
            closeModal();
            showStatus('Преподаватель сохранен', 'success');
        }
        
        function removeTeamMember(index) {
            if (confirm('Удалить этого участника команды?')) {
                currentData.team.splice(index, 1);
                updateTeamSection();
                updateCounters();
                showStatus('Участник команды удалён', 'success');
            }
        }
        
        function saveTeam() {
            saveAllData();
            showStatus('Команда сохранена', 'success');
        }
        
        // === УТИЛИТЫ ===
        function showLoader(text = 'Загрузка...') {
            document.getElementById('loader').classList.add('active');
            document.getElementById('loaderText').textContent = text;
        }
        
        function hideLoader() {
            document.getElementById('loader').classList.remove('active');
        }
        
        function showStatus(message, type = 'success', duration = 3000) {
            const status = document.getElementById('statusMessage');
            status.textContent = message;
            status.className = 'status-message ' + type;
            status.classList.add('show');
            
            setTimeout(() => {
                status.classList.remove('show');
            }, duration);
        }
        
        function previewSite() {
            saveAllData();
            
            showStatus('Сайт готов к просмотру. Данные сохранены.', 'success');
            
            const previewWindow = window.open('', '_blank');
            if (previewWindow) {
                previewWindow.document.write(`
                    <html>
                    <head>
                        <title>Предпросмотр сайта студии</title>
                        <style>
                            body { font-family: Arial, sans-serif; padding: 20px; }
                            .container { max-width: 800px; margin: 0 auto; }
                            .section { margin: 30px 0; padding: 20px; background: #f9f9f9; border-radius: 10px; }
                        </style>
                    </head>
                    <body>
                        <div class="container">
                            <h1>${currentData.main.studioName || 'Студия танцев'}</h1>
                            <p>Это предпросмотр сайта. Данные загружены из редактора.</p>
                            <div class="section">
                                <h2>Основная информация</h2>
                                <p>Телефон: ${currentData.main.phone || 'Не указан'}</p>
                                <p>Адрес: ${currentData.main.address || 'Не указан'}</p>
                                <p>Часы работы: ${currentData.main.workingHours || 'Не указаны'}</p>
                            </div>
                            <div class="section">
                                <h2>Направления (${currentData.directions.length})</h2>
                                <p>Количество направлений: ${currentData.directions.length}</p>
                            </div>
                            <div class="section">
                                <h2>Расписание (${currentData.schedule.length})</h2>
                                <p>Количество занятий в расписании: ${currentData.schedule.length}</p>
                            </div>
                            <div class="section">
                                <h2>Фотогалерея (${currentData.gallery.length})</h2>
                                <p>Количество фото: ${currentData.gallery.length}</p>
                            </div>
                            <button onclick="window.close()">Закрыть предпросмотр</button>
                        </div>
                    </body>
                    </html>
                `);
                previewWindow.document.close();
            }
        }
        
        function updateStats() {
            const totalItems = Object.values(currentData).reduce((sum, section) => {
                if (Array.isArray(section)) return sum + section.length;
                return sum;
            }, 0);
            
            const dataSize = JSON.stringify(currentData).length;
            const dataSizeKB = (dataSize / 1024).toFixed(2);
            
            const lastSaveTime = localStorage.getItem('lastSaveTime');
            const lastSave = lastSaveTime ? new Date(lastSaveTime).toLocaleString('ru-RU') : 'Никогда';
            
            document.getElementById('totalStats').textContent = totalItems;
            document.getElementById('dataSize').textContent = dataSizeKB + ' КБ';
            document.getElementById('lastSave').textContent = lastSave;
        }
        
        function createBackup() {
            const backupData = {
                ...currentData,
                backupDate: new Date().toISOString(),
                version: '1.0'
            };
            
            const dataStr = JSON.stringify(backupData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const fileName = `studio-backup-${new Date().toISOString().slice(0,10)}.json`;
            
            const link = document.createElement('a');
            link.setAttribute('href', dataUri);
            link.setAttribute('download', fileName);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showStatus('Резервная копия создана', 'success');
        }
        
        function restoreBackup() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const backupData = JSON.parse(e.target.result);
                        
                        if (confirm('Восстановить данные из резервной копии? Текущие данные будут заменены.')) {
                            currentData = backupData;
                            updateAllSections();
                            showStatus('Данные восстановлены из резервной копии', 'success');
                        }
                    } catch (error) {
                        showStatus('Ошибка загрузки резервной копии: ' + error.message, 'error');
                    }
                };
                reader.readAsText(file);
            };
            
            input.click();
        }
        
        function exportSelectedData() {
            const exportData = {};
            
            if (document.getElementById('exportMain').checked) exportData.main = currentData.main;
            if (document.getElementById('exportDirections').checked) exportData.directions = currentData.directions;
            if (document.getElementById('exportSchedule').checked) exportData.schedule = currentData.schedule;
            if (document.getElementById('exportPrices').checked) exportData.prices = currentData.prices;
            if (document.getElementById('exportTeam').checked) exportData.team = currentData.team;
            if (document.getElementById('exportPhotos').checked) exportData.gallery = currentData.gallery;
            if (document.getElementById('exportReviews').checked) exportData.reviews = currentData.reviews;
            if (document.getElementById('exportNews').checked) exportData.news = currentData.news;
            if (document.getElementById('exportFAQ').checked) exportData.faq = currentData.faq;
            
            exportData.exportDate = new Date().toISOString();
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const fileName = `studio-export-${new Date().toISOString().slice(0,10)}.json`;
            
            const link = document.createElement('a');
            link.setAttribute('href', dataUri);
            link.setAttribute('download', fileName);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showStatus('Данные экспортированы', 'success');
        }
        
        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const importedData = JSON.parse(e.target.result);
                        
                        if (confirm('Импортировать данные? Текущие данные будут объединены с импортированными.')) {
                            Object.keys(importedData).forEach(key => {
                                if (key === 'main' && importedData.main) {
                                    currentData.main = { ...currentData.main, ...importedData.main };
                                } else if (Array.isArray(currentData[key]) && Array.isArray(importedData[key])) {
                                    currentData[key] = [...currentData[key], ...importedData[key]];
                                }
                            });
                            
                            updateAllSections();
                            showStatus('Данные импортированы', 'success');
                        }
                    } catch (error) {
                        showStatus('Ошибка импорта: ' + error.message, 'error');
                    }
                };
                reader.readAsText(file);
            };
            
            input.click();
        }
        
        function clearAllData() {
            if (confirm('ВНИМАНИЕ: Это удалит ВСЕ данные на сайте! Продолжить?')) {
                localStorage.removeItem('studioData');
                localStorage.removeItem('pendingReviews');
                
                currentData = {
                    main: {
                        studioName: "",
                        phone: "",
                        email: "",
                        address: "",
                        workingHours: "",
                        trialPrice: "",
                        studioDescription: "",
                        socialLinks: []
                    },
                    directions: [],
                    schedule: [],
                    prices: [],
                    team: [],
                    gallery: [],
                    reviews: [],
                    news: [],
                    faq: []
                };
                
                updateAllSections();
                showStatus('Все данные очищены', 'success');
            }
        }
        
        function showDataSummary() {
            const content = `
                <div style="margin: 20px 0;">
                    <h3 style="margin-bottom: 15px;">Статистика данных</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px;">
                        <div style="background: rgba(230, 126, 34, 0.1); padding: 15px; border-radius: 10px;">
                            <div style="font-size: 12px; color: #666;">Направления</div>
                            <div style="font-size: 32px; font-weight: bold; color: var(--primary);">
                                ${currentData.directions.length}
                            </div>
                        </div>
                        <div style="background: rgba(39, 174, 96, 0.1); padding: 15px; border-radius: 10px;">
                            <div style="font-size: 12px; color: #666;">Занятия в расписании</div>
                            <div style="font-size: 32px; font-weight: bold; color: var(--success);">
                                ${currentData.schedule.length}
                            </div>
                        </div>
                        <div style="background: rgba(52, 152, 219, 0.1); padding: 15px; border-radius: 10px;">
                            <div style="font-size: 12px; color: #666;">Тарифы</div>
                            <div style="font-size: 32px; font-weight: bold; color: var(--info);">
                                ${currentData.prices.length}
                            </div>
                        </div>
                        <div style="background: rgba(155, 89, 182, 0.1); padding: 15px; border-radius: 10px;">
                            <div style="font-size: 12px; color: #666;">Команда</div>
                            <div style="font-size: 32px; font-weight: bold; color: var(--purple);">
                                ${currentData.team.length}
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="margin: 20px 0;">
                    <h3 style="margin-bottom: 15px;">Общая статистика</h3>
                    <div style="background: #f9f9f9; padding: 20px; border-radius: 10px;">
                        <div class="form-row">
                            <div style="flex: 1;">
                                <div style="font-size: 12px; color: #666;">Всего элементов</div>
                                <div style="font-size: 24px; font-weight: bold; color: var(--primary);">
                                    ${Object.values(currentData).reduce((sum, section) => Array.isArray(section) ? sum + section.length : sum, 0)}
                                </div>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-size: 12px; color: #666;">Размер данных</div>
                                <div style="font-size: 24px; font-weight: bold; color: var(--info);">
                                    ${(JSON.stringify(currentData).length / 1024).toFixed(2)} КБ
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            const footer = `
                <button class="btn" onclick="closeModal()">
                    <i class="fas fa-times"></i> Закрыть
                </button>
            `;
            
            showModal('<i class="fas fa-chart-bar"></i> Статистика данных', content, footer);
        }
        
        window.onload = function() {
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
                cb.checked = true;
            });
        };
    </script>
</body>
</html>
