<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—É–¥–∏–µ–π —Ç–∞–Ω—Ü–∞ "–ì—Ä–∞—Ü–∏—è"</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <style>
        /* ===== –û–°–ù–û–í–ù–´–ï –°–¢–ò–õ–ò ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            color: #333;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
            color: white;
            border-radius: 15px;
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: "üíÉüï∫";
            position: absolute;
            font-size: 5rem;
            opacity: 0.1;
            right: 30px;
            top: 10px;
        }
        
        h1 {
            margin-bottom: 10px;
            font-size: 2.8rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .subtitle {
            font-size: 1.3rem;
            opacity: 0.95;
            font-weight: 300;
        }
        
        .studio-name {
            font-weight: bold;
            color: #ffeaa7;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .current-date {
            font-size: 1.2rem;
            margin-top: 10px;
            color: #ffeaa7;
        }
        
        /* ===== –¢–ê–ë–´ ===== */
        .tabs {
            display: flex;
            background: white;
            border-radius: 15px;
            margin-bottom: 30px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }
        
        .tab {
            flex: 1;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        
        .tab:hover {
            background-color: #f8f9fa;
        }
        
        .tab.active {
            background-color: #ffeaa7;
            border-bottom: 3px solid #ff6b6b;
            color: #2d3436;
        }
        
        .tab-content {
            display: none;
            background-color: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* ===== –°–¢–ê–¢–ò–°–¢–ò–ö–ê ===== */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            text-align: center;
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .stat-label {
            color: #636e72;
            font-size: 1rem;
        }
        
        .stat-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: #ff6b6b;
        }
        
        .stat-clients { background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%); color: white; }
        .stat-trainers { background: linear-gradient(135deg, #00b894 0%, #00a085 100%); color: white; }
        .stat-groups { background: linear-gradient(135deg, #fd79a8 0%, #e84393 100%); color: white; }
        .stat-directions { background: linear-gradient(135deg, #a29bfe 0%, #6c5ce7 100%); color: white; }
        .stat-classes { background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%); color: #2d3436; }
        
        /* ===== –ö–ê–õ–ï–ù–î–ê–†–¨ ===== */
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding: 15px;
            background: linear-gradient(to right, #a29bfe, #6c5ce7);
            border-radius: 10px;
            color: white;
        }
        
        .calendar-nav {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .calendar-title {
            font-size: 1.8rem;
            font-weight: 600;
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background-color: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 25px;
        }
        
        .calendar-day-header {
            background: linear-gradient(to right, #ff6b6b, #ee5a52);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .calendar-day {
            background-color: white;
            min-height: 120px;
            padding: 10px;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.3s ease;
            position: relative;
        }
        
        .calendar-day:hover {
            background-color: #f9f9f9;
        }
        
        .calendar-day.today {
            background-color: #ffeaa7;
        }
        
        .calendar-day.weekend {
            background-color: #f8f9fa;
        }
        
        .day-number {
            font-weight: bold;
            font-size: 1.2rem;
            margin-bottom: 8px;
            color: #2d3436;
        }
        
        .day-events {
            font-size: 0.85rem;
        }
        
        .event-item {
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            margin-bottom: 4px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .event-item:hover {
            opacity: 0.9;
            transform: translateX(3px);
        }
        
        .event-beginner {
            background-color: #00b894;
        }
        
        .event-intermediate {
            background-color: #0984e3;
        }
        
        .event-advanced {
            background-color: #fd79a8;
        }
        
        .event-more {
            background-color: #636e72;
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.75rem;
            text-align: center;
            margin-top: 5px;
        }
        
        /* ===== –ù–ê–ü–†–ê–í–õ–ï–ù–ò–Ø ===== */
        .directions-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
            margin-top: 25px;
        }
        
        .direction-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            overflow: hidden;
            transition: transform 0.3s ease;
        }
        
        .direction-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
        }
        
        .direction-header {
            padding: 20px;
            background: linear-gradient(to right, #a29bfe, #6c5ce7);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .direction-editor-header {
            background: linear-gradient(to right, #fd79a8, #e84393);
        }
        
        .direction-title {
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .direction-icon {
            font-size: 2rem;
        }
        
        .direction-body {
            padding: 20px;
        }
        
        .direction-age {
            font-size: 0.9rem;
            color: #636e72;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .direction-description {
            font-size: 0.95rem;
            line-height: 1.5;
            margin-bottom: 15px;
            color: #2d3436;
        }
        
        .direction-schedule {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 0.9rem;
        }
        
        .direction-stats {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            font-size: 0.9rem;
            color: #636e72;
        }
        
        .direction-features {
            list-style-type: none;
            margin-bottom: 15px;
        }
        
        .direction-features li {
            padding: 5px 0;
            font-size: 0.9rem;
            color: #636e72;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .direction-features li:before {
            content: "‚úì";
            color: #00b894;
            font-weight: bold;
        }
        
        .direction-price {
            font-weight: bold;
            color: #ff6b6b;
            font-size: 1.1rem;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #eee;
        }
        
        .direction-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
            text-transform: uppercase;
            margin-left: 10px;
        }
        
        .badge-new {
            background-color: #fd79a8;
            color: white;
        }
        
        .badge-online {
            background-color: #0984e3;
            color: white;
        }
        
        .badge-special {
            background-color: #fdcb6e;
            color: #2d3436;
        }
        
        .auto-generate-badge {
            background: #00b894;
            color: white;
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: bold;
            display: inline-block;
            margin-left: 10px;
        }
        
        /* ===== –ì–†–£–ü–ü–´ ===== */
        .groups-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
            margin-top: 25px;
        }
        
        .group-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            overflow: hidden;
            transition: transform 0.3s ease;
        }
        
        .group-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
        }
        
        .group-header {
            padding: 20px;
            background: linear-gradient(to right, #a29bfe, #6c5ce7);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .group-title {
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .group-level {
            background-color: white;
            color: #6c5ce7;
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: bold;
        }
        
        .group-body {
            padding: 20px;
        }
        
        .group-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .group-trainer, .group-time, .group-room {
            font-size: 0.9rem;
            color: #636e72;
        }
        
        .group-trainer i, .group-time i, .group-room i {
            margin-right: 5px;
            color: #ff6b6b;
        }
        
        .group-members {
            max-height: 200px;
            overflow-y: auto;
        }
        
        .group-member {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #f8f9fa;
        }
        
        .group-member:last-child {
            border-bottom: none;
        }
        
        .member-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .member-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: linear-gradient(to right, #74b9ff, #0984e3);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .member-name {
            font-weight: 500;
        }
        
        .member-subscription {
            font-size: 0.8rem;
            color: #636e72;
        }
        
        .member-status {
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
        }
        
        .status-active {
            background-color: #00b894;
            color: white;
        }
        
        .status-expiring {
            background-color: #fdcb6e;
            color: white;
        }
        
        .status-expired {
            background-color: #e17055;
            color: white;
        }
        
        .status-child {
            background-color: #a29bfe;
            color: white;
        }
        
        .status-teen {
            background-color: #6c5ce7;
            color: white;
        }
        
        .status-adult {
            background-color: #00b894;
            color: white;
        }
        
        .status-adult45 {
            background-color: #e17055;
            color: white;
        }
        
        .status-special {
            background-color: #fd79a8;
            color: white;
        }
        
        .group-footer {
            padding: 15px 20px;
            background-color: #f8f9fa;
            border-top: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .group-count {
            font-size: 0.9rem;
            color: #636e72;
        }
        
        /* ===== –†–ï–î–ê–ö–¢–û–† –†–ê–°–ü–ò–°–ê–ù–ò–Ø ===== */
        .schedule-editor {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid #e0e0e0;
        }
        
        .schedule-day-row {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
            padding: 10px;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #6c5ce7;
        }
        
        .schedule-time-input {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .schedule-day-checkbox {
            min-width: 150px;
        }
        
        .group-preview {
            background: #e3f2fd;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            border: 1px solid #90caf9;
        }
        
        /* ===== –û–ë–©–ò–ï –°–¢–ò–õ–ò ===== */
        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #ffeaa7;
        }
        
        .content-title {
            font-size: 1.8rem;
            color: #2d3436;
            font-weight: 600;
        }
        
        .content-icon {
            font-size: 2.2rem;
            color: #ff6b6b;
        }
        
        /* ===== –ö–ù–û–ü–ö–ò ===== */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            font-size: 0.95rem;
        }
        
        .btn-primary {
            background: linear-gradient(to right, #ff6b6b, #ee5a52);
            color: white;
        }
        
        .btn-primary:hover {
            background: linear-gradient(to right, #ff5252, #e74c3c);
            transform: scale(1.05);
        }
        
        .btn-success {
            background: linear-gradient(to right, #00b894, #00a085);
            color: white;
        }
        
        .btn-success:hover {
            background: linear-gradient(to right, #00a085, #008b74);
            transform: scale(1.05);
        }
        
        .btn-info {
            background: linear-gradient(to right, #74b9ff, #0984e3);
            color: white;
        }
        
        .btn-info:hover {
            background: linear-gradient(to right, #0984e3, #0770c4);
            transform: scale(1.05);
        }
        
        .btn-warning {
            background: linear-gradient(to right, #fdcb6e, #f9a825);
            color: white;
        }
        
        .btn-warning:hover {
            background: linear-gradient(to right, #f9a825, #f57f17);
            transform: scale(1.05);
        }
        
        .btn-danger {
            background: linear-gradient(to right, #ff6b6b, #ee5a52);
            color: white;
        }
        
        .btn-danger:hover {
            background: linear-gradient(to right, #ff5252, #e74c3c);
            transform: scale(1.05);
        }
        
        .btn-export {
            background: linear-gradient(to right, #00cec9, #00b894);
            color: white;
        }
        
        .btn-export:hover {
            background: linear-gradient(to right, #00b894, #00a085);
            transform: scale(1.05);
        }
        
        .btn-import {
            background: linear-gradient(to right, #6c5ce7, #a29bfe);
            color: white;
        }
        
        .btn-import:hover {
            background: linear-gradient(to right, #5b4fcf, #8a7ef5);
            transform: scale(1.05);
        }
        
        /* ===== –ö–ù–û–ü–ö–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø ===== */
        .action-buttons {
            display: flex;
            gap: 8px;
        }
        
        .action-btn {
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.85rem;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        
        .edit-btn {
            background-color: #74b9ff;
            color: white;
        }
        
        .edit-btn:hover {
            background-color: #0984e3;
        }
        
        .delete-btn {
            background-color: #e17055;
            color: white;
        }
        
        .delete-btn:hover {
            background-color: #d63031;
        }
        
        /* ===== –¢–ê–ë–õ–ò–¶–´ ===== */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }
        
        .data-table th, .data-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #f1f2f6;
        }
        
        .data-table th {
            background: linear-gradient(to right, #a29bfe, #6c5ce7);
            color: white;
            font-weight: 600;
        }
        
        .data-table tr:hover {
            background-color: #f9f9f9;
        }
        
        /* ===== –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê ===== */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }
        
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 900px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            position: relative;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .close {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 1.8rem;
            cursor: pointer;
            color: #636e72;
            transition: color 0.3s ease;
        }
        
        .close:hover {
            color: #d63031;
        }
        
        .modal-title {
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: #2d3436;
            border-bottom: 2px solid #ffeaa7;
            padding-bottom: 10px;
        }
        
        /* ===== –§–û–†–ú–´ ===== */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-col {
            flex: 1;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2d3436;
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border-radius: 8px;
            border: 2px solid #ddd;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }
        
        .form-control:focus {
            border-color: #74b9ff;
            outline: none;
        }
        
        textarea.form-control {
            min-height: 100px;
            resize: vertical;
        }
        
        select.form-control {
            background-color: white;
        }
        
        /* ===== –ü–ê–ù–ï–õ–¨ –ò–ù–°–¢–†–£–ú–ï–ù–¢–û–í ===== */
        .toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .search-box {
            position: relative;
            flex: 1;
            min-width: 300px;
        }
        
        .search-box input {
            width: 100%;
            padding: 12px 15px 12px 45px;
            border-radius: 8px;
            border: 2px solid #ddd;
            font-size: 1rem;
        }
        
        .search-box i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #636e72;
        }
        
        /* ===== –ò–ú–ü–û–†–¢/–≠–ö–°–ü–û–†–¢ ===== */
        .import-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
            border: 2px dashed #74b9ff;
        }
        
        .import-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            color: #2d3436;
        }
        
        .import-options {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .file-input-container {
            position: relative;
            flex: 1;
            min-width: 250px;
        }
        
        .file-input-label {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 20px;
            background: white;
            border: 2px solid #74b9ff;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .file-input-label:hover {
            background: #f0f7ff;
        }
        
        .file-input {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        
        .preview-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
            display: block;
        }
        
        .preview-table th, .preview-table td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: left;
        }
        
        .preview-table th {
            background: #f0f0f0;
            font-weight: bold;
        }
        
        .preview-table tr:nth-child(even) {
            background: #f9f9f9;
        }
        
        /* ===== –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø ===== */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 1001;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .notification-success {
            background: linear-gradient(to right, #00b894, #00a085);
        }
        
        .notification-error {
            background: linear-gradient(to right, #ff6b6b, #ee5a52);
        }
        
        .notification-warning {
            background: linear-gradient(to right, #fdcb6e, #f9a825);
        }
        
        .notification-info {
            background: linear-gradient(to right, #74b9ff, #0984e3);
        }
        
        /* ===== –ò–ù–î–ò–ö–ê–¢–û–† –ó–ê–ù–Ø–¢–ò–ô ===== */
        .classes-indicator {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
            margin-bottom: 15px;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        
        .classes-count {
            font-weight: bold;
            color: #6c5ce7;
        }
        
        /* ===== –ü–û–î–í–ê–õ ===== */
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 25px;
            border-top: 1px solid #e0e0e0;
            color: #636e72;
            font-size: 0.95rem;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        /* ===== –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ ===== */
        @media (max-width: 1200px) {
            .calendar-grid {
                grid-template-columns: repeat(7, 1fr);
            }
            
            .groups-container, .directions-container {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            }
        }
        
        @media (max-width: 900px) {
            .calendar-grid {
                grid-template-columns: repeat(7, 1fr);
            }
            
            .calendar-day {
                min-height: 100px;
            }
            
            .groups-container, .directions-container {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .toolbar {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-box {
                min-width: 100%;
            }
        }
        
        @media (max-width: 600px) {
            .calendar-grid {
                grid-template-columns: repeat(7, 1fr);
            }
            
            .calendar-day-header {
                padding: 10px 5px;
                font-size: 0.9rem;
            }
            
            .calendar-day {
                min-height: 80px;
                padding: 5px;
            }
            
            .day-number {
                font-size: 1rem;
            }
            
            .event-item {
                font-size: 0.7rem;
                padding: 2px 5px;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .schedule-day-row {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .schedule-day-checkbox {
                width: 100%;
            }
            
            .schedule-time-input {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-heart"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—É–¥–∏–µ–π —Ç–∞–Ω—Ü–∞</h1>
            <p class="subtitle">–¢–∞–Ω—Ü–µ–≤–∞–ª—å–Ω–∞—è —Å—Ç—É–¥–∏—è <span class="studio-name">"–ì—Ä–∞—Ü–∏—è"</span></p>
            <div class="current-date" id="currentDate"></div>
        </header>
        
        <!-- –ë–ª–æ–∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
        <div class="stats-container" id="statsContainer"></div>
        
        <!-- –ë–ª–æ–∫ –∏–º–ø–æ—Ä—Ç–∞/—ç–∫—Å–ø–æ—Ä—Ç–∞ -->
        <div class="import-section">
            <div class="import-header">
                <i class="fas fa-exchange-alt"></i>
                <h3 style="margin: 0;">–ò–º–ø–æ—Ä—Ç/–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</h3>
            </div>
            <div class="import-options">
                <div class="file-input-container">
                    <label class="file-input-label">
                        <i class="fas fa-file-upload"></i>
                        <span id="fileName">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª Excel...</span>
                        <input type="file" id="importFile" class="file-input" accept=".xlsx, .xls" />
                    </label>
                </div>
                <button class="btn btn-import" id="importBtn" disabled>
                    <i class="fas fa-file-import"></i> –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å
                </button>
                <button class="btn btn-export" id="exportAllBtnTop">
                    <i class="fas fa-file-export"></i> –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
                </button>
                <button class="btn btn-warning" id="resetDataBtn">
                    <i class="fas fa-redo"></i> –°–±—Ä–æ—Å–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
                </button>
            </div>
            <div id="importPreview" style="display: none; margin-top: 20px;">
                <h4>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö:</h4>
                <div class="preview-table" id="previewTable"></div>
                <div style="margin-top: 15px;">
                    <button class="btn btn-success" id="confirmImportBtn">
                        <i class="fas fa-check"></i> –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∏–º–ø–æ—Ä—Ç
                    </button>
                    <button class="btn btn-warning" id="cancelImportBtn">
                        <i class="fas fa-times"></i> –û—Ç–º–µ–Ω–∞
                    </button>
                </div>
            </div>
        </div>
        
        <!-- –¢–∞–±—ã -->
        <div class="tabs">
            <div class="tab active" data-tab="directions">–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è</div>
            <div class="tab" data-tab="calendar">–ö–∞–ª–µ–Ω–¥–∞—Ä—å</div>
            <div class="tab" data-tab="groups">–ì—Ä—É–ø–ø—ã</div>
            <div class="tab" data-tab="trainers">–¢—Ä–µ–Ω–µ—Ä—ã</div>
            <div class="tab" data-tab="clients">–ö–ª–∏–µ–Ω—Ç—ã</div>
            <div class="tab" data-tab="subscriptions">–ê–±–æ–Ω–µ–º–µ–Ω—Ç—ã</div>
        </div>
        
        <!-- ===== –ù–ê–ü–†–ê–í–õ–ï–ù–ò–Ø (–ê–∫—Ç–∏–≤–Ω–∞—è –≤–∫–ª–∞–¥–∫–∞) ===== -->
        <div class="tab-content active" id="directions-content">
            <div class="content-header">
                <h2 class="content-title">–†–µ–¥–∞–∫—Ç–æ—Ä –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π</h2>
                <div class="content-icon"><i class="fas fa-directions"></i></div>
            </div>
            
            <div class="toolbar">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchDirection" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é...">
                </div>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <select id="filterDirectionAge" class="form-control" style="min-width: 200px;">
                        <option value="all">–í—Å–µ –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –≥—Ä—É–ø–ø—ã</option>
                        <option value="baby">–ú–∞–ª—ã—à–∏ 3-7 –ª–µ—Ç</option>
                        <option value="kids">–î–µ—Ç–∏ 8-12 –ª–µ—Ç</option>
                        <option value="teens">–ü–æ–¥—Ä–æ—Å—Ç–∫–∏ 13-17 –ª–µ—Ç</option>
                        <option value="adult">–í–∑—Ä–æ—Å–ª—ã–µ 18-44 –ª–µ—Ç</option>
                        <option value="adult25">–í–∑—Ä–æ—Å–ª—ã–µ 25+ –ª–µ—Ç</option>
                        <option value="adult45">–í–∑—Ä–æ—Å–ª—ã–µ 45+ –ª–µ—Ç</option>
                        <option value="special">–°–ø–µ—Ü–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</option>
                    </select>
                    <button class="btn btn-success" id="addDirectionBtn">
                        <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                    </button>
                    <button class="btn btn-warning" id="syncGroupsBtn">
                        <i class="fas fa-sync"></i> –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≥—Ä—É–ø–ø—ã
                    </button>
                    <button class="btn btn-info" id="generateAllClassesBtn">
                        <i class="fas fa-calendar-alt"></i> –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∑–∞–Ω—è—Ç–∏—è
                    </button>
                </div>
            </div>
            
            <div class="classes-indicator">
                <i class="fas fa-info-circle"></i>
                <span>–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç –≥—Ä—É–ø–ø—ã –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é. –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –Ω–∞–∂–º–∏—Ç–µ "–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≥—Ä—É–ø–ø—ã".</span>
            </div>
            
            <div class="directions-container" id="directionsContainer"></div>
        </div>
        
        <!-- ===== –ö–ê–õ–ï–ù–î–ê–†–¨ ===== -->
        <div class="tab-content" id="calendar-content">
            <div class="content-header">
                <h2 class="content-title">–ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–Ω—è—Ç–∏–π</h2>
                <div class="content-icon"><i class="fas fa-calendar-alt"></i></div>
            </div>
            
            <div class="toolbar">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchCalendar" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∑–∞–Ω—è—Ç–∏—é –∏–ª–∏ —Ç—Ä–µ–Ω–µ—Ä—É...">
                </div>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button class="btn btn-success" id="addClassBtn">
                        <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –∑–∞–Ω—è—Ç–∏–µ
                    </button>
                    <button class="btn btn-warning" id="generateClassesBtn">
                        <i class="fas fa-calendar-plus"></i> –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∑–∞–Ω—è—Ç–∏—è
                    </button>
                    <button class="btn btn-info" id="todayBtn">
                        <i class="fas fa-calendar-day"></i> –°–µ–≥–æ–¥–Ω—è
                    </button>
                </div>
            </div>
            
            <div class="calendar-header">
                <div class="calendar-nav">
                    <button class="btn btn-primary" id="prevMonth">
                        <i class="fas fa-chevron-left"></i> –ü—Ä–µ–¥—ã–¥—É—â–∏–π
                    </button>
                    <h3 class="calendar-title" id="calendarMonth"></h3>
                    <button class="btn btn-primary" id="nextMonth">
                        –°–ª–µ–¥—É—é—â–∏–π <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
            
            <div class="classes-indicator">
                <i class="fas fa-info-circle"></i>
                <span>–ó–∞–Ω—è—Ç–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∏–∑ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –≥—Ä—É–ø–ø. –í—Å–µ–≥–æ –∑–∞–Ω—è—Ç–∏–π: <span id="totalClassesCount">0</span></span>
            </div>
            
            <div class="calendar-grid" id="calendarGrid"></div>
            
            <div style="display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap;">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 15px; height: 15px; background-color: #00b894; border-radius: 3px;"></div>
                    <span>–ù–∞—á–∏–Ω–∞—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å</span>
                </div>
                <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 15px; height: 15px; background-color: #0984e3; border-radius: 3px;"></div>
                    <span>–°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å</span>
                </div>
                <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 15px; height: 15px; background-color: #fd79a8; border-radius: 3px;"></div>
                    <span>–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —É—Ä–æ–≤–µ–Ω—å</span>
                </div>
                <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 15px; height: 15px; background-color: #a29bfe; border-radius: 3px;"></div>
                    <span>–°–≤—è–∑–∞–Ω–æ —Å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º</span>
                </div>
            </div>
        </div>
        
        <!-- ===== –ì–†–£–ü–ü–´ ===== -->
        <div class="tab-content" id="groups-content">
            <div class="content-header">
                <h2 class="content-title">–ì—Ä—É–ø–ø—ã</h2>
                <div class="content-icon"><i class="fas fa-users"></i></div>
            </div>
            
            <div class="toolbar">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchGroups" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –≥—Ä—É–ø–ø—ã...">
                </div>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <select id="filterGroupLevel" class="form-control" style="min-width: 150px;">
                        <option value="all">–í—Å–µ —É—Ä–æ–≤–Ω–∏</option>
                        <option value="beginner">–ù–∞—á–∏–Ω–∞—é—â–∏–π</option>
                        <option value="intermediate">–°—Ä–µ–¥–Ω–∏–π</option>
                        <option value="advanced">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π</option>
                    </select>
                    <select id="filterGroupDirection" class="form-control" style="min-width: 200px;">
                        <option value="all">–í—Å–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è</option>
                    </select>
                    <button class="btn btn-success" id="addGroupBtn">
                        <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–ø–ø—É
                    </button>
                    <button class="btn btn-export" id="exportGroupsBtn">
                        <i class="fas fa-file-excel"></i> –≠–∫—Å–ø–æ—Ä—Ç –≥—Ä—É–ø–ø
                    </button>
                </div>
            </div>
            
            <div class="groups-container" id="groupsContainer"></div>
        </div>
        
        <!-- ===== –¢–†–ï–ù–ï–†–´ ===== -->
        <div class="tab-content" id="trainers-content">
            <div class="content-header">
                <h2 class="content-title">–¢—Ä–µ–Ω–µ—Ä—ã</h2>
                <div class="content-icon"><i class="fas fa-chalkboard-teacher"></i></div>
            </div>
            
            <div class="toolbar">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchTrainer" placeholder="–ü–æ–∏—Å–∫ —Ç—Ä–µ–Ω–µ—Ä–∞...">
                </div>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button class="btn btn-success" id="addTrainerBtn">
                        <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ–Ω–µ—Ä–∞
                    </button>
                    <button class="btn btn-export" id="exportTrainersBtn">
                        <i class="fas fa-file-excel"></i> –≠–∫—Å–ø–æ—Ä—Ç —Ç—Ä–µ–Ω–µ—Ä–æ–≤
                    </button>
                </div>
            </div>
            
            <table class="data-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>–§–ò–û</th>
                        <th>–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è</th>
                        <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
                        <th>Email</th>
                        <th>–û–ø—ã—Ç</th>
                        <th>–ì—Ä—É–ø–ø—ã</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody id="trainersTable"></tbody>
            </table>
        </div>
        
        <!-- ===== –ö–õ–ò–ï–ù–¢–´ ===== -->
        <div class="tab-content" id="clients-content">
            <div class="content-header">
                <h2 class="content-title">–ö–ª–∏–µ–Ω—Ç—ã</h2>
                <div class="content-icon"><i class="fas fa-user-friends"></i></div>
            </div>
            
            <div class="toolbar">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchClient" placeholder="–ü–æ–∏—Å–∫ –∫–ª–∏–µ–Ω—Ç–∞...">
                </div>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <select id="filterClientGroup" class="form-control" style="min-width: 200px;">
                        <option value="all">–í—Å–µ –≥—Ä—É–ø–ø—ã</option>
                    </select>
                    <select id="filterClientType" class="form-control" style="min-width: 150px;">
                        <option value="all">–í—Å–µ –∫–ª–∏–µ–Ω—Ç—ã</option>
                        <option value="child">–î–µ—Ç–∏ 3-12 –ª–µ—Ç</option>
                        <option value="teen">–ü–æ–¥—Ä–æ—Å—Ç–∫–∏ 13-17 –ª–µ—Ç</option>
                        <option value="adult">–í–∑—Ä–æ—Å–ª—ã–µ 18-44 –ª–µ—Ç</option>
                        <option value="adult45">–í–∑—Ä–æ—Å–ª—ã–µ 45+ –ª–µ—Ç</option>
                        <option value="special">–°–ø–µ—Ü–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</option>
                    </select>
                    <button class="btn btn-success" id="addClientBtn">
                        <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞
                    </button>
                    <button class="btn btn-export" id="exportClientsBtn">
                        <i class="fas fa-file-excel"></i> –≠–∫—Å–ø–æ—Ä—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤
                    </button>
                </div>
            </div>
            
            <table class="data-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>–§–ò–û</th>
                        <th>–¢–∏–ø</th>
                        <th>–í–æ–∑—Ä–∞—Å—Ç</th>
                        <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
                        <th>–†–æ–¥–∏—Ç–µ–ª—å</th>
                        <th>–ì—Ä—É–ø–ø–∞</th>
                        <th>–ê–±–æ–Ω–µ–º–µ–Ω—Ç</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody id="clientsTable"></tbody>
            </table>
        </div>
        
        <!-- ===== –ê–ë–û–ù–ï–ú–ï–ù–¢–´ ===== -->
        <div class="tab-content" id="subscriptions-content">
            <div class="content-header">
                <h2 class="content-title">–ê–±–æ–Ω–µ–º–µ–Ω—Ç—ã</h2>
                <div class="content-icon"><i class="fas fa-id-card"></i></div>
            </div>
            
            <div class="toolbar">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchSubscription" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∫–ª–∏–µ–Ω—Ç—É...">
                </div>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <select id="filterSubscriptionStatus" class="form-control" style="min-width: 150px;">
                        <option value="all">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                        <option value="active">–ê–∫—Ç–∏–≤–Ω—ã–µ</option>
                        <option value="expiring">–ó–∞–∫–∞–Ω—á–∏–≤–∞—é—Ç—Å—è</option>
                        <option value="expired">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ</option>
                    </select>
                    <select id="filterSubscriptionType" class="form-control" style="min-width: 200px;">
                        <option value="all">–í—Å–µ —Ç–∏–ø—ã</option>
                    </select>
                    <button class="btn btn-success" id="addSubscriptionBtn">
                        <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç
                    </button>
                </div>
            </div>
            
            <table class="data-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>–ö–ª–∏–µ–Ω—Ç</th>
                        <th>–ì—Ä—É–ø–ø–∞</th>
                        <th>–¢–∏–ø –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞</th>
                        <th>–ù–∞—á–∞–ª–æ</th>
                        <th>–û–∫–æ–Ω—á–∞–Ω–∏–µ</th>
                        <th>–ó–∞–Ω—è—Ç–∏–π</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody id="subscriptionsTable"></tbody>
            </table>
        </div>
        
        <!-- ===== –ü–û–î–í–ê–õ ===== -->
        <div class="footer">
            <p>–°—Ç—É–¥–∏—è —Ç–∞–Ω—Ü–∞ "–ì—Ä–∞—Ü–∏—è" ¬© 2023 | –¢–µ–ª: +7 (999) 123-45-67 | –ê–¥—Ä–µ—Å: —É–ª. –¢–∞–Ω—Ü–µ–≤–∞–ª—å–Ω–∞—è, 15</p>
            <p style="margin-top: 10px;">–û–±–Ω–æ–≤–ª–µ–Ω–æ: <span id="updateTime"></span> | <i class="fas fa-music"></i> –¢–∞–Ω—Ü—É–π—Ç–µ —Å –Ω–∞–º–∏! <i class="fas fa-music"></i></p>
        </div>
    </div>
    
    <!-- ===== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–õ–Ø –ù–ê–ü–†–ê–í–õ–ï–ù–ò–Ø ===== -->
    <div id="directionModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3 class="modal-title" id="directionModalTitle">–î–æ–±–∞–≤–∏—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h3>
            <form id="directionForm">
                <input type="hidden" id="directionKey">
                
                <div class="form-group">
                    <label for="directionTitle">–ù–∞–∑–≤–∞–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è *</label>
                    <input type="text" id="directionTitle" class="form-control" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –¢–∞–Ω–µ—Ü-–∏–≥—Ä–∞ / –†–∏—Ç–º–∏–∫–∞">
                </div>
                
                <div class="form-row">
                    <div class="form-col">
                        <label for="directionAgeGroup">–í–æ–∑—Ä–∞—Å—Ç–Ω–∞—è –≥—Ä—É–ø–ø–∞ *</label>
                        <select id="directionAgeGroup" class="form-control" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≤–æ–∑—Ä–∞—Å—Ç–Ω—É—é –≥—Ä—É–ø–ø—É</option>
                            <option value="baby">–ú–∞–ª—ã—à–∏ 3-7 –ª–µ—Ç</option>
                            <option value="kids">–î–µ—Ç–∏ 8-12 –ª–µ—Ç</option>
                            <option value="teens">–ü–æ–¥—Ä–æ—Å—Ç–∫–∏ 13-17 –ª–µ—Ç</option>
                            <option value="adult">–í–∑—Ä–æ—Å–ª—ã–µ 18-44 –ª–µ—Ç</option>
                            <option value="adult25">–í–∑—Ä–æ—Å–ª—ã–µ 25+ –ª–µ—Ç</option>
                            <option value="adult45">–í–∑—Ä–æ—Å–ª—ã–µ 45+ –ª–µ—Ç</option>
                            <option value="special">–°–ø–µ—Ü–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</option>
                        </select>
                    </div>
                    <div class="form-col">
                        <label for="directionIcon">–ò–∫–æ–Ω–∫–∞</label>
                        <input type="text" id="directionIcon" class="form-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: üíÉ">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="directionDescription">–û–ø–∏—Å–∞–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è</label>
                    <textarea id="directionDescription" class="form-control" rows="3" placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="directionPrice">–°—Ç–æ–∏–º–æ—Å—Ç—å</label>
                    <input type="text" id="directionPrice" class="form-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ê–±–æ–Ω–µ–º–µ–Ω—Ç: 3000‚ÇΩ/–º–µ—Å (8 –∑–∞–Ω—è—Ç–∏–π)">
                </div>
                
                <div class="form-group">
                    <label for="directionBadge">–ë–µ–π–¥–∂ (–º–µ—Ç–∫–∞)</label>
                    <select id="directionBadge" class="form-control">
                        <option value="">–ù–µ—Ç –±–µ–π–¥–∂–∞</option>
                        <option value="üî• –ù–û–í–ò–ù–ö–ê">üî• –ù–û–í–ò–ù–ö–ê</option>
                        <option value="üåê ONLINE">üåê ONLINE</option>
                        <option value="üé™ –°–û–ë–´–¢–ò–ï">üé™ –°–û–ë–´–¢–ò–ï</option>
                        <option value="üë∂ –î–õ–Ø –ë–£–î–£–©–ò–• –ú–ê–ú">üë∂ –î–õ–Ø –ë–£–î–£–©–ò–• –ú–ê–ú</option>
                        <option value="‚ù§Ô∏è –ú–ê–ú–ê+–ú–ê–õ–´–®">‚ù§Ô∏è –ú–ê–ú–ê+–ú–ê–õ–´–®</option>
                        <option value="üíò –î–õ–Ø –ü–ê–†">üíò –î–õ–Ø –ü–ê–†</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è</label>
                    <div id="featuresContainer">
                        <div class="form-row">
                            <div class="form-col">
                                <input type="text" class="form-control feature-input" placeholder="–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å 1">
                            </div>
                            <div class="form-col" style="flex: 0 0 100px;">
                                <button type="button" class="btn btn-success add-feature-btn">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button type="button" class="btn btn-danger remove-feature-btn">
                                    <i class="fas fa-minus"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <small>–î–æ–±–∞–≤—å—Ç–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è</small>
                </div>
                
                <div class="schedule-editor">
                    <h4 style="margin-bottom: 15px; color: #6c5ce7;">
                        <i class="fas fa-clock"></i> –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏–π
                    </h4>
                    <p style="margin-bottom: 15px; font-size: 0.9rem; color: #636e72;">
                        –ù–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –≥—Ä—É–ø–ø—ã –∏ –∑–∞–Ω—è—Ç–∏—è –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ
                    </p>
                    
                    <div id="scheduleDaysContainer"></div>
                    
                    <button type="button" class="btn btn-info" id="addScheduleDayBtn">
                        <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏
                    </button>
                    
                    <div class="form-group" style="margin-top: 20px;">
                        <label for="directionRoom">–ó–∞–ª –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</label>
                        <input type="text" id="directionRoom" class="form-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ó–∞–ª 1" value="–ó–∞–ª 1">
                    </div>
                    
                    <div class="form-group">
                        <label for="directionMaxMembers">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤ –≥—Ä—É–ø–ø–µ</label>
                        <input type="number" id="directionMaxMembers" class="form-control" min="1" max="50" value="12">
                    </div>
                    
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="autoCreateGroups" checked>
                            –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –≥—Ä—É–ø–ø—ã –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
                        </label>
                    </div>
                    
                    <div class="group-preview" id="groupPreview">
                        <strong><i class="fas fa-users"></i> –ë—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –≥—Ä—É–ø–ø–∞:</strong>
                        <div id="previewGroupName"></div>
                        <div class="direction-stats">
                            <span><i class="fas fa-calendar"></i> <span id="previewSchedule"></span></span>
                            <span><i class="fas fa-map-marker-alt"></i> <span id="previewRoom"></span></span>
                            <span><i class="fas fa-users"></i> <span id="previewMaxMembers"></span> –º–µ—Å—Ç</span>
                        </div>
                    </div>
                </div>
                
                <div style="display: flex; justify-content: flex-end; gap: 15px; margin-top: 25px;">
                    <button type="button" class="btn btn-warning" id="cancelDirectionBtn">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-success">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- ===== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–õ–Ø –ì–†–£–ü–ü–´ ===== -->
    <div id="groupModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3 class="modal-title" id="groupModalTitle">–î–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–ø–ø—É</h3>
            <form id="groupForm">
                <input type="hidden" id="groupId">
                
                <div class="form-group">
                    <label for="groupName">–ù–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã *</label>
                    <input type="text" id="groupName" class="form-control" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ë–∞–ª—å–Ω—ã–µ —Ç–∞–Ω—Ü—ã">
                </div>
                
                <div class="form-group">
                    <label for="groupDirection">–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ *</label>
                    <select id="groupDirection" class="form-control" required onchange="window.onGroupDirectionChange()">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</option>
                    </select>
                    <small style="color: #00b894;">
                        <i class="fas fa-magic"></i> –ì—Ä—É–ø–ø–∞ –±—É–¥–µ—Ç —Å–≤—è–∑–∞–Ω–∞ —Å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º
                    </small>
                </div>
                
                <div class="form-group">
                    <label for="groupLevel">–£—Ä–æ–≤–µ–Ω—å *</label>
                    <select id="groupLevel" class="form-control" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å</option>
                        <option value="beginner">–ù–∞—á–∏–Ω–∞—é—â–∏–π</option>
                        <option value="intermediate">–°—Ä–µ–¥–Ω–∏–π</option>
                        <option value="advanced">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π</option>
                    </select>
                </div>
                
                <div class="form-row">
                    <div class="form-col">
                        <label for="groupTrainer">–¢—Ä–µ–Ω–µ—Ä *</label>
                        <select id="groupTrainer" class="form-control" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç—Ä–µ–Ω–µ—Ä–∞</option>
                        </select>
                    </div>
                    <div class="form-col">
                        <label for="groupMaxMembers">–ú–∞–∫—Å. —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ *</label>
                        <input type="number" id="groupMaxMembers" class="form-control" required min="1" max="50" value="12">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="groupSchedule">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ *</label>
                    <textarea id="groupSchedule" class="form-control" required rows="2" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü–Ω, –°—Ä, –ü—Ç 10:00-11:30"></textarea>
                    <small id="scheduleFromDirection" style="color: #6c5ce7; display: none;">
                        <i class="fas fa-info-circle"></i> –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –∏–∑ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
                    </small>
                </div>
                
                <div class="form-group">
                    <label for="groupRoom">–ó–∞–ª *</label>
                    <input type="text" id="groupRoom" class="form-control" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ó–∞–ª 1">
                </div>
                
                <div class="form-group">
                    <label for="groupDescription">–û–ø–∏—Å–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã</label>
                    <textarea id="groupDescription" class="form-control" rows="3"></textarea>
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="autoGenerateClasses" checked>
                        –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–Ω—è—Ç–∏—è –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ
                    </label>
                </div>
                
                <div style="display: flex; justify-content: flex-end; gap: 15px; margin-top: 25px;">
                    <button type="button" class="btn btn-warning" id="cancelGroupBtn">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-success">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≥—Ä—É–ø–ø—É</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- ===== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–õ–Ø –ó–ê–ù–Ø–¢–ò–Ø ===== -->
    <div id="classModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3 class="modal-title" id="classModalTitle">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–Ω—è—Ç–∏–µ</h3>
            <form id="classForm">
                <input type="hidden" id="classId">
                
                <div class="form-group">
                    <label for="classDate">–î–∞—Ç–∞ *</label>
                    <input type="date" id="classDate" class="form-control" required>
                </div>
                
                <div class="form-row">
                    <div class="form-col">
                        <label for="classStartTime">–í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ *</label>
                        <input type="time" id="classStartTime" class="form-control" required>
                    </div>
                    <div class="form-col">
                        <label for="classEndTime">–í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è *</label>
                        <input type="time" id="classEndTime" class="form-control" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="classGroup">–ì—Ä—É–ø–ø–∞ *</label>
                    <select id="classGroup" class="form-control" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≥—Ä—É–ø–ø—É</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="classTrainer">–¢—Ä–µ–Ω–µ—Ä *</label>
                    <select id="classTrainer" class="form-control" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç—Ä–µ–Ω–µ—Ä–∞</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="classRoom">–ó–∞–ª *</label>
                    <input type="text" id="classRoom" class="form-control" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ó–∞–ª 1">
                </div>
                
                <div class="form-group">
                    <label for="classNotes">–ü—Ä–∏–º–µ—á–∞–Ω–∏—è</label>
                    <textarea id="classNotes" class="form-control" rows="3"></textarea>
                </div>
                
                <div style="display: flex; justify-content: flex-end; gap: 15px; margin-top: 25px;">
                    <button type="button" class="btn btn-warning" id="cancelClassBtn">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-success">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- ===== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–õ–Ø –¢–†–ï–ù–ï–†–ê ===== -->
    <div id="trainerModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3 class="modal-title" id="trainerModalTitle">–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ–Ω–µ—Ä–∞</h3>
            <form id="trainerForm">
                <input type="hidden" id="trainerId">
                
                <div class="form-row">
                    <div class="form-col">
                        <label for="trainerLastName">–§–∞–º–∏–ª–∏—è *</label>
                        <input type="text" id="trainerLastName" class="form-control" required>
                    </div>
                    <div class="form-col">
                        <label for="trainerFirstName">–ò–º—è *</label>
                        <input type="text" id="trainerFirstName" class="form-control" required>
                    </div>
                    <div class="form-col">
                        <label for="trainerMiddleName">–û—Ç—á–µ—Å—Ç–≤–æ</label>
                        <input type="text" id="trainerMiddleName" class="form-control">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="trainerSpecialization">–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è *</label>
                    <select id="trainerSpecialization" class="form-control" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é</option>
                        <option value="–ë–∞–ª—å–Ω—ã–µ —Ç–∞–Ω—Ü—ã">–ë–∞–ª—å–Ω—ã–µ —Ç–∞–Ω—Ü—ã</option>
                        <option value="–•–∏–ø-—Ö–æ–ø">–•–∏–ø-—Ö–æ–ø</option>
                        <option value="–°–∞–ª—å—Å–∞">–°–∞–ª—å—Å–∞</option>
                        <option value="–ö–æ–Ω—Ç–µ–º–ø–æ—Ä–∞—Ä–∏">–ö–æ–Ω—Ç–µ–º–ø–æ—Ä–∞—Ä–∏</option>
                        <option value="–ë–∞—á–∞—Ç–∞">–ë–∞—á–∞—Ç–∞</option>
                        <option value="–î–∂–∞–∑-—Ñ–∞–Ω–∫">–î–∂–∞–∑-—Ñ–∞–Ω–∫</option>
                        <option value="–¢–∞–Ω–≥–æ">–¢–∞–Ω–≥–æ</option>
                        <option value="–ó—É–º–±–∞">–ó—É–º–±–∞</option>
                        <option value="–í–æ—Å—Ç–æ—á–Ω—ã–µ —Ç–∞–Ω—Ü—ã">–í–æ—Å—Ç–æ—á–Ω—ã–µ —Ç–∞–Ω—Ü—ã</option>
                        <option value="–ë—Ä–µ–π–∫-–¥–∞–Ω—Å">–ë—Ä–µ–π–∫-–¥–∞–Ω—Å</option>
                        <option value="–ö–∏–∑–æ–º–±–∞">–ö–∏–∑–æ–º–±–∞</option>
                        <option value="–í–æ–≥">–í–æ–≥</option>
                        <option value="–î–∂–∞–∑-–º–æ–¥–µ—Ä–Ω">–î–∂–∞–∑-–º–æ–¥–µ—Ä–Ω</option>
                        <option value="–ô–æ–≥–∞">–ô–æ–≥–∞</option>
                        <option value="–†–∞—Å—Ç—è–∂–∫–∞">–†–∞—Å—Ç—è–∂–∫–∞</option>
                        <option value="–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —Ö–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏—è">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —Ö–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏—è</option>
                        <option value="–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ç–∞–Ω–µ—Ü">–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ç–∞–Ω–µ—Ü</option>
                        <option value="–≠—Å—Ç—Ä–∞–¥–Ω—ã–π —Ç–∞–Ω–µ—Ü">–≠—Å—Ç—Ä–∞–¥–Ω—ã–π —Ç–∞–Ω–µ—Ü</option>
                        <option value="High Heels/Lady Dance">High Heels/Lady Dance</option>
                        <option value="Body Ballet">Body Ballet</option>
                        <option value="–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Ç–∞–Ω—Ü—ã">–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Ç–∞–Ω—Ü—ã</option>
                        <option value="–¢–∞–Ω—Ü—ã –¥–ª—è –±–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö">–¢–∞–Ω—Ü—ã –¥–ª—è –±–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</option>
                    </select>
                </div>
                
                <div class="form-row">
                    <div class="form-col">
                        <label for="trainerPhone">–¢–µ–ª–µ—Ñ–æ–Ω *</label>
                        <input type="tel" id="trainerPhone" class="form-control" required>
                    </div>
                    <div class="form-col">
                        <label for="trainerEmail">Email</label>
                        <input type="email" id="trainerEmail" class="form-control">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="trainerExperience">–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã (–ª–µ—Ç)</label>
                    <input type="number" id="trainerExperience" class="form-control" min="0" max="50">
                </div>
                
                <div class="form-group">
                    <label for="trainerGroups">–ì—Ä—É–ø–ø—ã</label>
                    <select id="trainerGroups" class="form-control" multiple style="height: 120px;"></select>
                    <small>–£–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ Ctrl –¥–ª—è –≤—ã–±–æ—Ä–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≥—Ä—É–ø–ø</small>
                </div>
                
                <div class="form-group">
                    <label for="trainerStatus">–°—Ç–∞—Ç—É—Å</label>
                    <select id="trainerStatus" class="form-control">
                        <option value="active">–ê–∫—Ç–∏–≤–Ω—ã–π</option>
                        <option value="inactive">–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–π</option>
                        <option value="vacation">–í –æ—Ç–ø—É—Å–∫–µ</option>
                    </select>
                </div>
                
                <div style="display: flex; justify-content: flex-end; gap: 15px; margin-top: 25px;">
                    <button type="button" class="btn btn-warning" id="cancelTrainerBtn">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-success">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- ===== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–õ–Ø –ö–õ–ò–ï–ù–¢–ê ===== -->
    <div id="clientModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3 class="modal-title" id="clientModalTitle">–î–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞</h3>
            <form id="clientForm">
                <input type="hidden" id="clientId">
                
                <div class="form-group">
                    <label for="clientType">–¢–∏–ø –∫–ª–∏–µ–Ω—Ç–∞ *</label>
                    <select id="clientType" class="form-control" required onchange="window.toggleClientFields()">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
                        <option value="child">–†–µ–±–µ–Ω–æ–∫ (3-12 –ª–µ—Ç)</option>
                        <option value="teen">–ü–æ–¥—Ä–æ—Å—Ç–æ–∫ (13-17 –ª–µ—Ç)</option>
                        <option value="adult">–í–∑—Ä–æ—Å–ª—ã–π (18-44 –ª–µ—Ç)</option>
                        <option value="adult45">–í–∑—Ä–æ—Å–ª—ã–π (45+ –ª–µ—Ç)</option>
                        <option value="special">–°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è</option>
                    </select>
                </div>
                
                <div class="form-row">
                    <div class="form-col">
                        <label for="clientLastName">–§–∞–º–∏–ª–∏—è *</label>
                        <input type="text" id="clientLastName" class="form-control" required>
                    </div>
                    <div class="form-col">
                        <label for="clientFirstName">–ò–º—è *</label>
                        <input type="text" id="clientFirstName" class="form-control" required>
                    </div>
                    <div class="form-col">
                        <label for="clientMiddleName">–û—Ç—á–µ—Å—Ç–≤–æ</label>
                        <input type="text" id="clientMiddleName" class="form-control">
                    </div>
                </div>
                
                <!-- –ü–æ–ª—è –¥–ª—è —Ä–µ–±–µ–Ω–∫–∞ –∏ –ø–æ–¥—Ä–æ—Å—Ç–∫–∞ -->
                <div id="childFields" style="display: none;">
                    <div class="form-group">
                        <label for="clientAge">–í–æ–∑—Ä–∞—Å—Ç (–ª–µ—Ç) *</label>
                        <input type="number" id="clientAge" class="form-control" min="3" max="17" placeholder="–û—Ç 3 –¥–æ 17 –ª–µ—Ç">
                    </div>
                    
                    <h4 style="margin: 20px 0 10px 0; color: #6c5ce7;">–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Ä–æ–¥–∏—Ç–µ–ª—è</h4>
                    
                    <div class="form-row">
                        <div class="form-col">
                            <label for="parentLastName">–§–∞–º–∏–ª–∏—è —Ä–æ–¥–∏—Ç–µ–ª—è *</label>
                            <input type="text" id="parentLastName" class="form-control">
                        </div>
                        <div class="form-col">
                            <label for="parentFirstName">–ò–º—è —Ä–æ–¥–∏—Ç–µ–ª—è *</label>
                            <input type="text" id="parentFirstName" class="form-control">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="parentPhone">–¢–µ–ª–µ—Ñ–æ–Ω —Ä–æ–¥–∏—Ç–µ–ª—è *</label>
                        <input type="tel" id="parentPhone" class="form-control">
                    </div>
                </div>
                
                <!-- –ü–æ–ª—è –¥–ª—è –≤–∑—Ä–æ—Å–ª–æ–≥–æ -->
                <div id="adultFields" style="display: none;">
                    <div class="form-group">
                        <label for="clientBirthDate">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è</label>
                        <input type="date" id="clientBirthDate" class="form-control">
                    </div>
                    
                    <div class="form-row">
                        <div class="form-col">
                            <label for="clientPhone">–¢–µ–ª–µ—Ñ–æ–Ω *</label>
                            <input type="tel" id="clientPhone" class="form-control" required>
                        </div>
                        <div class="form-col">
                            <label for="clientEmail">Email</label>
                            <input type="email" id="clientEmail" class="form-control">
                        </div>
                    </div>
                </div>
                
                <!-- –ü–æ–ª—è –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
                <div id="specialFields" style="display: none;">
                    <div class="form-group">
                        <label for="specialCategory">–°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è *</label>
                        <select id="specialCategory" class="form-control">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                            <option value="family">–°–µ–º–µ–π–Ω—ã–π —Ç–∞–Ω–µ—Ü</option>
                            <option value="online">–û–Ω–ª–∞–π–Ω-–∑–∞–Ω—è—Ç–∏—è</option>
                            <option value="pregnancy">–î–ª—è –±–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</option>
                            <option value="couple">–ü–∞—Ä–Ω—ã–µ —Ç–∞–Ω—Ü—ã</option>
                            <option value="mom-baby">–ú–∞–º–∞+–ú–∞–ª—ã—à</option>
                        </select>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-col">
                            <label for="clientPhone">–¢–µ–ª–µ—Ñ–æ–Ω *</label>
                            <input type="tel" id="clientPhone" class="form-control" required>
                        </div>
                        <div class="form-col">
                            <label for="clientEmail">Email</label>
                            <input type="email" id="clientEmail" class="form-control">
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="clientGroup">–ì—Ä—É–ø–ø–∞ *</label>
                    <select id="clientGroup" class="form-control" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≥—Ä—É–ø–ø—É</option>
                    </select>
                </div>
                
                <div style="display: flex; justify-content: flex-end; gap: 15px; margin-top: 25px;">
                    <button type="button" class="btn btn-warning" id="cancelClientBtn">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-success">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- ===== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–õ–Ø –ê–ë–û–ù–ï–ú–ï–ù–¢–ê ===== -->
    <div id="subscriptionModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3 class="modal-title" id="subscriptionModalTitle">–î–æ–±–∞–≤–∏—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç</h3>
            <form id="subscriptionForm">
                <input type="hidden" id="subscriptionId">
                
                <div class="form-group">
                    <label for="subscriptionClient">–ö–ª–∏–µ–Ω—Ç *</label>
                    <select id="subscriptionClient" class="form-control" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∏–µ–Ω—Ç–∞</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="subscriptionGroup">–ì—Ä—É–ø–ø–∞ *</label>
                    <select id="subscriptionGroup" class="form-control" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≥—Ä—É–ø–ø—É</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="subscriptionType">–¢–∏–ø –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ *</label>
                    <select id="subscriptionType" class="form-control" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
                        <option value="–ü–†–û–ë–ù–û–ï –î–ï–¢–°–ö–û–ï">–ü–†–û–ë–ù–û–ï –î–ï–¢–°–ö–û–ï (350‚ÇΩ)</option>
                        <option value="–ü–†–û–ë–ù–û–ï –í–ó–†–û–°–õ–û–ï">–ü–†–û–ë–ù–û–ï –í–ó–†–û–°–õ–û–ï (400‚ÇΩ)</option>
                        <option value="–î–ï–¢–°–ö–ò–ô (3-12 –ª–µ—Ç)">–î–ï–¢–°–ö–ò–ô (3-12 –ª–µ—Ç) - 3000‚ÇΩ/8 –∑–∞–Ω—è—Ç–∏–π</option>
                        <option value="–ü–û–î–†–û–°–¢–ö–ò (13-17 –ª–µ—Ç)">–ü–û–î–†–û–°–¢–ö–ò (13-17 –ª–µ—Ç) - 3000‚ÇΩ/8 –∑–∞–Ω—è—Ç–∏–π</option>
                        <option value="–í–ó–†–û–°–õ–´–ô (18+ –ª–µ—Ç)">–í–ó–†–û–°–õ–´–ô (18+ –ª–µ—Ç) - 4000‚ÇΩ/8 –∑–∞–Ω—è—Ç–∏–π</option>
                        <option value="–í–ó–†–û–°–õ–´–ô 45+">–í–ó–†–û–°–õ–´–ô 45+ - 4000‚ÇΩ/8 –∑–∞–Ω—è—Ç–∏–π</option>
                        <option value="–ò–ù–î–ò–í–ò–î–£–ê–õ–¨–ù–û">–ò–ù–î–ò–í–ò–î–£–ê–õ–¨–ù–û - 1500‚ÇΩ/–∑–∞–Ω—è—Ç–∏–µ</option>
                        <option value="–°–ï–ú–ï–ô–ù–´–ô">–°–ï–ú–ï–ô–ù–´–ô - 2800‚ÇΩ/4 –∑–∞–Ω—è—Ç–∏—è</option>
                        <option value="–û–ù–õ–ê–ô–ù">–û–ù–õ–ê–ô–ù - 2500‚ÇΩ/4 –∑–∞–Ω—è—Ç–∏—è</option>
                        <option value="–î–õ–Ø –ë–ï–†–ï–ú–ï–ù–ù–´–•">–î–õ–Ø –ë–ï–†–ï–ú–ï–ù–ù–´–• - 3500‚ÇΩ/8 –∑–∞–Ω—è—Ç–∏–π</option>
                    </select>
                </div>
                
                <div class="form-row">
                    <div class="form-col">
                        <label for="subscriptionStart">–ù–∞—á–∞–ª–æ –¥–µ–π—Å—Ç–≤–∏—è *</label>
                        <input type="date" id="subscriptionStart" class="form-control" required>
                    </div>
                    <div class="form-col">
                        <label for="subscriptionEnd">–û–∫–æ–Ω—á–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è *</label>
                        <input type="date" id="subscriptionEnd" class="form-control" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-col">
                        <label for="subscriptionPrice">–°—Ç–æ–∏–º–æ—Å—Ç—å (—Ä—É–±.)</label>
                        <input type="number" id="subscriptionPrice" class="form-control" min="0" step="100">
                    </div>
                    <div class="form-col">
                        <label for="subscriptionClasses">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–Ω—è—Ç–∏–π</label>
                        <input type="number" id="subscriptionClasses" class="form-control" min="1" max="100">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="subscriptionStatus">–°—Ç–∞—Ç—É—Å *</label>
                    <select id="subscriptionStatus" class="form-control" required>
                        <option value="active">–ê–∫—Ç–∏–≤–Ω—ã–π</option>
                        <option value="expiring">–ó–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è</option>
                        <option value="expired">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–π</option>
                        <option value="paused">–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω</option>
                    </select>
                </div>
                
                <div style="display: flex; justify-content: flex-end; gap: 15px; margin-top: 25px;">
                    <button type="button" class="btn btn-warning" id="cancelSubscriptionBtn">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-success">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- ===== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–õ–Ø –î–ï–¢–ê–õ–ï–ô –î–ù–Ø ===== -->
    <div id="dayModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3 class="modal-title">–ó–∞–Ω—è—Ç–∏—è –Ω–∞ <span id="modalDate"></span></h3>
            <div id="dayEvents"></div>
        </div>
    </div>

    <script>
        // ===== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï =====
        let currentDate = new Date();
        let currentCalendarDate = new Date();
        
        // ===== –î–ê–ù–ù–´–ï –ù–ê–ü–†–ê–í–õ–ï–ù–ò–ô =====
        let directions = JSON.parse(localStorage.getItem('danceStudioDirections')) || {
            'baby-dance': {
                id: 'baby-dance',
                title: '–¢–∞–Ω–µ—Ü-–∏–≥—Ä–∞ / –†–∏—Ç–º–∏–∫–∞',
                description: '–†–∞–∑–≤–∏—Ç–∏–µ —á—É–≤—Å—Ç–≤–∞ —Ä–∏—Ç–º–∞, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –∏ –ª—é–±–≤–∏ –∫ –¥–≤–∏–∂–µ–Ω–∏—é —á–µ—Ä–µ–∑ –≤–µ—Å–µ–ª—ã–µ –∏–≥—Ä—ã.',
                ageGroup: 'baby',
                icon: 'üéµ',
                price: '–ü—Ä–æ–±–Ω–æ–µ: 350‚ÇΩ, –∞–±–æ–Ω–µ–º–µ–Ω—Ç: 3000‚ÇΩ/8 –∑–∞–Ω—è—Ç–∏–π',
                badge: '',
                room: '–ó–∞–ª 1',
                maxMembers: 12,
                scheduleDays: [
                    { day: 1, startTime: '17:30', endTime: '18:30' },
                    { day: 4, startTime: '17:30', endTime: '18:30' }
                ],
                features: [
                    '–†–∞–∑–≤–∏—Ç–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –¥–≤–∏–∂–µ–Ω–∏–π',
                    '–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —á—É–≤—Å—Ç–≤–∞ —Ä–∏—Ç–º–∞',
                    '–ò–≥—Ä–æ–≤–∞—è —Ñ–æ—Ä–º–∞ –∑–∞–Ω—è—Ç–∏–π'
                ],
                autoCreateGroups: true,
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            },
            'baby-classic': {
                id: 'baby-classic',
                title: '–ê–∑–±—É–∫–∞ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ —Ç–∞–Ω—Ü–∞',
                description: '–ü–µ—Ä–≤–æ–µ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å –æ—Å–Ω–æ–≤–∞–º–∏ –±–∞–ª–µ—Ç–∞ –≤ –∏–≥—Ä–æ–≤–æ–π —Ñ–æ—Ä–º–µ.',
                ageGroup: 'baby',
                icon: 'ü©∞',
                price: '–ü—Ä–æ–±–Ω–æ–µ: 350‚ÇΩ, –∞–±–æ–Ω–µ–º–µ–Ω—Ç: 3000‚ÇΩ/8 –∑–∞–Ω—è—Ç–∏–π',
                badge: '',
                room: '–ó–∞–ª 1',
                maxMembers: 12,
                scheduleDays: [
                    { day: 1, startTime: '18:30', endTime: '19:30' },
                    { day: 4, startTime: '18:30', endTime: '19:30' }
                ],
                features: [
                    '–û—Å–Ω–æ–≤—ã –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π —Ö–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏–∏',
                    '–†–∞–∑–≤–∏—Ç–∏–µ –≥–∏–±–∫–æ—Å—Ç–∏ –∏ –ø–ª–∞—Å—Ç–∏–∫–∏',
                    '–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ—Ä–ø—É—Å–∞ –∏ –æ—Å–∞–Ω–∫–∏'
                ],
                autoCreateGroups: true,
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            },
            'adult-contemporary': {
                id: 'adult-contemporary',
                title: '–¢–∞–Ω–µ—Ü –¥–ª—è –¥—É—à–∏ (Contemporary)',
                description: '–°–≤–æ–±–æ–¥–Ω—ã–π —Ç–∞–Ω–µ—Ü, –ø–æ–º–æ–≥–∞—é—â–∏–π —Å–Ω—è—Ç—å –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ –∏ —É–ª—É—á—à–∏—Ç—å —Ñ–∏–∑–∏—á–µ—Å–∫—É—é —Ñ–æ—Ä–º—É.',
                ageGroup: 'adult',
                icon: 'üßò',
                price: '–ü—Ä–æ–±–Ω–æ–µ: 400‚ÇΩ, –∞–±–æ–Ω–µ–º–µ–Ω—Ç: 4000‚ÇΩ/8 –∑–∞–Ω—è—Ç–∏–π',
                badge: '',
                room: '–ó–∞–ª 1',
                maxMembers: 12,
                scheduleDays: [
                    { day: 1, startTime: '19:00', endTime: '20:30' },
                    { day: 3, startTime: '19:00', endTime: '20:30' }
                ],
                features: [
                    '–°–Ω—è—Ç–∏–µ —Å—Ç—Ä–µ—Å—Å–∞',
                    '–£–ª—É—á—à–µ–Ω–∏–µ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π —Ñ–æ—Ä–º—ã',
                    '–¢–≤–æ—Ä—á–µ—Å–∫–æ–µ —Å–∞–º–æ–≤—ã—Ä–∞–∂–µ–Ω–∏–µ'
                ],
                autoCreateGroups: true,
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            }
        };
        
        // ===== –î–ê–ù–ù–´–ï –î–õ–Ø –°–ò–°–¢–ï–ú–´ =====
        let groups = JSON.parse(localStorage.getItem('danceStudioGroups')) || [];
        let trainers = JSON.parse(localStorage.getItem('danceStudioTrainers')) || [
            { 
                id: 1, 
                lastName: "–°–º–∏—Ä–Ω–æ–≤–∞", 
                firstName: "–ê–Ω–Ω–∞", 
                middleName: "–ü–µ—Ç—Ä–æ–≤–Ω–∞", 
                specialization: "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —Ö–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏—è", 
                phone: "+7 (911) 111-11-11", 
                email: "anna@studio.ru", 
                experience: 8, 
                groups: [], 
                status: "active"
            },
            { 
                id: 2, 
                lastName: "–í–æ–ª–∫–æ–≤", 
                firstName: "–î–º–∏—Ç—Ä–∏–π", 
                middleName: "–°–µ—Ä–≥–µ–µ–≤–∏—á", 
                specialization: "–•–∏–ø-—Ö–æ–ø", 
                phone: "+7 (911) 222-22-22", 
                email: "dmitry@studio.ru", 
                experience: 5, 
                groups: [], 
                status: "active"
            },
            { 
                id: 3, 
                lastName: "–ì–æ–Ω—Å–∞–ª–µ—Å", 
                firstName: "–ú–∞—Ä–∏—è", 
                middleName: "", 
                specialization: "Contemporary", 
                phone: "+7 (911) 333-33-33", 
                email: "maria@studio.ru", 
                experience: 10, 
                groups: [], 
                status: "active"
            }
        ];
        
        let clients = JSON.parse(localStorage.getItem('danceStudioClients')) || [
            { 
                id: 1, 
                lastName: "–ò–≤–∞–Ω–æ–≤–∞", 
                firstName: "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞", 
                middleName: "–°–µ—Ä–≥–µ–µ–≤–Ω–∞", 
                clientType: "child",
                age: 8,
                parentLastName: "–ò–≤–∞–Ω–æ–≤–∞",
                parentFirstName: "–ï–ª–µ–Ω–∞",
                parentPhone: "+7 (900) 123-45-67",
                phone: "+7 (900) 123-45-67",
                email: "", 
                birthDate: null,
                gender: "female", 
                groupId: null, 
                subscription: "active", 
                subscriptionEnd: "", 
                classesLeft: 0, 
                regDate: new Date().toISOString().split('T')[0]
            }
        ];
        
        let subscriptions = JSON.parse(localStorage.getItem('danceStudioSubscriptions')) || [];
        let classes = JSON.parse(localStorage.getItem('danceStudioClasses')) || [];
        
        // ID –¥–ª—è –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π
        let nextGroupId = groups.length > 0 ? Math.max(...groups.map(g => g.id)) + 1 : 1;
        let nextTrainerId = trainers.length > 0 ? Math.max(...trainers.map(t => t.id)) + 1 : 4;
        let nextClientId = clients.length > 0 ? Math.max(...clients.map(c => c.id)) + 1 : 2;
        let nextSubscriptionId = subscriptions.length > 0 ? Math.max(...subscriptions.map(s => s.id)) + 1 : 1;
        let nextClassId = classes.length > 0 ? Math.max(...classes.map(c => c.id)) + 1 : 1;
        
        // –î–Ω–∏ –Ω–µ–¥–µ–ª–∏
        const daysOfWeek = ["–í—Å", "–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±"];
        const months = ["–Ø–Ω–≤–∞—Ä—å", "–§–µ–≤—Ä–∞–ª—å", "–ú–∞—Ä—Ç", "–ê–ø—Ä–µ–ª—å", "–ú–∞–π", "–ò—é–Ω—å", 
                       "–ò—é–ª—å", "–ê–≤–≥—É—Å—Ç", "–°–µ–Ω—Ç—è–±—Ä—å", "–û–∫—Ç—è–±—Ä—å", "–ù–æ—è–±—Ä—å", "–î–µ–∫–∞–±—Ä—å"];
        
        // ===== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò =====
        
        function saveData() {
            localStorage.setItem('danceStudioDirections', JSON.stringify(directions));
            localStorage.setItem('danceStudioGroups', JSON.stringify(groups));
            localStorage.setItem('danceStudioTrainers', JSON.stringify(trainers));
            localStorage.setItem('danceStudioClients', JSON.stringify(clients));
            localStorage.setItem('danceStudioSubscriptions', JSON.stringify(subscriptions));
            localStorage.setItem('danceStudioClasses', JSON.stringify(classes));
        }
        
        function formatDate(date) {
            const day = date.getDate().toString().padStart(2, '0');
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            const year = date.getFullYear();
            return `${day}.${month}.${year}`;
        }
        
        function getLevelName(level) {
            switch(level) {
                case "beginner": return "–ù–∞—á–∏–Ω–∞—é—â–∏–π";
                case "intermediate": return "–°—Ä–µ–¥–Ω–∏–π";
                case "advanced": return "–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π";
                default: return level;
            }
        }
        
        function getAgeCategoryName(category) {
            switch(category) {
                case "baby": return "–ú–∞–ª—ã—à–∏ 3-7 –ª–µ—Ç";
                case "kids": return "–î–µ—Ç–∏ 8-12 –ª–µ—Ç";
                case "teens": return "–ü–æ–¥—Ä–æ—Å—Ç–∫–∏ 13-17 –ª–µ—Ç";
                case "adult": return "–í–∑—Ä–æ—Å–ª—ã–µ 18-44 –ª–µ—Ç";
                case "adult25": return "–í–∑—Ä–æ—Å–ª—ã–µ 25+ –ª–µ—Ç";
                case "adult45": return "–í–∑—Ä–æ—Å–ª—ã–µ 45+ –ª–µ—Ç";
                case "special": return "–°–ø–µ—Ü–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è";
                case "child": return "–î–µ—Ç–∏ 3-12 –ª–µ—Ç";
                case "teen": return "–ü–æ–¥—Ä–æ—Å—Ç–∫–∏ 13-17 –ª–µ—Ç";
                default: return category || "–ù–µ —É–∫–∞–∑–∞–Ω–∞";
            }
        }
        
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        // ===== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ù–ê–ü–†–ê–í–õ–ï–ù–ò–ô =====
        
        function generateGroupsFromDirections() {
            const newGroups = [];
            let groupId = nextGroupId;
            
            Object.keys(directions).forEach(key => {
                const direction = directions[key];
                
                if (direction.autoCreateGroups !== false) {
                    const existingGroup = groups.find(g => g.directionKey === key);
                    
                    if (!existingGroup) {
                        const scheduleStr = formatScheduleFromDays(direction.scheduleDays || []);
                        
                        newGroups.push({
                            id: groupId++,
                            name: direction.title,
                            directionKey: key,
                            level: 'beginner',
                            trainerId: null,
                            time: scheduleStr,
                            room: direction.room || '–ó–∞–ª 1',
                            maxMembers: direction.maxMembers || 12,
                            description: direction.description || '',
                            scheduleDays: direction.scheduleDays || [],
                            autoGenerate: true,
                            createdAt: new Date().toISOString()
                        });
                    }
                }
            });
            
            nextGroupId = groupId;
            return newGroups;
        }
        
        function formatScheduleFromDays(scheduleDays) {
            if (!scheduleDays || scheduleDays.length === 0) return '–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–µ —É–∫–∞–∑–∞–Ω–æ';
            
            const dayNames = ['–í—Å', '–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±'];
            const dayGroups = {};
            
            scheduleDays.forEach(item => {
                const key = `${item.startTime}-${item.endTime}`;
                if (!dayGroups[key]) dayGroups[key] = [];
                dayGroups[key].push(item.day);
            });
            
            const parts = [];
            Object.keys(dayGroups).forEach(key => {
                const days = dayGroups[key].sort().map(d => dayNames[d]).join(', ');
                parts.push(`${days} ${key}`);
            });
            
            return parts.join('; ');
        }
        
        function syncGroupsWithDirections() {
            const newGroups = generateGroupsFromDirections();
            
            if (newGroups.length > 0) {
                groups = [...groups, ...newGroups];
                saveData();
                renderDirections();
                renderGroups();
                showNotification(`–°–æ–∑–¥–∞–Ω–æ ${newGroups.length} –Ω–æ–≤—ã—Ö –≥—Ä—É–ø–ø –∏–∑ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π!`, 'success');
            } else {
                showNotification('–í—Å–µ –≥—Ä—É–ø–ø—ã —É–∂–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã', 'info');
            }
        }
        
        function renderDirections(ageGroup = 'all') {
            const container = document.getElementById('directionsContainer');
            if (!container) return;
            
            container.innerHTML = '';
            
            let filteredDirections = Object.entries(directions);
            
            if (ageGroup !== 'all') {
                filteredDirections = filteredDirections.filter(([key, d]) => d.ageGroup === ageGroup);
            }
            
            const searchTerm = document.getElementById('searchDirection')?.value.toLowerCase() || '';
            if (searchTerm) {
                filteredDirections = filteredDirections.filter(([key, d]) => 
                    d.title.toLowerCase().includes(searchTerm) ||
                    d.description.toLowerCase().includes(searchTerm)
                );
            }
            
            if (filteredDirections.length === 0) {
                container.innerHTML = '<p style="text-align: center; padding: 50px; color: #636e72;">–ù–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π</p>';
                return;
            }
            
            filteredDirections.forEach(([key, direction]) => {
                const relatedGroups = groups.filter(g => g.directionKey === key);
                const groupCount = relatedGroups.length;
                const totalMembers = clients.filter(c => {
                    const group = groups.find(g => g.id === c.groupId);
                    return group && group.directionKey === key;
                }).length;
                
                const scheduleDisplay = formatScheduleFromDays(direction.scheduleDays || []);
                
                let cardColor, cardColorDark;
                switch(direction.ageGroup) {
                    case 'baby':
                    case 'kids':
                        cardColor = '#a29bfe'; cardColorDark = '#5b4fcf'; break;
                    case 'teens':
                        cardColor = '#6c5ce7'; cardColorDark = '#4a3dc7'; break;
                    case 'adult':
                    case 'adult25':
                        cardColor = '#00b894'; cardColorDark = '#00a085'; break;
                    case 'adult45':
                        cardColor = '#e17055'; cardColorDark = '#c44569'; break;
                    case 'special':
                        cardColor = '#fd79a8'; cardColorDark = '#e84393'; break;
                    default:
                        cardColor = '#a29bfe'; cardColorDark = '#5b4fcf';
                }
                
                const card = document.createElement('div');
                card.className = 'direction-card';
                card.innerHTML = `
                    <div class="direction-header direction-editor-header" style="background: linear-gradient(to right, ${cardColor}, ${cardColorDark});">
                        <div class="direction-title">${direction.title}</div>
                        <div class="direction-icon">${direction.icon || 'üíÉ'}</div>
                    </div>
                    <div class="direction-body">
                        <div class="direction-age">
                            <i class="fas fa-user"></i> ${getAgeCategoryName(direction.ageGroup)}
                            ${direction.badge ? `<span class="badge badge-special">${direction.badge}</span>` : ''}
                            <span class="auto-generate-badge"><i class="fas fa-magic"></i> –ê–≤—Ç–æ</span>
                        </div>
                        
                        <div class="direction-description">${direction.description || '–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è'}</div>
                        
                        <div class="direction-schedule">
                            <i class="fas fa-calendar-alt"></i> 
                            <strong>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ:</strong> ${scheduleDisplay}
                            <br><small>–ó–∞–ª: ${direction.room || '–ù–µ —É–∫–∞–∑–∞–Ω'}</small>
                        </div>
                        
                        <div class="direction-stats">
                            <span><i class="fas fa-users"></i> –ì—Ä—É–ø–ø: ${groupCount}</span>
                            <span><i class="fas fa-user-friends"></i> –£—á–∞—Å—Ç–Ω–∏–∫–æ–≤: ${totalMembers}</span>
                            <span><i class="fas fa-chair"></i> –ú–µ—Å—Ç: ${direction.maxMembers || 12}</span>
                        </div>
                        
                        <ul class="direction-features">
                            ${direction.features ? direction.features.slice(0, 3).map(f => `<li>${f}</li>`).join('') : ''}
                        </ul>
                        
                        <div class="direction-price">
                            <i class="fas fa-tag"></i> ${direction.price || '–£—Ç–æ—á–Ω—è–π—Ç–µ'}
                        </div>
                        
                        <div class="direction-actions">
                            <button class="btn btn-info" onclick="window.editDirection('${key}')">
                                <i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                            </button>
                            <button class="btn btn-warning" onclick="window.generateClassesForDirection('${key}')">
                                <i class="fas fa-calendar-plus"></i> –ó–∞–Ω—è—Ç–∏—è
                            </button>
                            <button class="btn btn-danger" onclick="window.deleteDirection('${key}')">
                                <i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å
                            </button>
                        </div>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }
        
        function openDirectionModal(key = null) {
            const modal = document.getElementById('directionModal');
            const title = document.getElementById('directionModalTitle');
            const form = document.getElementById('directionForm');
            
            form.reset();
            document.getElementById('directionKey').value = '';
            
            const scheduleContainer = document.getElementById('scheduleDaysContainer');
            scheduleContainer.innerHTML = '';
            
            if (key) {
                title.textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ';
                const direction = directions[key];
                
                document.getElementById('directionKey').value = key;
                document.getElementById('directionTitle').value = direction.title || '';
                document.getElementById('directionAgeGroup').value = direction.ageGroup || '';
                document.getElementById('directionIcon').value = direction.icon || '';
                document.getElementById('directionDescription').value = direction.description || '';
                document.getElementById('directionPrice').value = direction.price || '';
                document.getElementById('directionBadge').value = direction.badge || '';
                document.getElementById('directionRoom').value = direction.room || '–ó–∞–ª 1';
                document.getElementById('directionMaxMembers').value = direction.maxMembers || 12;
                document.getElementById('autoCreateGroups').checked = direction.autoCreateGroups !== false;
                
                const featuresContainer = document.getElementById('featuresContainer');
                featuresContainer.innerHTML = '';
                
                if (direction.features && direction.features.length > 0) {
                    direction.features.forEach((feature, index) => {
                        addFeatureRow(feature, index === direction.features.length - 1);
                    });
                } else {
                    addFeatureRow('');
                }
                
                if (direction.scheduleDays && direction.scheduleDays.length > 0) {
                    direction.scheduleDays.forEach(schedule => {
                        addScheduleDayRow(schedule.day, schedule.startTime, schedule.endTime);
                    });
                } else {
                    addScheduleDayRow(1, '18:00', '19:00');
                }
            } else {
                title.textContent = '–î–æ–±–∞–≤–∏—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ';
                document.getElementById('directionRoom').value = '–ó–∞–ª 1';
                document.getElementById('directionMaxMembers').value = 12;
                document.getElementById('autoCreateGroups').checked = true;
                
                addFeatureRow('');
                addScheduleDayRow(1, '18:00', '19:00');
            }
            
            updateGroupPreview();
            modal.style.display = 'block';
        }
        
        function addFeatureRow(value = '', isLast = true) {
            const container = document.getElementById('featuresContainer');
            const row = document.createElement('div');
            row.className = 'form-row';
            row.innerHTML = `
                <div class="form-col">
                    <input type="text" class="form-control feature-input" placeholder="–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è" value="${value.replace(/"/g, '&quot;')}">
                </div>
                <div class="form-col" style="flex: 0 0 100px;">
                    <button type="button" class="btn btn-success add-feature-btn" style="padding: 12px;">
                        <i class="fas fa-plus"></i>
                    </button>
                    <button type="button" class="btn btn-danger remove-feature-btn" style="padding: 12px;">
                        <i class="fas fa-minus"></i>
                    </button>
                </div>
            `;
            container.appendChild(row);
            
            row.querySelector('.add-feature-btn').addEventListener('click', () => addFeatureRow(''));
            row.querySelector('.remove-feature-btn').addEventListener('click', function() {
                if (container.children.length > 1) {
                    row.remove();
                    updateGroupPreview();
                }
            });
            
            row.querySelector('.feature-input').addEventListener('input', updateGroupPreview);
        }
        
        function addScheduleDayRow(day = 1, startTime = '18:00', endTime = '19:00') {
            const container = document.getElementById('scheduleDaysContainer');
            const row = document.createElement('div');
            row.className = 'schedule-day-row';
            
            row.innerHTML = `
                <div class="schedule-day-checkbox">
                    <select class="form-control day-select">
                        <option value="1" ${day == 1 ? 'selected' : ''}>–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫</option>
                        <option value="2" ${day == 2 ? 'selected' : ''}>–í—Ç–æ—Ä–Ω–∏–∫</option>
                        <option value="3" ${day == 3 ? 'selected' : ''}>–°—Ä–µ–¥–∞</option>
                        <option value="4" ${day == 4 ? 'selected' : ''}>–ß–µ—Ç–≤–µ—Ä–≥</option>
                        <option value="5" ${day == 5 ? 'selected' : ''}>–ü—è—Ç–Ω–∏—Ü–∞</option>
                        <option value="6" ${day == 6 ? 'selected' : ''}>–°—É–±–±–æ—Ç–∞</option>
                        <option value="0" ${day == 0 ? 'selected' : ''}>–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ</option>
                    </select>
                </div>
                <div class="schedule-time-input">
                    <input type="time" class="form-control start-time" value="${startTime}" style="width: 120px;">
                    <span>‚Äî</span>
                    <input type="time" class="form-control end-time" value="${endTime}" style="width: 120px;">
                </div>
                <button type="button" class="btn btn-danger remove-schedule-btn" style="padding: 12px;">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            container.appendChild(row);
            
            row.querySelector('.remove-schedule-btn').addEventListener('click', function() {
                row.remove();
                updateGroupPreview();
            });
            
            ['day-select', 'start-time', 'end-time'].forEach(selector => {
                const el = row.querySelector(`.${selector}`);
                if (el) el.addEventListener('change', updateGroupPreview);
            });
        }
        
        function collectScheduleDays() {
            const rows = document.querySelectorAll('.schedule-day-row');
            const scheduleDays = [];
            
            rows.forEach(row => {
                const day = parseInt(row.querySelector('.day-select').value);
                const startTime = row.querySelector('.start-time').value;
                const endTime = row.querySelector('.end-time').value;
                
                if (startTime && endTime) {
                    scheduleDays.push({ day, startTime, endTime });
                }
            });
            
            return scheduleDays;
        }
        
        function updateGroupPreview() {
            const title = document.getElementById('directionTitle').value;
            const room = document.getElementById('directionRoom').value;
            const maxMembers = document.getElementById('directionMaxMembers').value;
            const scheduleDays = collectScheduleDays();
            
            const preview = document.getElementById('groupPreview');
            const previewName = document.getElementById('previewGroupName');
            const previewSchedule = document.getElementById('previewSchedule');
            const previewRoom = document.getElementById('previewRoom');
            const previewMaxMembers = document.getElementById('previewMaxMembers');
            
            if (title && scheduleDays.length > 0) {
                preview.style.display = 'block';
                previewName.textContent = title;
                previewSchedule.textContent = formatScheduleFromDays(scheduleDays);
                previewRoom.textContent = room || '–ó–∞–ª 1';
                previewMaxMembers.textContent = maxMembers || 12;
            } else {
                preview.style.display = 'none';
            }
        }
        
        function saveDirection(event) {
            event.preventDefault();
            
            const key = document.getElementById('directionKey').value;
            const title = document.getElementById('directionTitle').value;
            const ageGroup = document.getElementById('directionAgeGroup').value;
            const icon = document.getElementById('directionIcon').value || 'üíÉ';
            const description = document.getElementById('directionDescription').value;
            const price = document.getElementById('directionPrice').value;
            const badge = document.getElementById('directionBadge').value;
            const room = document.getElementById('directionRoom').value || '–ó–∞–ª 1';
            const maxMembers = parseInt(document.getElementById('directionMaxMembers').value) || 12;
            const autoCreateGroups = document.getElementById('autoCreateGroups').checked;
            
            if (!title || !ageGroup) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è!', 'error');
                return;
            }
            
            const features = [];
            document.querySelectorAll('.feature-input').forEach(input => {
                if (input.value.trim()) {
                    features.push(input.value.trim());
                }
            });
            
            const scheduleDays = collectScheduleDays();
            
            const newKey = key || title.toLowerCase().replace(/[^a-z–∞-—è—ë0-9]/gi, '-').replace(/-+/g, '-').replace(/^-|-$/g, '');
            
            directions[newKey] = {
                id: newKey,
                title,
                ageGroup,
                icon,
                description,
                price: price || '–£—Ç–æ—á–Ω—è–π—Ç–µ',
                features: features.length > 0 ? features : ['–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ'],
                badge,
                room,
                maxMembers,
                scheduleDays,
                schedule: formatScheduleFromDays(scheduleDays),
                autoCreateGroups,
                updatedAt: new Date().toISOString(),
                createdAt: directions[newKey]?.createdAt || new Date().toISOString()
            };
            
            if (!key && autoCreateGroups) {
                syncGroupsWithDirections();
            }
            
            saveData();
            renderDirections();
            
            closeModal('directionModal');
            showNotification('–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ!', 'success');
        }
        
        function editDirection(key) {
            openDirectionModal(key);
        }
        
        function deleteDirection(key) {
            if (confirm(`–£–¥–∞–ª–∏—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ "${directions[key]?.title}"?`)) {
                const relatedGroups = groups.filter(g => g.directionKey === key);
                
                if (relatedGroups.length > 0) {
                    if (!confirm(`–° –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º —Å–≤—è–∑–∞–Ω–æ ${relatedGroups.length} –≥—Ä—É–ø–ø(—ã). –£–¥–∞–ª–∏—Ç—å –∏—Ö —Ç–æ–∂–µ?`)) {
                        return;
                    }
                    
                    relatedGroups.forEach(group => {
                        classes = classes.filter(c => c.groupId !== group.id);
                    });
                    groups = groups.filter(g => g.directionKey !== key);
                }
                
                delete directions[key];
                saveData();
                renderDirections();
                renderGroups();
                renderCalendar(currentCalendarDate);
                
                showNotification('–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ!', 'success');
            }
        }
        
        function generateClassesForDirection(key) {
            const direction = directions[key];
            const relatedGroups = groups.filter(g => g.directionKey === key);
            
            if (relatedGroups.length === 0) {
                showNotification('–£ —ç—Ç–æ–≥–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ—Ç –≥—Ä—É–ø–ø', 'warning');
                return;
            }
            
            const today = new Date();
            const firstDay = new Date(today.getFullYear(), today.getMonth(), 1);
            const lastDay = new Date(today.getFullYear(), today.getMonth() + 1, 0);
            
            let addedCount = 0;
            
            relatedGroups.forEach(group => {
                const scheduleDays = group.scheduleDays || [];
                
                let currentDate = new Date(firstDay);
                while (currentDate <= lastDay) {
                    const dayOfWeek = currentDate.getDay();
                    const dateStr = currentDate.toISOString().split('T')[0];
                    
                    scheduleDays.forEach(schedule => {
                        if (schedule.day === dayOfWeek) {
                            const exists = classes.some(c => 
                                c.date === dateStr && 
                                c.groupId === group.id &&
                                c.startTime === schedule.startTime
                            );
                            
                            if (!exists) {
                                classes.push({
                                    id: nextClassId++,
                                    date: dateStr,
                                    startTime: schedule.startTime,
                                    endTime: schedule.endTime,
                                    groupId: group.id,
                                    trainerId: group.trainerId,
                                    room: group.room,
                                    notes: `–ê–≤—Ç–æ: ${direction.title}`,
                                    directionKey: key
                                });
                                addedCount++;
                            }
                        }
                    });
                    
                    currentDate.setDate(currentDate.getDate() + 1);
                }
            });
            
            saveData();
            renderCalendar(currentCalendarDate);
            
            showNotification(`–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ ${addedCount} –∑–∞–Ω—è—Ç–∏–π –¥–ª—è "${direction.title}"`, 'success');
        }
        
        // ===== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ö–ê–õ–ï–ù–î–ê–†–Ø =====
        
        function renderCalendar(date) {
            const grid = document.getElementById('calendarGrid');
            const monthTitle = document.getElementById('calendarMonth');
            if (!grid || !monthTitle) return;
            
            monthTitle.textContent = `${months[date.getMonth()]} ${date.getFullYear()}`;
            grid.innerHTML = '';
            
            daysOfWeek.forEach(day => {
                const header = document.createElement('div');
                header.className = 'calendar-day-header';
                header.textContent = day;
                grid.appendChild(header);
            });
            
            const firstDay = new Date(date.getFullYear(), date.getMonth(), 1);
            const startDay = new Date(firstDay);
            startDay.setDate(startDay.getDate() - startDay.getDay());
            
            const lastDay = new Date(date.getFullYear(), date.getMonth() + 1, 0);
            const endDay = new Date(lastDay);
            endDay.setDate(endDay.getDate() + (6 - endDay.getDay()));
            
            const currentDay = new Date(startDay);
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            while (currentDay <= endDay) {
                const dayEl = document.createElement('div');
                dayEl.className = 'calendar-day';
                
                const checkDate = new Date(currentDay);
                checkDate.setHours(0, 0, 0, 0);
                
                if (checkDate.getTime() === today.getTime()) {
                    dayEl.classList.add('today');
                }
                
                if (currentDay.getDay() === 0 || currentDay.getDay() === 6) {
                    dayEl.classList.add('weekend');
                }
                
                if (currentDay.getMonth() !== date.getMonth()) {
                    dayEl.style.opacity = '0.5';
                }
                
                const dayNumber = document.createElement('div');
                dayNumber.className = 'day-number';
                dayNumber.textContent = currentDay.getDate();
                dayEl.appendChild(dayNumber);
                
                const events = document.createElement('div');
                events.className = 'day-events';
                
                const dateStr = currentDay.toISOString().split('T')[0];
                const dayClasses = classes.filter(c => c.date === dateStr);
                
                dayClasses.slice(0, 3).forEach(cls => {
                    const group = groups.find(g => g.id === cls.groupId);
                    if (group) {
                        const eventEl = document.createElement('div');
                        eventEl.className = `event-item event-beginner`;
                        eventEl.textContent = `${group.name} (${cls.startTime})`;
                        eventEl.onclick = (e) => {
                            e.stopPropagation();
                            openDayModal(currentDay, dayClasses);
                        };
                        events.appendChild(eventEl);
                    }
                });
                
                if (dayClasses.length > 3) {
                    const moreEl = document.createElement('div');
                    moreEl.className = 'event-more';
                    moreEl.textContent = `+${dayClasses.length - 3} –µ—â–µ`;
                    moreEl.onclick = (e) => {
                        e.stopPropagation();
                        openDayModal(currentDay, dayClasses);
                    };
                    events.appendChild(moreEl);
                }
                
                dayEl.appendChild(events);
                dayEl.onclick = () => {
                    if (dayClasses.length > 0) {
                        openDayModal(currentDay, dayClasses);
                    }
                };
                
                grid.appendChild(dayEl);
                currentDay.setDate(currentDay.getDate() + 1);
            }
            
            document.getElementById('totalClassesCount').textContent = classes.length;
        }
        
        function openDayModal(date, dayClasses) {
            const modal = document.getElementById('dayModal');
            const modalDate = document.getElementById('modalDate');
            const dayEvents = document.getElementById('dayEvents');
            
            modalDate.textContent = formatDate(date);
            dayEvents.innerHTML = '';
            
            if (dayClasses.length === 0) {
                dayEvents.innerHTML = '<p style="text-align: center; padding: 30px;">–ù–µ—Ç –∑–∞–Ω—è—Ç–∏–π</p>';
            } else {
                dayClasses.forEach(cls => {
                    const group = groups.find(g => g.id === cls.groupId);
                    const trainer = trainers.find(t => t.id === cls.trainerId);
                    
                    if (group) {
                        const eventDiv = document.createElement('div');
                        eventDiv.className = 'group-card';
                        eventDiv.style.marginBottom = '15px';
                        eventDiv.innerHTML = `
                            <div class="group-header" style="background: linear-gradient(to right, #a29bfe, #6c5ce7);">
                                <div class="group-title">${group.name}</div>
                                <div class="group-level">${cls.startTime} - ${cls.endTime}</div>
                            </div>
                            <div class="group-body">
                                <p><strong>–¢—Ä–µ–Ω–µ—Ä:</strong> ${trainer ? `${trainer.firstName} ${trainer.lastName}` : '–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω'}</p>
                                <p><strong>–ó–∞–ª:</strong> ${cls.room}</p>
                                <p><strong>–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤:</strong> ${clients.filter(c => c.groupId === group.id).length}</p>
                                ${cls.notes ? `<p><strong>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</strong> ${cls.notes}</p>` : ''}
                            </div>
                            <div class="group-footer">
                                <button class="btn btn-info" onclick="window.openClassModal(${cls.id})">
                                    <i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                                </button>
                                <button class="btn btn-danger" onclick="window.deleteClass(${cls.id})">
                                    <i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å
                                </button>
                            </div>
                        `;
                        dayEvents.appendChild(eventDiv);
                    }
                });
            }
            
            modal.style.display = 'block';
        }
        
        // ===== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ì–†–£–ü–ü =====
        
        function renderGroups() {
            const container = document.getElementById('groupsContainer');
            if (!container) return;
            
            container.innerHTML = '';
            
            const levelFilter = document.getElementById('filterGroupLevel')?.value || 'all';
            const directionFilter = document.getElementById('filterGroupDirection')?.value || 'all';
            
            let filteredGroups = groups;
            
            if (levelFilter !== 'all') {
                filteredGroups = filteredGroups.filter(g => g.level === levelFilter);
            }
            
            if (directionFilter !== 'all') {
                filteredGroups = filteredGroups.filter(g => g.directionKey === directionFilter);
            }
            
            const searchTerm = document.getElementById('searchGroups')?.value.toLowerCase() || '';
            if (searchTerm) {
                filteredGroups = filteredGroups.filter(g => 
                    g.name.toLowerCase().includes(searchTerm) ||
                    g.description?.toLowerCase().includes(searchTerm)
                );
            }
            
            if (filteredGroups.length === 0) {
                container.innerHTML = '<p style="text-align: center; padding: 50px;">–ù–µ—Ç –≥—Ä—É–ø–ø</p>';
                return;
            }
            
            filteredGroups.forEach(group => {
                const trainer = trainers.find(t => t.id === group.trainerId);
                const direction = directions[group.directionKey];
                const members = clients.filter(c => c.groupId === group.id);
                
                const card = document.createElement('div');
                card.className = 'group-card';
                card.innerHTML = `
                    <div class="group-header" style="background: linear-gradient(to right, #a29bfe, #6c5ce7);">
                        <div class="group-title">${group.name}</div>
                        <div class="group-level">${getLevelName(group.level)}</div>
                    </div>
                    <div class="group-body">
                        <div class="group-info">
                            <div class="group-trainer">
                                <i class="fas fa-chalkboard-teacher"></i> ${trainer ? `${trainer.firstName} ${trainer.lastName}` : '–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω'}
                            </div>
                            <div class="group-time">
                                <i class="fas fa-clock"></i> ${group.time || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}
                            </div>
                            <div class="group-room">
                                <i class="fas fa-map-marker-alt"></i> ${group.room}
                            </div>
                        </div>
                        ${direction ? `
                            <div style="margin-bottom: 15px; padding: 10px; background: #f0f7ff; border-radius: 5px;">
                                <small><i class="fas fa-directions"></i> –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: ${direction.title}</small>
                            </div>
                        ` : ''}
                        <div class="group-members">
                            ${members.length > 0 ? members.map(m => {
                                const fullName = `${m.lastName} ${m.firstName} ${m.middleName || ''}`.trim();
                                return `
                                    <div class="group-member">
                                        <span>${fullName}</span>
                                        <span class="member-status status-${m.subscription || 'active'}">
                                            ${m.subscription === 'active' ? '–ê–∫—Ç–∏–≤–µ–Ω' : m.subscription === 'expiring' ? '–ó–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è' : '–ü—Ä–æ—Å—Ä–æ—á–µ–Ω'}
                                        </span>
                                    </div>
                                `;
                            }).join('') : '<p style="text-align: center; padding: 20px;">–ù–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</p>'}
                        </div>
                    </div>
                    <div class="group-footer">
                        <div class="group-count">${members.length} –∏–∑ ${group.maxMembers || 12}</div>
                        <div class="action-buttons">
                            <button class="action-btn edit-btn" onclick="window.editGroup(${group.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete-btn" onclick="window.deleteGroup(${group.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }
        
        function openGroupModal(id = null) {
            const modal = document.getElementById('groupModal');
            const title = document.getElementById('groupModalTitle');
            const form = document.getElementById('groupForm');
            const directionSelect = document.getElementById('groupDirection');
            
            directionSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</option>';
            Object.keys(directions).forEach(key => {
                const d = directions[key];
                directionSelect.innerHTML += `<option value="${key}">${d.title} (${getAgeCategoryName(d.ageGroup)})</option>`;
            });
            
            const trainerSelect = document.getElementById('groupTrainer');
            trainerSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç—Ä–µ–Ω–µ—Ä–∞</option>';
            trainers.forEach(t => {
                trainerSelect.innerHTML += `<option value="${t.id}">${t.lastName} ${t.firstName}</option>`;
            });
            
            if (id) {
                title.textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –≥—Ä—É–ø–ø—É';
                const group = groups.find(g => g.id === id);
                
                document.getElementById('groupId').value = group.id;
                document.getElementById('groupDirection').value = group.directionKey || '';
                document.getElementById('groupName').value = group.name;
                document.getElementById('groupLevel').value = group.level || 'beginner';
                document.getElementById('groupTrainer').value = group.trainerId || '';
                document.getElementById('groupMaxMembers').value = group.maxMembers || 12;
                document.getElementById('groupSchedule').value = group.time || '';
                document.getElementById('groupRoom').value = group.room || '';
                document.getElementById('groupDescription').value = group.description || '';
                document.getElementById('autoGenerateClasses').checked = group.autoGenerate !== false;
            } else {
                title.textContent = '–î–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–ø–ø—É';
                form.reset();
                document.getElementById('groupId').value = '';
                document.getElementById('groupMaxMembers').value = 12;
                document.getElementById('autoGenerateClasses').checked = true;
            }
            
            modal.style.display = 'block';
        }
        
        function saveGroup(event) {
            event.preventDefault();
            
            const id = document.getElementById('groupId').value;
            const name = document.getElementById('groupName').value;
            const directionKey = document.getElementById('groupDirection').value;
            const level = document.getElementById('groupLevel').value;
            const trainerId = parseInt(document.getElementById('groupTrainer').value);
            const maxMembers = parseInt(document.getElementById('groupMaxMembers').value);
            const time = document.getElementById('groupSchedule').value;
            const room = document.getElementById('groupRoom').value;
            const description = document.getElementById('groupDescription').value;
            const autoGenerate = document.getElementById('autoGenerateClasses').checked;
            
            if (!name || !directionKey || !level || !trainerId || !time || !room) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è!', 'error');
                return;
            }
            
            const scheduleDays = [];
            const timeMatch = time.match(/(\d{1,2}:\d{2})-(\d{1,2}:\d{2})/);
            const startTime = timeMatch ? timeMatch[1] : '18:00';
            const endTime = timeMatch ? timeMatch[2] : '19:00';
            
            const dayMap = { '–ø–Ω':1, '–≤—Ç':2, '—Å—Ä':3, '—á—Ç':4, '–ø—Ç':5, '—Å–±':6, '–≤—Å':0 };
            Object.keys(dayMap).forEach(dayKey => {
                if (time.toLowerCase().includes(dayKey)) {
                    scheduleDays.push({ day: dayMap[dayKey], startTime, endTime });
                }
            });
            
            if (id) {
                const index = groups.findIndex(g => g.id == id);
                if (index !== -1) {
                    groups[index] = {
                        ...groups[index],
                        name, directionKey, level, trainerId, maxMembers, time, room, description,
                        scheduleDays, autoGenerate
                    };
                }
            } else {
                groups.push({
                    id: nextGroupId++,
                    name, directionKey, level, trainerId, maxMembers, time, room, description,
                    scheduleDays, autoGenerate,
                    createdAt: new Date().toISOString()
                });
            }
            
            saveData();
            
            if (autoGenerate) {
                const today = new Date();
                const firstDay = new Date(today.getFullYear(), today.getMonth(), 1);
                const lastDay = new Date(today.getFullYear(), today.getMonth() + 1, 0);
                
                let currentDate = new Date(firstDay);
                while (currentDate <= lastDay) {
                    const dayOfWeek = currentDate.getDay();
                    const dateStr = currentDate.toISOString().split('T')[0];
                    
                    scheduleDays.forEach(schedule => {
                        if (schedule.day === dayOfWeek) {
                            const exists = classes.some(c => 
                                c.date === dateStr && 
                                c.groupId === (id ? parseInt(id) : nextGroupId - 1) &&
                                c.startTime === schedule.startTime
                            );
                            
                            if (!exists) {
                                classes.push({
                                    id: nextClassId++,
                                    date: dateStr,
                                    startTime: schedule.startTime,
                                    endTime: schedule.endTime,
                                    groupId: id ? parseInt(id) : nextGroupId - 1,
                                    trainerId,
                                    room,
                                    notes: `–ê–≤—Ç–æ: ${name}`,
                                    directionKey
                                });
                            }
                        }
                    });
                    
                    currentDate.setDate(currentDate.getDate() + 1);
                }
            }
            
            saveData();
            renderGroups();
            renderCalendar(currentCalendarDate);
            
            closeModal('groupModal');
            showNotification('–ì—Ä—É–ø–ø–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!', 'success');
        }
        
        function editGroup(id) {
            openGroupModal(id);
        }
        
        function deleteGroup(id) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å –≥—Ä—É–ø–ø—É?')) {
                clients = clients.map(c => {
                    if (c.groupId === id) return { ...c, groupId: null };
                    return c;
                });
                classes = classes.filter(c => c.groupId !== id);
                groups = groups.filter(g => g.id !== id);
                
                saveData();
                renderGroups();
                renderCalendar(currentCalendarDate);
                showNotification('–ì—Ä—É–ø–ø–∞ —É–¥–∞–ª–µ–Ω–∞!', 'success');
            }
        }
        
        function onGroupDirectionChange() {
            const key = document.getElementById('groupDirection').value;
            const scheduleField = document.getElementById('groupSchedule');
            const scheduleHint = document.getElementById('scheduleFromDirection');
            
            if (key && directions[key]) {
                const direction = directions[key];
                const scheduleStr = formatScheduleFromDays(direction.scheduleDays || []);
                
                if (scheduleStr && !scheduleField.value) {
                    scheduleField.value = scheduleStr;
                    scheduleHint.style.display = 'block';
                }
                
                const roomField = document.getElementById('groupRoom');
                if (direction.room && !roomField.value) {
                    roomField.value = direction.room;
                }
                
                const maxField = document.getElementById('groupMaxMembers');
                if (direction.maxMembers && !maxField.value) {
                    maxField.value = direction.maxMembers;
                }
            } else {
                scheduleHint.style.display = 'none';
            }
        }
        
        // ===== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –¢–†–ï–ù–ï–†–û–í =====
        
        function renderTrainers() {
            const table = document.getElementById('trainersTable');
            if (!table) return;
            
            table.innerHTML = '';
            
            trainers.forEach(t => {
                const row = document.createElement('tr');
                const fullName = `${t.lastName} ${t.firstName} ${t.middleName || ''}`.trim();
                const trainerGroups = groups.filter(g => t.groups && t.groups.includes(g.id));
                const groupNames = trainerGroups.map(g => g.name).join(', ') || '–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω—ã';
                
                row.innerHTML = `
                    <td>${t.id}</td>
                    <td><strong>${fullName}</strong></td>
                    <td>${t.specialization}</td>
                    <td>${t.phone}</td>
                    <td>${t.email || '-'}</td>
                    <td>${t.experience || 0}</td>
                    <td>${groupNames}</td>
                    <td><span class="status-active">${t.status === 'active' ? '–ê–∫—Ç–∏–≤–Ω—ã–π' : t.status === 'vacation' ? '–í –æ—Ç–ø—É—Å–∫–µ' : '–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–π'}</span></td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn edit-btn" onclick="window.editTrainer(${t.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete-btn" onclick="window.deleteTrainer(${t.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                table.appendChild(row);
            });
        }
        
        function openTrainerModal(id = null) {
            const modal = document.getElementById('trainerModal');
            const title = document.getElementById('trainerModalTitle');
            const form = document.getElementById('trainerForm');
            const groupsSelect = document.getElementById('trainerGroups');
            
            groupsSelect.innerHTML = '';
            groups.forEach(g => {
                groupsSelect.innerHTML += `<option value="${g.id}">${g.name}</option>`;
            });
            
            if (id) {
                title.textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–µ–Ω–µ—Ä–∞';
                const trainer = trainers.find(t => t.id === id);
                
                document.getElementById('trainerId').value = trainer.id;
                document.getElementById('trainerLastName').value = trainer.lastName;
                document.getElementById('trainerFirstName').value = trainer.firstName;
                document.getElementById('trainerMiddleName').value = trainer.middleName || '';
                document.getElementById('trainerSpecialization').value = trainer.specialization;
                document.getElementById('trainerPhone').value = trainer.phone;
                document.getElementById('trainerEmail').value = trainer.email || '';
                document.getElementById('trainerExperience').value = trainer.experience || '';
                document.getElementById('trainerStatus').value = trainer.status || 'active';
                
                Array.from(groupsSelect.options).forEach(opt => {
                    opt.selected = trainer.groups && trainer.groups.includes(parseInt(opt.value));
                });
            } else {
                title.textContent = '–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ–Ω–µ—Ä–∞';
                form.reset();
                document.getElementById('trainerId').value = '';
                document.getElementById('trainerStatus').value = 'active';
            }
            
            modal.style.display = 'block';
        }
        
        function saveTrainer(event) {
            event.preventDefault();
            
            const id = document.getElementById('trainerId').value;
            const lastName = document.getElementById('trainerLastName').value;
            const firstName = document.getElementById('trainerFirstName').value;
            const middleName = document.getElementById('trainerMiddleName').value;
            const specialization = document.getElementById('trainerSpecialization').value;
            const phone = document.getElementById('trainerPhone').value;
            const email = document.getElementById('trainerEmail').value;
            const experience = document.getElementById('trainerExperience').value;
            const status = document.getElementById('trainerStatus').value;
            
            if (!lastName || !firstName || !specialization || !phone) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è!', 'error');
                return;
            }
            
            const groupsSelect = document.getElementById('trainerGroups');
            const selectedGroups = Array.from(groupsSelect.selectedOptions).map(opt => parseInt(opt.value));
            
            if (id) {
                const index = trainers.findIndex(t => t.id == id);
                if (index !== -1) {
                    trainers[index] = {
                        ...trainers[index],
                        lastName, firstName, middleName, specialization, phone, email,
                        experience: parseInt(experience) || 0,
                        groups: selectedGroups, status
                    };
                }
            } else {
                trainers.push({
                    id: nextTrainerId++,
                    lastName, firstName, middleName, specialization, phone, email,
                    experience: parseInt(experience) || 0,
                    groups: selectedGroups, status
                });
            }
            
            saveData();
            renderTrainers();
            closeModal('trainerModal');
            showNotification('–¢—Ä–µ–Ω–µ—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω!', 'success');
        }
        
        function editTrainer(id) {
            openTrainerModal(id);
        }
        
        function deleteTrainer(id) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å —Ç—Ä–µ–Ω–µ—Ä–∞?')) {
                trainers = trainers.filter(t => t.id !== id);
                saveData();
                renderTrainers();
                showNotification('–¢—Ä–µ–Ω–µ—Ä —É–¥–∞–ª–µ–Ω!', 'success');
            }
        }
        
        // ===== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ö–õ–ò–ï–ù–¢–û–í =====
        
        function renderClients() {
            const table = document.getElementById('clientsTable');
            if (!table) return;
            
            table.innerHTML = '';
            
            updateClientFilters();
            
            const groupFilter = document.getElementById('filterClientGroup')?.value || 'all';
            const typeFilter = document.getElementById('filterClientType')?.value || 'all';
            
            const filtered = clients.filter(c => {
                if (groupFilter !== 'all' && c.groupId !== parseInt(groupFilter)) return false;
                if (typeFilter !== 'all' && c.clientType !== typeFilter) return false;
                return true;
            });
            
            filtered.forEach(c => {
                const row = document.createElement('tr');
                const fullName = `${c.lastName} ${c.firstName} ${c.middleName || ''}`.trim();
                const group = groups.find(g => g.id === c.groupId);
                const subscription = subscriptions.find(s => s.clientId === c.id);
                
                let parentInfo = '-';
                if ((c.clientType === 'child' || c.clientType === 'teen') && c.parentLastName) {
                    parentInfo = `${c.parentLastName} ${c.parentFirstName || ''}<br><small>${c.parentPhone || ''}</small>`;
                }
                
                row.innerHTML = `
                    <td>${c.id}</td>
                    <td><strong>${fullName}</strong></td>
                    <td>${getAgeCategoryName(c.clientType)}</td>
                    <td>${c.age || (c.birthDate ? new Date().getFullYear() - new Date(c.birthDate).getFullYear() : '-')}</td>
                    <td>${c.phone || '-'}</td>
                    <td>${parentInfo}</td>
                    <td>${group ? group.name : '–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∞'}</td>
                    <td>${subscription ? subscription.type : '–ù–µ—Ç'}</td>
                    <td><span class="status-${c.subscription || 'active'}">${c.subscription === 'active' ? '–ê–∫—Ç–∏–≤–µ–Ω' : c.subscription === 'expiring' ? '–ó–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è' : '–ü—Ä–æ—Å—Ä–æ—á–µ–Ω'}</span></td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn edit-btn" onclick="window.editClient(${c.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete-btn" onclick="window.deleteClient(${c.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                table.appendChild(row);
            });
        }
        
        function updateClientFilters() {
            const groupFilter = document.getElementById('filterClientGroup');
            if (groupFilter) {
                groupFilter.innerHTML = '<option value="all">–í—Å–µ –≥—Ä—É–ø–ø—ã</option>';
                groups.forEach(g => {
                    groupFilter.innerHTML += `<option value="${g.id}">${g.name}</option>`;
                });
            }
        }
        
        function toggleClientFields() {
            const type = document.getElementById('clientType').value;
            const childFields = document.getElementById('childFields');
            const adultFields = document.getElementById('adultFields');
            const specialFields = document.getElementById('specialFields');
            
            childFields.style.display = 'none';
            adultFields.style.display = 'none';
            specialFields.style.display = 'none';
            
            document.getElementById('clientAge').required = false;
            document.getElementById('parentLastName').required = false;
            document.getElementById('parentFirstName').required = false;
            document.getElementById('parentPhone').required = false;
            document.getElementById('clientPhone').required = false;
            
            if (type === 'child' || type === 'teen') {
                childFields.style.display = 'block';
                document.getElementById('clientAge').required = true;
                document.getElementById('parentLastName').required = true;
                document.getElementById('parentFirstName').required = true;
                document.getElementById('parentPhone').required = true;
            } else if (type === 'adult' || type === 'adult45') {
                adultFields.style.display = 'block';
                document.getElementById('clientPhone').required = true;
            } else if (type === 'special') {
                specialFields.style.display = 'block';
                document.getElementById('clientPhone').required = true;
            }
        }
        
        function openClientModal(id = null) {
            const modal = document.getElementById('clientModal');
            const title = document.getElementById('clientModalTitle');
            const form = document.getElementById('clientForm');
            const groupSelect = document.getElementById('clientGroup');
            
            groupSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≥—Ä—É–ø–ø—É</option>';
            groups.forEach(g => {
                groupSelect.innerHTML += `<option value="${g.id}">${g.name}</option>`;
            });
            
            window.toggleClientFields = toggleClientFields;
            
            if (id) {
                title.textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–∞';
                const client = clients.find(c => c.id === id);
                
                document.getElementById('clientId').value = client.id;
                document.getElementById('clientType').value = client.clientType || 'adult';
                toggleClientFields();
                
                document.getElementById('clientLastName').value = client.lastName;
                document.getElementById('clientFirstName').value = client.firstName;
                document.getElementById('clientMiddleName').value = client.middleName || '';
                
                if (client.clientType === 'child' || client.clientType === 'teen') {
                    document.getElementById('clientAge').value = client.age || '';
                    document.getElementById('parentLastName').value = client.parentLastName || '';
                    document.getElementById('parentFirstName').value = client.parentFirstName || '';
                    document.getElementById('parentPhone').value = client.parentPhone || '';
                } else {
                    document.getElementById('clientBirthDate').value = client.birthDate || '';
                    document.getElementById('clientPhone').value = client.phone || '';
                    document.getElementById('clientEmail').value = client.email || '';
                }
                
                document.getElementById('clientGroup').value = client.groupId || '';
            } else {
                title.textContent = '–î–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞';
                form.reset();
                document.getElementById('clientId').value = '';
                document.getElementById('clientType').value = 'adult';
                toggleClientFields();
            }
            
            modal.style.display = 'block';
        }
        
        function saveClient(event) {
            event.preventDefault();
            
            const id = document.getElementById('clientId').value;
            const clientType = document.getElementById('clientType').value;
            const lastName = document.getElementById('clientLastName').value;
            const firstName = document.getElementById('clientFirstName').value;
            const middleName = document.getElementById('clientMiddleName').value;
            const groupId = document.getElementById('clientGroup').value;
            
            if (!lastName || !firstName || !clientType || !groupId) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è!', 'error');
                return;
            }
            
            const today = new Date().toISOString().split('T')[0];
            
            let clientData = {
                lastName, firstName, middleName, clientType,
                groupId: parseInt(groupId),
                regDate: today,
                subscription: 'active',
                subscriptionEnd: '',
                classesLeft: 0
            };
            
            if (clientType === 'child' || clientType === 'teen') {
                clientData.age = parseInt(document.getElementById('clientAge').value) || null;
                clientData.parentLastName = document.getElementById('parentLastName').value;
                clientData.parentFirstName = document.getElementById('parentFirstName').value;
                clientData.parentPhone = document.getElementById('parentPhone').value;
                clientData.phone = document.getElementById('parentPhone').value;
                clientData.birthDate = null;
            } else {
                clientData.age = null;
                clientData.parentLastName = null;
                clientData.parentFirstName = null;
                clientData.parentPhone = null;
                clientData.phone = document.getElementById('clientPhone').value;
                clientData.birthDate = document.getElementById('clientBirthDate').value || null;
                clientData.email = document.getElementById('clientEmail').value || '';
            }
            
            if (id) {
                const index = clients.findIndex(c => c.id == id);
                if (index !== -1) {
                    clients[index] = { ...clients[index], ...clientData };
                }
            } else {
                clients.push({ id: nextClientId++, ...clientData });
            }
            
            saveData();
            renderClients();
            closeModal('clientModal');
            showNotification('–ö–ª–∏–µ–Ω—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω!', 'success');
        }
        
        function editClient(id) {
            openClientModal(id);
        }
        
        function deleteClient(id) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞?')) {
                clients = clients.filter(c => c.id !== id);
                subscriptions = subscriptions.filter(s => s.clientId !== id);
                saveData();
                renderClients();
                showNotification('–ö–ª–∏–µ–Ω—Ç —É–¥–∞–ª–µ–Ω!', 'success');
            }
        }
        
        // ===== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ê–ë–û–ù–ï–ú–ï–ù–¢–û–í =====
        
        function renderSubscriptions() {
            const table = document.getElementById('subscriptionsTable');
            if (!table) return;
            
            table.innerHTML = '';
            
            const statusFilter = document.getElementById('filterSubscriptionStatus')?.value || 'all';
            const typeFilter = document.getElementById('filterSubscriptionType')?.value || 'all';
            
            updateSubscriptionTypeFilter();
            
            const filtered = subscriptions.filter(s => {
                if (statusFilter !== 'all' && s.status !== statusFilter) return false;
                if (typeFilter !== 'all' && s.type !== typeFilter) return false;
                return true;
            });
            
            filtered.forEach(s => {
                const row = document.createElement('tr');
                const client = clients.find(c => c.id === s.clientId);
                const group = groups.find(g => g.id === s.groupId);
                
                row.innerHTML = `
                    <td>${s.id}</td>
                    <td>${client ? `${client.lastName} ${client.firstName}` : '–ù–µ–∏–∑–≤–µ—Å—Ç–µ–Ω'}</td>
                    <td>${group ? group.name : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞'}</td>
                    <td>${s.type}</td>
                    <td>${s.startDate || '-'}</td>
                    <td>${s.endDate || '-'}</td>
                    <td>${s.classes || '‚àû'}</td>
                    <td><span class="status-${s.status}">${s.status === 'active' ? '–ê–∫—Ç–∏–≤–µ–Ω' : s.status === 'expiring' ? '–ó–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è' : '–ü—Ä–æ—Å—Ä–æ—á–µ–Ω'}</span></td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn edit-btn" onclick="window.editSubscription(${s.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete-btn" onclick="window.deleteSubscription(${s.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                table.appendChild(row);
            });
        }
        
        function updateSubscriptionTypeFilter() {
            const filter = document.getElementById('filterSubscriptionType');
            if (filter) {
                filter.innerHTML = '<option value="all">–í—Å–µ —Ç–∏–ø—ã</option>';
                const types = [...new Set(subscriptions.map(s => s.type))];
                types.forEach(t => {
                    filter.innerHTML += `<option value="${t}">${t}</option>`;
                });
            }
        }
        
        function openSubscriptionModal(id = null) {
            const modal = document.getElementById('subscriptionModal');
            const title = document.getElementById('subscriptionModalTitle');
            const form = document.getElementById('subscriptionForm');
            
            const clientSelect = document.getElementById('subscriptionClient');
            clientSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∏–µ–Ω—Ç–∞</option>';
            clients.forEach(c => {
                clientSelect.innerHTML += `<option value="${c.id}">${c.lastName} ${c.firstName}</option>`;
            });
            
            const groupSelect = document.getElementById('subscriptionGroup');
            groupSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≥—Ä—É–ø–ø—É</option>';
            groups.forEach(g => {
                groupSelect.innerHTML += `<option value="${g.id}">${g.name}</option>`;
            });
            
            if (id) {
                title.textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç';
                const sub = subscriptions.find(s => s.id === id);
                
                document.getElementById('subscriptionId').value = sub.id;
                document.getElementById('subscriptionClient').value = sub.clientId;
                document.getElementById('subscriptionGroup').value = sub.groupId;
                document.getElementById('subscriptionType').value = sub.type;
                document.getElementById('subscriptionStart').value = sub.startDate;
                document.getElementById('subscriptionEnd').value = sub.endDate;
                document.getElementById('subscriptionPrice').value = sub.price || '';
                document.getElementById('subscriptionClasses').value = sub.classes || '';
                document.getElementById('subscriptionStatus').value = sub.status;
            } else {
                title.textContent = '–î–æ–±–∞–≤–∏—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç';
                form.reset();
                document.getElementById('subscriptionId').value = '';
                
                const today = new Date().toISOString().split('T')[0];
                const monthLater = new Date();
                monthLater.setMonth(monthLater.getMonth() + 1);
                
                document.getElementById('subscriptionStart').value = today;
                document.getElementById('subscriptionEnd').value = monthLater.toISOString().split('T')[0];
                document.getElementById('subscriptionStatus').value = 'active';
            }
            
            modal.style.display = 'block';
        }
        
        function saveSubscription(event) {
            event.preventDefault();
            
            const id = document.getElementById('subscriptionId').value;
            const clientId = parseInt(document.getElementById('subscriptionClient').value);
            const groupId = parseInt(document.getElementById('subscriptionGroup').value);
            const type = document.getElementById('subscriptionType').value;
            const startDate = document.getElementById('subscriptionStart').value;
            const endDate = document.getElementById('subscriptionEnd').value;
            const price = document.getElementById('subscriptionPrice').value;
            const classesCount = document.getElementById('subscriptionClasses').value;
            const status = document.getElementById('subscriptionStatus').value;
            
            if (!clientId || !groupId || !type || !startDate || !endDate) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è!', 'error');
                return;
            }
            
            if (id) {
                const index = subscriptions.findIndex(s => s.id == id);
                if (index !== -1) {
                    subscriptions[index] = {
                        id: parseInt(id), clientId, groupId, type, startDate, endDate,
                        price: price ? parseInt(price) : 0,
                        classes: classesCount ? parseInt(classesCount) : null,
                        status
                    };
                }
            } else {
                subscriptions.push({
                    id: nextSubscriptionId++,
                    clientId, groupId, type, startDate, endDate,
                    price: price ? parseInt(price) : 0,
                    classes: classesCount ? parseInt(classesCount) : null,
                    status
                });
            }
            
            const clientIndex = clients.findIndex(c => c.id === clientId);
            if (clientIndex !== -1) {
                clients[clientIndex].subscription = status;
                clients[clientIndex].subscriptionEnd = endDate;
                clients[clientIndex].classesLeft = classesCount ? parseInt(classesCount) : 0;
                clients[clientIndex].groupId = groupId;
            }
            
            saveData();
            renderSubscriptions();
            renderClients();
            closeModal('subscriptionModal');
            showNotification('–ê–±–æ–Ω–µ–º–µ–Ω—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω!', 'success');
        }
        
        function editSubscription(id) {
            openSubscriptionModal(id);
        }
        
        function deleteSubscription(id) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç?')) {
                const sub = subscriptions.find(s => s.id === id);
                if (sub) {
                    const clientIndex = clients.findIndex(c => c.id === sub.clientId);
                    if (clientIndex !== -1) {
                        clients[clientIndex].subscription = 'expired';
                        clients[clientIndex].classesLeft = 0;
                    }
                }
                
                subscriptions = subscriptions.filter(s => s.id !== id);
                saveData();
                renderSubscriptions();
                renderClients();
                showNotification('–ê–±–æ–Ω–µ–º–µ–Ω—Ç —É–¥–∞–ª–µ–Ω!', 'success');
            }
        }
        
        // ===== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ó–ê–ù–Ø–¢–ò–ô =====
        
        function openClassModal(id = null) {
            const modal = document.getElementById('classModal');
            const title = document.getElementById('classModalTitle');
            const form = document.getElementById('classForm');
            
            const groupSelect = document.getElementById('classGroup');
            groupSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≥—Ä—É–ø–ø—É</option>';
            groups.forEach(g => {
                groupSelect.innerHTML += `<option value="${g.id}">${g.name}</option>`;
            });
            
            const trainerSelect = document.getElementById('classTrainer');
            trainerSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç—Ä–µ–Ω–µ—Ä–∞</option>';
            trainers.forEach(t => {
                trainerSelect.innerHTML += `<option value="${t.id}">${t.lastName} ${t.firstName}</option>`;
            });
            
            if (id) {
                title.textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–Ω—è—Ç–∏–µ';
                const cls = classes.find(c => c.id === id);
                
                document.getElementById('classId').value = cls.id;
                document.getElementById('classDate').value = cls.date;
                document.getElementById('classStartTime').value = cls.startTime;
                document.getElementById('classEndTime').value = cls.endTime;
                document.getElementById('classGroup').value = cls.groupId;
                document.getElementById('classTrainer').value = cls.trainerId;
                document.getElementById('classRoom').value = cls.room;
                document.getElementById('classNotes').value = cls.notes || '';
            } else {
                title.textContent = '–î–æ–±–∞–≤–∏—Ç—å –∑–∞–Ω—è—Ç–∏–µ';
                form.reset();
                document.getElementById('classId').value = '';
                document.getElementById('classDate').value = new Date().toISOString().split('T')[0];
            }
            
            modal.style.display = 'block';
        }
        
        function saveClass(event) {
            event.preventDefault();
            
            const id = document.getElementById('classId').value;
            const date = document.getElementById('classDate').value;
            const startTime = document.getElementById('classStartTime').value;
            const endTime = document.getElementById('classEndTime').value;
            const groupId = parseInt(document.getElementById('classGroup').value);
            const trainerId = parseInt(document.getElementById('classTrainer').value);
            const room = document.getElementById('classRoom').value;
            const notes = document.getElementById('classNotes').value;
            
            if (!date || !startTime || !endTime || !groupId || !trainerId || !room) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!', 'error');
                return;
            }
            
            if (id) {
                const index = classes.findIndex(c => c.id == id);
                if (index !== -1) {
                    classes[index] = { id: parseInt(id), date, startTime, endTime, groupId, trainerId, room, notes };
                }
            } else {
                classes.push({ id: nextClassId++, date, startTime, endTime, groupId, trainerId, room, notes });
            }
            
            saveData();
            renderCalendar(currentCalendarDate);
            closeModal('classModal');
            showNotification('–ó–∞–Ω—è—Ç–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ!', 'success');
        }
        
        function deleteClass(id) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å –∑–∞–Ω—è—Ç–∏–µ?')) {
                classes = classes.filter(c => c.id !== id);
                saveData();
                renderCalendar(currentCalendarDate);
                showNotification('–ó–∞–Ω—è—Ç–∏–µ —É–¥–∞–ª–µ–Ω–æ!', 'success');
            }
        }
        
        // ===== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ò =====
        
        function renderStats() {
            const container = document.getElementById('statsContainer');
            if (!container) return;
            
            const activeClients = clients.filter(c => c.subscription === 'active').length;
            const activeTrainers = trainers.filter(t => t.status === 'active').length;
            const totalGroups = groups.length;
            const totalDirections = Object.keys(directions).length;
            
            container.innerHTML = `
                <div class="stat-card stat-directions">
                    <div class="stat-icon"><i class="fas fa-directions"></i></div>
                    <div class="stat-value">${totalDirections}</div>
                    <div class="stat-label">–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π</div>
                </div>
                <div class="stat-card stat-groups">
                    <div class="stat-icon"><i class="fas fa-users"></i></div>
                    <div class="stat-value">${totalGroups}</div>
                    <div class="stat-label">–ì—Ä—É–ø–ø</div>
                </div>
                <div class="stat-card stat-clients">
                    <div class="stat-icon"><i class="fas fa-user-friends"></i></div>
                    <div class="stat-value">${clients.length}</div>
                    <div class="stat-label">–ö–ª–∏–µ–Ω—Ç–æ–≤</div>
                    <div class="stat-label">${activeClients} –∞–∫—Ç–∏–≤–Ω—ã—Ö</div>
                </div>
                <div class="stat-card stat-trainers">
                    <div class="stat-icon"><i class="fas fa-chalkboard-teacher"></i></div>
                    <div class="stat-value">${trainers.length}</div>
                    <div class="stat-label">–¢—Ä–µ–Ω–µ—Ä–æ–≤</div>
                    <div class="stat-label">${activeTrainers} –∞–∫—Ç–∏–≤–Ω—ã—Ö</div>
                </div>
                <div class="stat-card stat-classes">
                    <div class="stat-icon"><i class="fas fa-calendar-check"></i></div>
                    <div class="stat-value">${classes.length}</div>
                    <div class="stat-label">–ó–∞–Ω—è—Ç–∏–π</div>
                </div>
            `;
        }
        
        // ===== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ò–ú–ü–û–†–¢–ê/–≠–ö–°–ü–û–†–¢–ê =====
        
        function exportAllToExcel() {
            const workbook = XLSX.utils.book_new();
            
            // –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
            const dirData = [['ID', '–ù–∞–∑–≤–∞–Ω–∏–µ', '–í–æ–∑—Ä–∞—Å—Ç–Ω–∞—è –≥—Ä—É–ø–ø–∞', '–ó–∞–ª', '–ú–∞–∫—Å. —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤', '–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ']];
            Object.keys(directions).forEach(key => {
                const d = directions[key];
                dirData.push([
                    key, d.title, getAgeCategoryName(d.ageGroup), d.room || '', 
                    d.maxMembers || 12, formatScheduleFromDays(d.scheduleDays || [])
                ]);
            });
            XLSX.utils.book_append_sheet(workbook, XLSX.utils.aoa_to_sheet(dirData), '–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è');
            
            // –ì—Ä—É–ø–ø—ã
            const groupData = [['ID', '–ù–∞–∑–≤–∞–Ω–∏–µ', '–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ', '–£—Ä–æ–≤–µ–Ω—å', '–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ', '–ó–∞–ª', '–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤']];
            groups.forEach(g => {
                const members = clients.filter(c => c.groupId === g.id).length;
                groupData.push([
                    g.id, g.name, g.directionKey || '', getLevelName(g.level), 
                    g.time || '', g.room, members
                ]);
            });
            XLSX.utils.book_append_sheet(workbook, XLSX.utils.aoa_to_sheet(groupData), '–ì—Ä—É–ø–ø—ã');
            
            // –¢—Ä–µ–Ω–µ—Ä—ã
            const trainerData = [['ID', '–§–ò–û', '–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è', '–¢–µ–ª–µ—Ñ–æ–Ω', '–°—Ç–∞—Ç—É—Å']];
            trainers.forEach(t => {
                trainerData.push([
                    t.id, `${t.lastName} ${t.firstName}`, t.specialization, t.phone, t.status
                ]);
            });
            XLSX.utils.book_append_sheet(workbook, XLSX.utils.aoa_to_sheet(trainerData), '–¢—Ä–µ–Ω–µ—Ä—ã');
            
            // –ö–ª–∏–µ–Ω—Ç—ã
            const clientData = [['ID', '–§–ò–û', '–¢–∏–ø', '–¢–µ–ª–µ—Ñ–æ–Ω', '–ì—Ä—É–ø–ø–∞', '–°—Ç–∞—Ç—É—Å']];
            clients.forEach(c => {
                const group = groups.find(g => g.id === c.groupId);
                clientData.push([
                    c.id, `${c.lastName} ${c.firstName}`, c.clientType, c.phone || '', 
                    group ? group.name : '', c.subscription || 'active'
                ]);
            });
            XLSX.utils.book_append_sheet(workbook, XLSX.utils.aoa_to_sheet(clientData), '–ö–ª–∏–µ–Ω—Ç—ã');
            
            XLSX.writeFile(workbook, `–ì—Ä–∞—Ü–∏—è_${new Date().toISOString().slice(0,10)}.xlsx`);
            showNotification('–î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!', 'success');
        }
        
        // ===== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =====
        
        function initEventListeners() {
            // –¢–∞–±—ã
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    this.classList.add('active');
                    const tabId = this.getAttribute('data-tab');
                    const content = document.getElementById(`${tabId}-content`);
                    if (content) content.classList.add('active');
                });
            });
            
            // –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
            document.getElementById('addDirectionBtn')?.addEventListener('click', () => openDirectionModal());
            document.getElementById('syncGroupsBtn')?.addEventListener('click', syncGroupsWithDirections);
            document.getElementById('generateAllClassesBtn')?.addEventListener('click', () => {
                let total = 0;
                Object.keys(directions).forEach(key => {
                    generateClassesForDirection(key);
                    total++;
                });
                showNotification(`–ó–∞–Ω—è—Ç–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã!`, 'success');
            });
            
            document.getElementById('filterDirectionAge')?.addEventListener('change', function() {
                renderDirections(this.value);
            });
            
            document.getElementById('searchDirection')?.addEventListener('input', function() {
                const filter = document.getElementById('filterDirectionAge');
                renderDirections(filter?.value || 'all');
            });
            
            document.getElementById('directionForm')?.addEventListener('submit', saveDirection);
            document.getElementById('cancelDirectionBtn')?.addEventListener('click', () => closeModal('directionModal'));
            document.getElementById('addScheduleDayBtn')?.addEventListener('click', () => addScheduleDayRow(1, '18:00', '19:00'));
            
            // –ö–∞–ª–µ–Ω–¥–∞—Ä—å
            document.getElementById('prevMonth')?.addEventListener('click', () => {
                currentCalendarDate.setMonth(currentCalendarDate.getMonth() - 1);
                renderCalendar(currentCalendarDate);
            });
            
            document.getElementById('nextMonth')?.addEventListener('click', () => {
                currentCalendarDate.setMonth(currentCalendarDate.getMonth() + 1);
                renderCalendar(currentCalendarDate);
            });
            
            document.getElementById('todayBtn')?.addEventListener('click', () => {
                currentCalendarDate = new Date();
                renderCalendar(currentCalendarDate);
            });
            
            document.getElementById('generateClassesBtn')?.addEventListener('click', () => {
                let total = 0;
                Object.keys(directions).forEach(key => total++);
                showNotification('–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∑–∞–Ω—è—Ç–∏—è" –≤–æ –≤–∫–ª–∞–¥–∫–µ –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è', 'info');
            });
            
            document.getElementById('addClassBtn')?.addEventListener('click', () => openClassModal());
            document.getElementById('classForm')?.addEventListener('submit', saveClass);
            document.getElementById('cancelClassBtn')?.addEventListener('click', () => closeModal('classModal'));
            
            // –ì—Ä—É–ø–ø—ã
            document.getElementById('addGroupBtn')?.addEventListener('click', () => openGroupModal());
            document.getElementById('groupForm')?.addEventListener('submit', saveGroup);
            document.getElementById('cancelGroupBtn')?.addEventListener('click', () => closeModal('groupModal'));
            
            document.getElementById('filterGroupLevel')?.addEventListener('change', renderGroups);
            document.getElementById('filterGroupDirection')?.addEventListener('change', renderGroups);
            document.getElementById('searchGroups')?.addEventListener('input', renderGroups);
            
            // –¢—Ä–µ–Ω–µ—Ä—ã
            document.getElementById('addTrainerBtn')?.addEventListener('click', () => openTrainerModal());
            document.getElementById('trainerForm')?.addEventListener('submit', saveTrainer);
            document.getElementById('cancelTrainerBtn')?.addEventListener('click', () => closeModal('trainerModal'));
            
            // –ö–ª–∏–µ–Ω—Ç—ã
            document.getElementById('addClientBtn')?.addEventListener('click', () => openClientModal());
            document.getElementById('clientForm')?.addEventListener('submit', saveClient);
            document.getElementById('cancelClientBtn')?.addEventListener('click', () => closeModal('clientModal'));
            
            document.getElementById('filterClientGroup')?.addEventListener('change', renderClients);
            document.getElementById('filterClientType')?.addEventListener('change', renderClients);
            
            // –ê–±–æ–Ω–µ–º–µ–Ω—Ç—ã
            document.getElementById('addSubscriptionBtn')?.addEventListener('click', () => openSubscriptionModal());
            document.getElementById('subscriptionForm')?.addEventListener('submit', saveSubscription);
            document.getElementById('cancelSubscriptionBtn')?.addEventListener('click', () => closeModal('subscriptionModal'));
            
            document.getElementById('filterSubscriptionStatus')?.addEventListener('change', renderSubscriptions);
            document.getElementById('filterSubscriptionType')?.addEventListener('change', renderSubscriptions);
            
            // –≠–∫—Å–ø–æ—Ä—Ç
            document.getElementById('exportAllBtnTop')?.addEventListener('click', exportAllToExcel);
            document.getElementById('exportGroupsBtn')?.addEventListener('click', exportAllToExcel);
            document.getElementById('exportTrainersBtn')?.addEventListener('click', exportAllToExcel);
            document.getElementById('exportClientsBtn')?.addEventListener('click', exportAllToExcel);
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
            document.querySelectorAll('.close').forEach(btn => {
                btn.addEventListener('click', function() {
                    this.closest('.modal').style.display = 'none';
                });
            });
            
            window.addEventListener('click', (e) => {
                if (e.target.classList.contains('modal')) {
                    e.target.style.display = 'none';
                }
            });
        }
        
        // –≠–∫—Å–ø–æ—Ä—Ç —Ñ—É–Ω–∫—Ü–∏–π –≤ –≥–ª–æ–±–∞–ª—å–Ω—É—é –æ–±–ª–∞—Å—Ç—å
        window.editDirection = editDirection;
        window.deleteDirection = deleteDirection;
        window.generateClassesForDirection = generateClassesForDirection;
        window.onGroupDirectionChange = onGroupDirectionChange;
        window.openGroupModal = openGroupModal;
        window.editGroup = editGroup;
        window.deleteGroup = deleteGroup;
        window.editTrainer = editTrainer;
        window.deleteTrainer = deleteTrainer;
        window.toggleClientFields = toggleClientFields;
        window.editClient = editClient;
        window.deleteClient = deleteClient;
        window.editSubscription = editSubscription;
        window.deleteSubscription = deleteSubscription;
        window.openClassModal = openClassModal;
        window.deleteClass = deleteClass;
        window.exportAllToExcel = exportAllToExcel;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≥—Ä—É–ø–ø –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
            if (groups.length === 0) {
                const newGroups = generateGroupsFromDirections();
                groups = [...groups, ...newGroups];
                saveData();
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ–∏–ª—å—Ç—Ä—ã –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π
            const directionFilter = document.getElementById('filterGroupDirection');
            if (directionFilter) {
                directionFilter.innerHTML = '<option value="all">–í—Å–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è</option>';
                Object.keys(directions).forEach(key => {
                    directionFilter.innerHTML += `<option value="${key}">${directions[key].title}</option>`;
                });
            }
            
            initEventListeners();
            renderStats();
            renderDirections();
            renderCalendar(currentCalendarDate);
            renderGroups();
            renderTrainers();
            renderClients();
            renderSubscriptions();
            
            setInterval(() => {
                const timeEl = document.getElementById('updateTime');
                if (timeEl) timeEl.textContent = new Date().toLocaleTimeString('ru-RU');
            }, 60000);
        });
    </script>
</body>
</html>
